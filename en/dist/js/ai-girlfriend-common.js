var TOOL_API=location.host.includes("vidqu.ai")&&!location.host.includes("test")?"https://tool-api.vidqu.ai/":"https://tool-api-test.vidqu.ai/",interHost=location.host.includes(".vidqu.ai")&&!location.host.includes("test")?"https://main-api.vidqu.ai/":"https://main-api-test.vidqu.ai/";function judgeClient(){let e="";return e=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"ios":/(Android)/i.test(navigator.userAgent)?"android":"pc",e}function ttsBlank(e){return null==e||"null"===e||""===e||void 0===e||"undefined"===e||"unknown"===e}const addScripTag=e=>{const t=document.createElement("script");t.src=e,t.type="module";(document.head||document.getElementsByTagName("head")[0]).appendChild(t)},addcssTag=e=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e;(document.head||document.getElementsByTagName("head")[0]).appendChild(t)};function Modal(e){const{iconType:t="",titleText:o="",isCancel:n="false",submitType:i="",content:a="",contentList:r="[]",isClose:s="true",submitText:l=""}=e;$("body").append(`\n      <confirm-dialog\n        titleText="${o}"\n        contentList='${r}'\n        iconType="${t}"\n        isClose=${s}\n        isCancel="${n}"\n        submitType="${i}"\n        content="${a}"\n        submitText="${l}">\n      </confirm-dialog>`)}function initLoginDialog(e=""){const t="/dist/js";addScripTag(t+"/commonSignin/login-dialog.js"),addScripTag(t+"/confirm-dialog/index.js");const o=document.createElement("link");o.rel="stylesheet",o.href=t+"/commonSignin/aiChatLogin.css";(document.head||document.getElementsByTagName("head")[0]).appendChild(o);const n=document.createElement("my-component");document.body.appendChild(n)}initLoginDialog();const localPathKey="LOCAL_PATH_STORAGE",localPathJSON=localStorage.getItem(localPathKey),localPath=localPathJSON?JSON.parse(localPathJSON):[];function showLoginWindow(e={}){const{fn:t=()=>{},isReloading:o=!1,closeFn:n=()=>{}}=e;document.body.style.overflow="hidden",$("my-component").off("loginsuccess").on("loginsuccess",(async()=>{t(),console.log("login successful")})).off("closeLoginDialog").on("closeLoginDialog",(()=>{n(),console.log("login closed"),document.body.style.overflow="auto"})),o?localStorage.setItem("toolsPosition",o):localStorage.setItem("toolsPosition","false"),$("my-component").length&&$("my-component")[0].showLoginDialog()}function goApp(){window.location.href="/app"}function goFaceSwap(){window.location.href="/face-swap.html"}function setCookieSesid(e){let t=e.headers.get("Sesid"),o=e.headers.get("Sesid-sign"),n=getCookie("SsToken"),i=getCookie("SsToken-sign");t=ttsBlank(t)?n:t,o=ttsBlank(t)?i:o,setCookie("SsToken",t),setCookie("SsToken-sign",o)}localStorage.setItem(localPathKey,JSON.stringify([...new Set([...localPath,location.pathname])]));var fetchPut=function(e,t,o={}){return new Promise(((n,i)=>{fetch(e,{method:"PUT",headers:{"X-TASK-VERSION":"2.0.0",...o},body:t}).then((e=>n(e.status))).catch((e=>i(e)))}))};function fetchPostNormal(e,t,o=TOOL_API,n={"Content-Type":"application/json"}){return new Promise(((i,a)=>{fetch(o+e,{method:"POST",headers:{"Request-Origin":"vidqu",Authorization:"Bearer "+getCookie("access_token")||"",...n},body:t instanceof FormData?t:JSON.stringify(t)}).then((e=>{e.json().then((async e=>{401===e.code?(localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),isShowLogin&&showLoginWindow(),await aiGirlFriend.initCharacters(),aiGirlFriend.GetRecentChatting(),aiGirlFriend.GetMyCharacters(),i(e)):i(e)}))})).catch((e=>{a(e)}))}))}function fetchGetNormal(e,t=TOOL_API,o={}){return new Promise(((n,i)=>{fetch(t+e,{method:"GET",headers:{"Content-Type":"application/json","Request-Origin":"vidqu",Authorization:"Bearer "+getCookie("access_token")||"",...o}}).then((e=>e.json().then((async e=>{401===e.code?(aiChatting.closeChat(),localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),isShowLogin&&showLoginWindow(),await aiGirlFriend.initCharacters(),aiGirlFriend.GetRecentChatting(),aiGirlFriend.GetMyCharacters(),i(e)):n(e)})))).catch((e=>i(e)))}))}function setCookie(e,t,o=30){var n=new Date;n.setDate(n.getDate()+o);var i=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,a=encodeURIComponent(t)+(null==o?"":";expires="+n.toUTCString())+";path=/;domain="+i;document.cookie=e+"="+a}function getCookie(e){const t=document.cookie.split(";");for(const o of t){const[t,n]=o.trim().split("=");if(t===e)return decodeURIComponent(n)}return null}const isSeo=()=>{let e=!1,t=["google.","baidu.","yandex.","bing.","yahoo.","duckduckgo.",".naver.","go.mail.ru","qwant.","sougou.",".so.","rambler.",".ask.","daum.",".ecosia.",".startsiden.",".onetonline.","search.smt.docomo",".biglobe.","seznam."];for(let o of t)if(document.referrer.includes(o))return e=!0,e},getinsurValue=()=>{let e="";return"/ai-girlfriend.html"==document.location.pathname&&(e="en_vidq_aigirlfriend"),isSeo()&&(e=e.replace("en","enseo")),e};function getUrlParam(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?encodeURI(o[2]):null}const setInsurCookie=()=>{getCookie("insur")||isSeo()||getUrlParam("insur")||getCookie("insurLevel")||setCookie("insur",getinsurValue(),30),isSeo()&&(getCookie("insur")&&(getCookie("insur").includes("seo")||getUrlParam("insur")||getCookie("insurLevel"))||setCookie("insur",getinsurValue(),30)),getUrlParam("insur")&&(getCookie("insurLevel")||(setCookie("insur",getUrlParam("insur"),30),setCookie("insurLevel","strong",30),getCookie("aff")&&JSON.parse(getCookie("aff"))&&JSON.parse(getCookie("aff")).a_aid&&getCookie("insur")&&getCookie("insur").includes("googlecamp")&&(document.cookie="aff=; expires=Thu, 01 Jan 1971 00:00:00 UTC; path=/;domain=.vidqu.ai"))),null!==getUrlParam("a_aid")&&(cookieObj={a_aid:getUrlParam("a_aid"),chan:getUrlParam("chan"),data1:getUrlParam("data1"),data2:getUrlParam("data2")},getCookie("insur")&&getCookie("insur").includes("googlecamp")&&(document.cookie="insur=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;domain=.vidqu.ai",document.cookie="insurLevel=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;domain=.vidqu.ai"),setCookie("aff",JSON.stringify(cookieObj),120))};function getPreferredLanguage(){let e="";e=$("html").attr("lang").substring(0,2);var t=["en","de","es","fr","it","pt","ja","ar","kr","tw"].filter((function(t){return t===e}));return t.length>0?"ja"==t[0]?"jp":t[0]:"en"}const transtoBlob=({b64data:e,contentType:t="image/png"})=>{t=t||"";let o=1024,n=atob(e.split(",")[1]),i=n.length,a=Math.ceil(i/o),r=new Array(a);for(let e=0;e<a;++e){let t=e*o,a=Math.min(t+o,i),s=new Array(a-t);for(let e=t,o=0;e<a;++o,++e)s[o]=n[e].charCodeAt(0);r[e]=new Uint8Array(s)}return new Blob(r,{type:t})};function setSessionCookie(e,t){var o=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,n=escape(t)+";path=/;domain="+o;document.cookie=e+"="+n}function handleScrollAnimation(){$(".scroll-animation").each((function(e,t){t.getBoundingClientRect().top<.66*window.innerHeight&&$(t).addClass("on")}))}function chatLoginFriend(){window.aiChatting&&window.aiChatting.updateAudioLimit()}function resizeImageByFile(e){return new Promise(((t,o)=>{var n=new FileReader;n.onloadend=()=>{let e=new Image;e.onload=()=>{let o=document.createElement("canvas"),n=o.getContext("2d"),i=Math.max(e.width,e.height);if(i>3072){let t=3072/i;o.width=e.width*t,o.height=e.height*t}else o.width=e.width,o.height=e.height;n.drawImage(e,0,0,o.width,o.height);var a=o.toDataURL(),r=transtoBlob({b64data:a,contentType:"image/png"});let s="width";o.width<o.height&&(s="height"),t({blog:r,imgType:s})},e.onerror=()=>{t({blog:null})},e.src=n.result},n.onerror=o,n.readAsDataURL(e)}))}window.addEventListener("scroll",(function(){handleScrollAnimation()})),$("body").on("mouseup",(function(e){const t=$(e.target),o=0!=t.parents("#header_inform").length||t.hasClass("inform");o?("pc"==judgeClient()?$("#header_inform .inform_box").show():($("header .inform_mobile_list").slideDown(),document.body.style.overflow="hidden"),gtag("event","notifications_aigirlfriend_header"),$("#header_inform").addClass("active"),clearGetIfications()):$("#header_inform").hasClass("active")&&"pc"==judgeClient()?($("#header_inform,.inform_item").removeClass("unlook"),$("#header_inform .inform_box").hide(),$("#header_inform").removeClass("active"),aiGirlFriend.clearIfication()):(o||t.hasClass("inform_m_back")&&$("#header_inform").hasClass("active"))&&($("header .inform_mobile_list").slideUp(),document.body.style.overflow="auto",$("#header_inform").removeClass("active"),aiGirlFriend.clearIfication())})),$(".inform_list_box").on("scroll",(function(e){$(".inform_list_box").scrollTop()>=$(".inform_list").height()-$(".inform_list_box").height()&&aiGirlFriend.GetIfications(!1)}));const currentDate=new Date,timezoneOffset=currentDate.getTimezoneOffset(),browserLanguage=navigator.language||navigator.userLanguage,getWhiteList=()=>{fetchPost(`api/site/mio-config?t=${(new Date).getTime()}`,{}).then((e=>{200===e.code?e.data.is_in_ip_whitelist||-480!==timezoneOffset||"zh-cn"!==browserLanguage.toLowerCase()||(document.body.innerHTML='<div class="shield-page">The website is not available</div>',document.head.innerHTML="\n          <style>\n               *{\n                   padding:0;\n                   margin:0;\n                 }\n               body{\n                 background-image: linear-gradient(to right, rgb(241,238,255), rgb(254,254,255));\n                 display: flex;\n                 align-items: center;\n                 justify-content: center;\n                 width: 100vw;\n                 height: 100vh;\n                 overflow: hidden;\n               }\n               .shield-page{\n                 font: normal normal 600 30px/30px Poppins;\n                 color: #785EEE;\n               }\n               @media (max-width: 768px){\n                 .shield-page{\n                   font: normal normal 600 20px/20px Poppins;\n                 }\n               }\n          </style>"):console.log("err")}))};function randomchoice(e){let t=null;return function(){let o=e.filter((e=>e!==t)),n=o[Math.floor(Math.random()*o.length)];return t=n,n}}function updateUserData(){fetchPostNormal("api/user/get-profile",{},interHost).then((e=>{200==e.code&&(setUserInfo(e),aiGirlFriend.GetMyCharacters())})).catch((()=>{console.error("updateUserData error")}))}function setUserInfo(e){const{id:t}=JSON.parse(getCookie("user_info")),o={head_portrait:e.data.head_portrait,email:e.data.email,id:t,first_name:e.data.first_name,last_name:e.data.last_name,usertype:e.data.type};setCookie("user_info",JSON.stringify(o)),isLogin(!0)}function isBlob(e){return e instanceof Blob}function areObjectsEqual(e,t){const o=Object.keys(e),n=Object.keys(t);if(o.length!==n.length)return console.log("length unlike"),!1;for(const n of o){if(!t.hasOwnProperty(n))return console.log("key is not +",n),!1;if(e[n]!=t[n])return console.log("value is not +",n,e[n],t[n]),!1}return!0}getWhiteList(),$("#header_login").click((()=>{gtag("event","login_aigirlfriend_header")})),$(".signoutBtn").click((()=>{window.aiChatting&&window.aiChatting.updateAudioLimit(),$(".meau_icon").hasClass("active")&&$(".meau_icon").click(),gtag("event","signout_aigirlfriend_header")})),$(document).ready((function(){chatLoginFriend(),setInsurCookie()})),window.questLanguage=getPreferredLanguage(),window.userModel=judgeClient();