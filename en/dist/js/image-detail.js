let showImgWidth,totalSlides,isTransition,imgList,likeNum,imgsLength=1,showImgIndex=1,page=1,date=$(".data_box").attr("data-time"),detailID=$(".detail_main").attr("data-detailID");const imgBox=document.querySelector(".info_img_box"),imgContainer=document.querySelector(".info_img"),listParams={page:1,pageSize:36,offset:null,id:detailID};function showImg(){if(imgList=document.querySelectorAll(".show_img"),imgList.length>1){if(imgList.forEach(((e,t)=>{e.setAttribute("slider",t+1)})),document.body.clientWidth>1200)showImgWidth=Number($(".info_img_box").attr("data-width").replace("px",""));else{const e=Number($("html").css("fontSize").replace("px",""));showImgWidth=6.18*e,$(".info_left").css("width",showImgWidth),$(".show_img").css("width",showImgWidth),$(".info_img_box").css("width",showImgWidth)}$(".info_left").addClass("more_img"),imgsLength=imgList.length;const e=imgList[0].cloneNode(!0),t=imgList[imgList.length-1].cloneNode(!0);imgContainer.insertAdjacentElement("beforeend",e),imgContainer.insertAdjacentElement("afterbegin",t),imgContainer.style.transform=`translateX(${-showImgWidth*showImgIndex}px)`,imgList=document.querySelectorAll(".show_img"),totalSlides=imgList.length,imgContainer.addEventListener("transitionend",(()=>{isTransition=!1;const e=imgList[showImgIndex].getAttribute("slider");"1"===e&&(imgContainer.style.transition="none",showImgIndex=1,imgContainer.style.transform=`translateX(${-showImgWidth*showImgIndex}px)`),e===String(imgsLength)&&(imgContainer.style.transition="none",showImgIndex=totalSlides-2,imgContainer.style.transform=`translateX(${-showImgWidth*showImgIndex}px)`)})),$(".img_pre_icon").on("click",preClick),$(".img_next_icon").on("click",nextClick)}else document.body.clientWidth<=1200&&$(".info_img_box").css("width","100%")}function nextClick(){isTransition||showImgIndex>=totalSlides-1||(isTransition=!0,imgContainer.style.transition="transform 0.5s ease-in-out",showImgIndex++,imgContainer.style.transform=`translateX(${-showImgWidth*showImgIndex}px)`)}function preClick(){isTransition||showImgIndex<=0||(isTransition=!0,imgContainer.style.transition="transform 0.5s ease-in-out",showImgIndex--,imgContainer.style.transform=`translateX(${-showImgWidth*showImgIndex}px)`)}function renderList(){$(".explore_content").html('\n    <div class="IGgrid_container notshow">\n      <div class="IGgrid_table_container"></div>\n      <lottie-player\n        src="/dist/img/loading.json"\n        background="transparent"\n        speed="1"\n        style="width: 160px; height: 160px"\n        loop\n        autoplay\n        class="lottie-loading"\n      ></lottie-player>\n    <div>\n  ');const e=$(".IGgrid_container");function t(t){t?e.addClass("notshow"):e.removeClass("notshow")}function i(t){t?e.addClass("more_loading"):e.removeClass("more_loading")}!function o(n=!0){n?t(!0):i(!0);const s=setParams(listParams);nomore=!1,_$$.getComm(`generate/post/list${s}`).then((s=>{isScrollLoading=!1,e.removeClass("more_loading"),(0===s.data.list.length||s.data.list.length<listParams.pageSize)&&(nomore=!0),listParams.offset=s.data.offset,renderGrid({list:s.data.list,isClear:n,callback:()=>{n?t(!1):i(!1)}}),listenScroll({callback:()=>{listParams.page++,o(!1)}})}))}(),setGotoTop()}function getLikeView(){const e=setParams({id:detailID});_$$.getComm(`generate/post/stat${e}`).then((e=>{200===e.code?($(".like_num").html(formatNumber(e.data.like)),$(".view_num").html(formatNumber(e.data.view)),e.data.liked&&$(".like_icon").addClass("active"),likeNum=e.data.like):($(".like_num").html(formatNumber(0)),$(".view_num").html(formatNumber(0)),likeNum=0)})).catch((e=>{console.log(e),$(".like_num").html(formatNumber(0)),$(".view_num").html(formatNumber(0)),likeNum=0,$Popup({type:"error",errorType:"network"})}))}function initPage(){gtag("event","open_imginfo_page"),getLikeView(),$(".data_box .text").html(getLocalTime(date)),showImg(),renderList()}function getLocalTime(e){const t=new Date(e.replace(" ","T"));return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`}function downloadImg(e){fetch(e).then((e=>{e.blob().then((e=>{const t=document.createElement("a");t.href=URL.createObjectURL(e),t.setAttribute("download","Vidqu_AI_Image.jpg"),t.click(),t.remove()}))})).catch((e=>{console.log(e),$Popup({type:"error",errorType:"network"})}))}$((function(){initPage(),document.querySelector("my-component").addEventListener("loginsuccess",(async()=>{window.location.reload()})),$(".signoutBtn").on("click",(async function(){window.location.reload()}))})),$(".back_icon").on("click",(function(){gtag("event","click_imginfo_backbtn"),document.referrer.includes("vidqu.ai")?history.back():window.location.href=homeUrl})),$(".icon_copy").on("click",(function(){gtag("event","click_imginfo_cpbtn");const e=$(".prompts_text").text().replace(/\s+/g," ").trim();try{copyText(e),ToolTip({text:jsonData.IGdetail.copySuc})}catch(e){ToolTip({type:"error",text:jsonData.IGdetail.copyErr})}})),$(".like_icon").on("click",(function(){gtag("event","click_imginfo_likebtn");(getCookie("access_token")?getCookie("access_token"):"")?($(this).hasClass("active")?($(this).removeClass("active"),likeNum--,_$$.postComm("generate/post/like",{id:detailID}).then((e=>{200!=e.code&&($(".like_icon").addClass("active"),likeNum++,401===e.code&&(localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),window.location.reload()))})).catch((e=>{console.log(e),$(".like_icon").addClass("active"),likeNum++}))):($(this).addClass("active"),likeNum++,_$$.postComm("generate/post/like",{id:detailID}).then((e=>{200!=e.code&&($(".like_icon").removeClass("active"),likeNum--,401===e.code&&(localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),window.location.reload()))})).catch((e=>{console.log(e),$(".like_icon").removeClass("active"),likeNum--,$Popup({type:"error",errorType:"network"})}))),$(".like_num").html(formatNumber(likeNum))):showLoginWindow()})),$(".download_box").on("click",(function(){let e;gtag("event","click_imginfo_downloadbtn"),e=1===imgsLength?imgList[0]:imgList[showImgIndex],downloadImg(e.src)})),$(".share_box").on("click",(function(){gtag("event","click_imginfo_sharebtn"),renderShare({id:detailID},"info")})),$(".btn_remix, .generate_btn").on("click",(function(){$(this).hasClass("btn_remix")?gtag("event","click_imginfo_tryitbtn"):gtag("event","click_imginfo_generatebtn"),window.location.href=`/ai-image-generator.html?setInfoId=${detailID}`})),document.addEventListener("scroll",(function(e){const t=2*window.innerHeight;(document.body.scrollTop||document.documentElement.scrollTop)>t?$(".gotoHead").show():$(".gotoHead").hide()}));