const interHost=location.host.includes(".vidqu.ai")&&!location.host.includes("test")?"https://main-api.vidqu.ai":"https://main-api-test.vidqu.ai";let checkspwd={newpwd:!1,confirm:!1},_reset_key="";function _debounce(e){let t=null;return function(){t&&clearTimeout(t),t=setTimeout((()=>{e.apply(this,arguments)}),1e3)}}function fetchPost(e,t={},a={}){return new Promise(((s,r)=>{fetch(interHost+e,{method:"POST",headers:{"Content-Type":"application/json","X-TASK-VERSION":"2.0.0","Request-Origin":"vidqu",...a},body:JSON.stringify(t)}).then((e=>{s(e.json())})).catch((e=>r(e)))}))}function isBlank(e){return null==e||"null"===e||""===e||void 0===e||"undefined"===e||"unknown"===e}function getStorage(e){const t=localStorage.getItem(e);let a=null;return a=t&&"null"!==t&&null!==t?"number"==typeof t||"textareaVal"===e||"token"===e?t:JSON.parse(t):null,a}function OpenOrClosePassword(e){var t=findAncestors(e.target,(function(e){return e.classList&&e.classList.contains("reveal-button")}));if(t){var a=t.parentNode.querySelector("input");t.classList.contains("active")?(t.classList.remove("active"),a.setAttribute("type","password")):(t.classList.add("active"),a.setAttribute("type","text"));var s=a.value;a.focus(),a.value="",a.value=s}}function checkPasswordEyes(){let e=document.querySelectorAll(".reveal-button"),t=this;e.forEach((e=>e.addEventListener("click",OpenOrClosePassword.bind(t))))}function getUrlParam(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?encodeURI(a[2]):null}function setCookie(e,t){var a=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,s=escape(t)+";path=/;domain="+a;document.cookie=e+"="+s}$(".form-tips").html(),$(".form-email").removeClass("dirty"),$(document).on("input propertychange",".form-password[name='confirm']",(function(e){e.target.classList.remove("dirty"),e.target.value.length>0&&checkspwd.newpwd?($(".form-tips").html(),containsVal($(".form-input[name='newpwd']").val(),$(".form-input[name='confirm']").val())?(removeCheckStyle(e),checkspwd.confirm=!0,$(".form-tips").removeClass("dirty"),$(".button-email").removeAttr("disabled")):(checkspwd.confirm=!1,addCheckStyle(e),$(".form-tips").addClass("dirty"),$(".button-email").attr("disabled","disabled"),$(".pwd-tips").html(jsonData.loginUser.pwd_tips.match))):(checkspwd.confirm=!1,removeCheckStyle(e),checkspwd.newpwd&&$(".form-tips").removeClass("dirty")),checkspwd.confirm&&checkspwd.newpwd?$(".button-email").removeAttr("disabled"):$(".button-email").attr("disabled","disabled")})),$(document).on("input propertychange",".form-password[name='newpwd']",(function(e){e.target.classList.remove("dirty"),e.target.value.length>0?(console.log(onCheckPassword(e.target.value)),onCheckPassword(e.target.value)?(removeCheckStyle(e),checkspwd.newpwd=!0,isBlank($(".form-input[name='confirm']").val())?$(".form-tips").removeClass("dirty"):($(".form-tips").addClass("dirty"),!isBlank($(".form-input[name='confirm']").val())&&containsVal($(".form-input[name='newpwd']").val(),$(".form-input[name='confirm']").val())?($(".form-input[name='confirm']").removeClass("dirty"),$(".form-tips").removeClass("dirty"),checkspwd.confirm=!0):($(".form-input[name='confirm']").addClass("dirty"),$(".form-tips").html(),checkspwd.confirm=!1,$(".pwd-tips").html(jsonData.loginUser.pwd_tips.match)))):(addCheckStyle(e),$(".form-tips").addClass("dirty"),$(".form-input[name='confirm']").removeClass("dirty"),checkspwd.newpwd=!1)):(checkspwd.newpwd=!1,removeCheckStyle(e),$(".form-tips").removeClass("dirty"),$(".form-input[name='confirm']").removeClass("dirty")),checkspwd.confirm&&checkspwd.newpwd?$(".button-email").removeAttr("disabled"):$(".button-email").attr("disabled","disabled")}));const resetPasswordSend=e=>{fetchPost("/api/user/do-reset-password",e).then((e=>{if(200===e.code){$(".button-email").removeAttr("disabled");const t={id:e.data.id,email:e.data.email,first_name:e.data.first_name,last_name:e.data.last_name,head_portrait:e.data.head_portrait,usertype:e.data.type},a=e.data.redirect_url;setCookie("access_token",e.data.access_token,30),setCookie("refresh_token",e.data.refresh_token,30),setCookie("user_info",JSON.stringify(t),30),setCookie("loginProduct",a,30),window.location.href=a,$(".form-tips").removeClass("dirty")}else console.log("fail"),409===e.code?($(".button-email").attr("disabled","disabled"),$(".form-tips").html(e.message).addClass("dirty")):($(".button-email").removeAttr("disabled"),$(".form-tips").html(e.message).addClass("dirty"))}))};$("body").keydown((function(e){var t=e||window.event;if(13==(t.keyCode||t.which||t.charCode))return $(".button-email").attr("disabled")||$(".button-email").click(),!1}));const removeCheckStyle=e=>{e.target.classList.remove("dirty")},addCheckStyle=e=>{e.target.classList.add("dirty")},setCheckEmail=(e,t)=>{let a="";return a="page"==t?e.value:e.target.value,a||isBlank(a)?("page"==t?e.classList.remove("dirty"):e.target.classList.remove("dirty"),!0):("page"==t?e.classList.add("dirty"):e.target.classList.add("dirty"),!1)},max_length=(e,t)=>!!regexs.numericRegex.test(t)&&backVal(e).length<=parseInt(t,10),min_length=(e,t)=>!!regexs.numericRegex.test(t)&&backVal(e).length>=parseInt(t,10),containsVal=(e,t)=>backVal(e)==t;function backVal(e){return"string"==typeof e?e:e.value}const onCheckPassword=e=>($(".pwd-tips").html(jsonData.loginUser.pwd_tips.len),0!=e.trim().length&&null!=e&&!(e.trim().length<6||e.trim().length>20));function findAncestors(e,t){for(;null!=e;){if(t.call(null,e))return e;e=e.parentNode}return null}window.addEventListener("load",(()=>{let e=location.search,t="",a="";document.querySelector(".button-email").addEventListener("click",(function(e){_reset_key=getUrlParam("reset_key"),$(".button-email").attr("disabled","disabled"),checkspwd&&($(".form-input").removeClass("dirty"),fetchPost("/api/user/do-reset-password",{reset_key:_reset_key,new_password:$("#newpassword").val(),productName:"vidqu"}).then((e=>{if(200===e.code){$(".button-email").removeAttr("disabled");const t={id:e.data.id,email:e.data.email,first_name:e.data.first_name,last_name:e.data.last_name,head_portrait:e.data.head_portrait,usertype:e.data.type},a=e.data.redirect_url;setCookie("access_token",e.data.access_token,30),setCookie("refresh_token",e.data.refresh_token,30),setCookie("user_info",JSON.stringify(t),30),setCookie("loginProduct",a,30),window.location.href=a,$(".form-tips").removeClass("dirty")}else console.log("fail"),409===e.code?($(".button-email").attr("disabled","disabled"),$(".form-tips").html(e.message).addClass("dirty")):($(".button-email").removeAttr("disabled"),$(".form-tips").html(e.message).addClass("dirty"))})))})),isBlank(getUrlParam("page_name"))||(t=$("#back-to-signin").attr("href"),a=$("#signup-to-free").attr("href"),-1!=e.indexOf("?")?($("#back-to-signin").attr("href",t+"?page_name="+e),$("#signup-to-free").attr("href",a+"?page_name="+e)):($("#back-to-signin").attr("href",t+"&page_name="+e),$("#signup-to-free").attr("href",a+"&page_name="+e))),isBlank(getStorage("video_email"))||($("#signinemail").val(getStorage("video_email").email),$("#email-forgot-submit").removeAttr("disabled"),checks.email=!0),checkPasswordEyes()}));