var TOOL_API=location.host.includes("vidqu.ai")&&!location.host.includes("test")?"https://tool-api.vidqu.ai/":"https://tool-api-test.vidqu.ai/",Vidnoz_API=location.host.includes("vidqu.ai")&&!location.host.includes("test-")?"https://api.vidnoz.com":"https://api-test.vidnoz.com",XTASKVERSION="2.0.0";let access_token=getCookie("access_token")?getCookie("access_token"):"",refresh_token=getCookie("refresh_token")?getCookie("refresh_token"):"",allowToken=["/web/recorder/newsharepage.html"],notTokenFlag=!1,request_header="";function jqAjaxPromise(e,t=()=>{},o="web"){access_token=getCookie("access_token")?getCookie("access_token"):"",refresh_token=getCookie("refresh_token")?getCookie("refresh_token"):"";let n=TOOL_API+e.url;return request_header=getCookie("access_token")?{Authorization:"Bearer "+access_token}:{Authorization:""},request_header["X-TASK-VERSION"]=XTASKVERSION,request_header["Request-Language"]="ar",request_header["Request-Origin"]=o,new Promise(((a,i)=>{let r=$.ajax({url:n,type:e.type||"GET",headers:{...request_header,...e.headers,"Request-Origin":o},data:{origin:o,...e.data||""},cache:!0,async:!0,timeout:3e5,xhrFields:{withCredentials:!0},xhr:()=>{var e=$.ajaxSettings.xhr();return e&&(e.onprogress=function(e){e.lengthComputable&&t(e)}),e},success:function(t){401==(t="string"==typeof t?JSON.parse(t):t).code?(notTokenFlag||requestAtoken(refresh_token),e.cb401&&e.cb401({data:t,resolve:a,reject:i})):a(t)},error:function(e){i(e)},complete:function(e,t){"timeout"===t&&r.abort()}});e.cancelToken&&e.cancelToken.promise.then((()=>{i({status:"canceled"}),r.abort()}))}))}function judgeClient(){let e="";return e=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"ios":/(Android)/i.test(navigator.userAgent)?"android":"pc",e}function lazyLoad(e=100){const t=document.querySelectorAll("[data-original]"),o=judgeClient(),n=function(e){if("IMG"==e.nodeName||"IFRAME"==e.nodeName)e.src?e.src=e.getAttribute("data-original"):e.setAttribute("src",e.getAttribute("data-original")),e.addEventListener("load",(function(){e.removeAttribute("data-original")}));else{const n=e.getAttribute("data-original");if(n.includes("`")){const t=n.split("`");let o="";t.forEach((e=>{o+="url("+e+"),"})),o=o.substring(0,o.lastIndexOf(",")),e.style.backgroundImage=o}else e.style.backgroundImage="url("+e.getAttribute("data-original")+")";if(n.includes("---")){var t=n.split("---");e.style.backgroundImage="pc"===o?"url("+t[0]+")":"url("+t[1]+")"}e.addEventListener("load",(function(){e.removeAttribute("data-original")}))}};let a=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){if(e.target.className.includes("allin_bg")){e.target.parentNode.parentNode.parentNode.querySelectorAll("li").forEach((e=>{let t=e.querySelector("img");t.getAttribute("data-original")&&n(t)}))}else if(e.target.className.includes("comment_person")||e.target.className.includes("comment_star")){let t=e.target.parentNode.parentNode.parentNode.parentNode.querySelectorAll("li");t.length&&t.forEach((e=>{e.querySelectorAll("img").forEach((e=>{e.getAttribute("data-original")&&n(e)}))}))}else n(e.target);t.unobserve(e.target)}}))}),{rootMargin:`0px 0px ${e}px 0px`});t.forEach((e=>{a.observe(e)}))}const currentDate=new Date,timezoneOffset=currentDate.getTimezoneOffset(),browserLanguage=navigator.language||navigator.userLanguage;var currentCountry="";const getWhiteList=()=>{fetchPost(`api/site/mio-config?t=${(new Date).getTime()}`,{},TOOL_API).then((e=>{200===e.code?e.data.is_in_ip_whitelist||-480!==timezoneOffset||"zh-cn"!==browserLanguage.toLowerCase()||(document.body.innerHTML='<div class="shield-page">The website is under construction.</div>',document.head.innerHTML="\n                    <style>\n                          *{\n                              padding:0;\n                              margin:0;\n                            }\n                          body{\n                            background-image: linear-gradient(to right, rgb(241,238,255), rgb(254,254,255));\n                            display: flex;\n                            align-items: center;\n                            justify-content: center;\n                            width: 100vw;\n                            height: 100vh;\n                            overflow: hidden;\n                          }\n                          .shield-page{\n                            font: normal normal 600 30px/30px Poppins;\n                            color: #785EEE;\n                          }\n                          @media (max-width: 768px){\n                            .shield-page{\n                              font: normal normal 600 20px/20px Poppins;\n                            }\n                          }\n                     </style>"):console.log("err")}))};function $id(e){var t=document.getElementById(e);return t||null}function goApp(){window.location.href="/app"}function gofaceSwap(){window.location.href="/faceswap.html"}function isShowFooterCookie(){const e=localStorage.getItem("cookieFooter");((new Date).getTime()>e||null===e)&&$(".fix-footer").show()}function showLoginWindow(e={}){const{fn:t=()=>{},isReloading:o=!1,wait:n=null,closeFn:a=()=>{}}=e;document.body.style.overflow="hidden",$("my-component").off("loginsuccess").on("loginsuccess",(async e=>{e?.detail?t(e.detail):t()})).off("closeLoginDialog").on("closeLoginDialog",(()=>{a(),console.log("login closed"),document.body.style.overflow="auto"})),o?localStorage.setItem("toolsPosition",o):localStorage.setItem("toolsPosition","false"),$("my-component").length&&$("my-component")[0].showLoginDialog(n)}function setCookie(e,t,o){var n=new Date;n.setDate(n.getDate()+o);var a=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,i=encodeURIComponent(t)+(null==o?"":";expires="+n.toUTCString())+";path=/;domain="+a;document.cookie=e+"="+i}function getCookie(e){const t=document.cookie.split(";");for(const o of t){const[t,n]=o.trim().split("=");if(t===e)return decodeURIComponent(n)}return null}function fetchPost(e,t,o,n={}){return new Promise(((a,i)=>{fetch(o+e,{method:"POST",headers:{"Content-Type":"application/json","Request-Origin":"vidqu","Request-Language":"ar",Authorization:"Bearer "+getCookie("access_token")||"",...n},body:JSON.stringify(t)}).then((e=>{a(e.json())})).catch((e=>{i(e)}))}))}function fetchGet(e,t=TOOL_API,o={}){return new Promise(((n,a)=>{fetch(t+e,{method:"GET",headers:{"Content-Type":"application/json","Request-Origin":"vidqu","Request-Language":"ar",Authorization:"Bearer "+getCookie("access_token")||"",...o}}).then((e=>n(e.json()))).catch((e=>a(e)))}))}getWhiteList();var fetchPut=function(e,t,o="",n={}){return new Promise(((a,i)=>{fetch(o+e,{method:"PUT",headers:{"X-TASK-VERSION":"2.0.0",...n},body:t}).then((e=>a(e.status))).catch((e=>i(e)))}))};function initLoginDialog(e=""){const t="/dist/js";addScripTag(t+"/commonSignin/login-dialog.js"),addScripTag(t+"/confirm-dialog/index.js");const o=document.createElement("link");o.rel="stylesheet",o.href=t+"/commonSignin/selfComponent.css";(document.head||document.getElementsByTagName("head")[0]).appendChild(o);const n=document.createElement("my-component");document.body.appendChild(n)}const addScripTag=e=>{const t=document.createElement("script");t.src=e,t.type="module";(document.head||document.getElementsByTagName("head")[0]).appendChild(t)},addcssTag=e=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e;(document.head||document.getElementsByTagName("head")[0]).appendChild(t)};function Modal(e){const{iconType:t="",titleText:o="",isCancel:n="false",submitType:a="",content:i="",contentList:r="[]",isClose:s="true",submitText:c=""}=e;$("body").append(`\n      <confirm-dialog\n        titleText="${o}"\n        contentList='${r}'\n        iconType="${t}"\n        isClose=${s}\n        isCancel="${n}"\n        submitType="${a}"\n        content="${i}"\n        submitText="${c}">\n      </confirm-dialog>`)}function randomchoice(e){let t=null;return function o(){let n=Math.floor(Math.random()*e.length),a=e[n];return a===t?o():(t=a,a)}}function isMobileDevice(){const e=navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}function touchEnlarge(){var e=0;document.documentElement.addEventListener("touchend",(function(t){var o=Date.now();o-e<=300&&t.preventDefault(),e=o}),!1)}function isDownloadFile(e,t){return new Promise(((o,n)=>{if("video"===t){let t=document.createElement("video");t.src=e,t.load(),t.onloadeddata=()=>o(),t.onerror=()=>n()}else if("image"===t){let t=new Image;t.src=e,t.onload=()=>o(),t.onerror=()=>n()}}))}const getinsurValue=()=>{let e="",t=document.location.pathname;return"/face-swap.html"==t?e="ar_vidq_faceswap":"/video-translator.html"==t?e="ar_vidq_videotranslate":"/"==t||"/about.html"==t||"/contact.html"==t||("/privacy.html"==t?e="ar_privacy":"/terms.html"==t?e="ar_terms":"/ai-attractiveness-test.html"==t?e="en_vidq_attracttest":"/multiple-face-swap.html"==t&&(e="en_vidq_mulfaceswap")),isSeo()&&(e=e.replace("ar","arseo")),e},isSeo=()=>{let e=!1,t=["google.","baidu.","yandex.","bing.","yahoo.","duckduckgo.",".naver.","go.mail.ru","qwant.","sougou.",".so.","rambler.",".ask.","daum.",".ecosia.",".startsiden.",".onetonline.","search.smt.docomo",".biglobe.","seznam."];for(let o of t)if(document.referrer.includes(o))return e=!0,e},setInsurCookie=()=>{getCookie("insur")||isSeo()||setCookie("insur",getinsurValue(),30),isSeo()&&(getCookie("insur")&&getCookie("insur").includes("seo")||setCookie("insur",getinsurValue(),30))};function toThousands(e){return(e||0).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}setInsurCookie();var localeArea={ja:"ja-JP",de:"de-DE",en:"en-US",es:"en-US",fr:"fr-FR",it:"it-IT",pt:"pt-BR"};function getPreferredLanguage(){let e="";e=$("html").attr("lang").substring(0,2);var t=["en","de","es","fr","it","pt","ja","ar"].filter((function(t){return t===e}));return t.length>0?"ja"==t[0]?"jp":t[0]:"en"}function setSessionCookie(e,t){var o=location.hostname.includes("vidqu.ai")?"vidqu.ai":location.hostname,n=escape(t)+";path=/;domain="+o;document.cookie=e+"="+n}async function newDownloadFile(e="",t,o,n,a){handleBtnMsClass(!0),handleDownloadClass(!0);try{let i={id:e};t&&(i.img_key=t),o&&(i.width=o),n&&(i.height=n),a&&(i.size=a);const r=await jqAjaxPromise({tools:!0,url:"ai/source/vidqu-download",type:"POST",data:i,cb401({resolve:e}){e({code:401})}});console.log("res--下载",r);const s=r?.code,c=r?.data?.is_local_download,l=r?.data?.additional_data;return localStorage.setItem("isSavingtask",!1),200===s&&null!=c?(handleBtnMsClass(),handleDownloadClass(),{code:c,data:l}):(handleBtnMsClass(),handleDownloadClass(),{code:s})}catch(e){return handleBtnMsClass(),handleDownloadClass(),localStorage.setItem("isSavingtask",!1),{code:-1}}}function handleBtnMsClass(e=!1){const t=document.querySelectorAll(".btnM");for(let o=0;o<t.length;o++){const n=t[o];e?n.classList.add("downDisabled"):n.classList.remove("downDisabled")}}function handleDownloadClass(e=!1){const t=[".btn.download_video",".btn_download",".click_download",".show__img__download",".popup_success .repeat",".main__content__left .left__show__video__box .download__btn",".tips__box .download__again",".btn_download_clip",".show__img__download_clip",".gened__bottom_download","#canClick"];for(let o=0;o<t.length;o++){const n=t[o],a=document.querySelectorAll(n);if(a?.length)for(let t=0;t<a.length;t++){const o=a[t];e?o.classList.add("downDisabled"):o.classList.remove("downDisabled")}}}function removeAllDownDisabled(){const e=document.querySelectorAll(".downDisabled");for(let t=0;t<e.length;t++){e[t].classList.remove("downDisabled")}}async function setDownloadData(e,t){if(t?.data?.user_id<=0)return Promise.resolve(null);try{const t=await isLocalDownload(e);let o=null;if(t){const{is_localdownload:e,limit_download:n}=t;o={code:1===n&&1!==e?3006:e}}return Promise.resolve(o)}catch(e){return console.error(e),Promise.resolve(null)}}async function isLocalDownload(e=""){if(!getCookie("access_token"))return Promise.resolve(null);try{const t=await jqAjaxPromise({tools:!0,url:"ai/source/is-local-download",type:"POST",data:{type:e},async cb401({resolve:t,reject:o}){try{await newRequestAtoken(),await isLocalDownload(e)}catch(e){t(null)}},notRefreshToken:!0}),o=t?.code,n=t?.data;return 200===o&&n?Promise.resolve(n):Promise.resolve(null)}catch(e){return console.error(e),Promise.resolve(null)}}$((function(){const e=localStorage.getItem("LOCAL_PATH_STORAGE");e&&JSON.parse(e)})),window.addEventListener("load",(function(){lazyLoad(),touchEnlarge(),isShowFooterCookie(),$("#go_credits").click((()=>{window.open("/credit-history.html")})),$("#footer_btn").on("click",(function(){$(".fix-footer").hide(),localStorage.setItem("cookieFooter",(new Date).getTime()+2592e6)})),$("#header .myfileBtn").on("click",(function(e){e.preventDefault(),e.stopPropagation(),gtag("event","click_vidqmyfiles_profilefilebtn"),location.pathname.includes("my-files.html")||window.open("/my-files.html")}))})),$(window).ready((function(){initLoginDialog()})),window.questLanguage=getPreferredLanguage();const newRequestAtoken=async()=>{try{const e=await jqAjaxPromise({url:"/api/user/refresh-token",type:"POST",data:{refresh_token:getCookie("refresh_token")||""}}),t=e?.code,o=e?.data?.access_token,n=e?.data?.refresh_token;return 200===t&&o?(localStorage.setItem("access_token",o),setCookie("access_token",o,30),localStorage.setItem("refresh_token",n),setCookie("refresh_token",n,30),Promise.resolve()):(logoutPage(),Promise.reject())}catch(e){return logoutPage(),Promise.reject()}};var formatter=new Intl.NumberFormat(localeArea[getPreferredLanguage()],{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}),formatterFix2=new Intl.NumberFormat(localeArea[getPreferredLanguage()],{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});async function showCreditDes(){const e="www.vidnoz.com"===location.host?"https://tool-api.vidnoz.com":"https://tool-api-test.vidnoz.com",t=await fetch(`${e}/ai/public/get-country-type`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:getCookie("access_token")?`Bearer ${getCookie("access_token")}`:""}});"T1"!=(await t.json()).data.name&&$(".credit_des_bg_content").addClass("t2")}function changeHeaderCredit(e){const t=$("header-credit")?.[0],o=$("#go_credits");t&&t.updateInfo&&t.updateInfo(),o&&o.find(".credits_num span").text(e)}function showCreditBox(){isLogin()&&document.body.clientWidth<=1200?($(".header-credits-box").addClass("show"),$(".menu-item.credit").show()):($(".header-credits-box").removeClass("show"),$(".menu-item.credit").hide())}function getCountryType(){fetchGet("ai/public/get-country-type").then((e=>{if(200!==e.code)return;const t=e.data.name;"T1"!==t&&"T2"!==t||"ios"!==judgeClient()||"/pricing.html"===document.location.pathname||($(".fix-footer").css("bottom","0.88rem"),$("#iosFooter").show(),$("#ios_footer_btn").click((function(){gtag("event","ar_faceappclick_fcios"),window.location.href="https://apps.apple.com/app/apple-store/id6497986083?pt=127019031&ct=from_ar_vidq&mt=8"})))})).catch((e=>{console.log(e)}))}getCountryType(),window.PRICING_HISTORY_PAGE="PRICING_HISTORY_PAGE","/pricing.html"!==location.pathname&&localStorage.setItem(PRICING_HISTORY_PAGE,location.pathname);