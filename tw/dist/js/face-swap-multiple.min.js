"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,a=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,a){var o=t&&t.prototype instanceof h?t:h,r=Object.create(o.prototype),l=new L(a||[]);return i(r,"_invoke",{value:$(e,n,l)}),r}function _(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",m="suspendedYield",d="executing",g="completed",f={};function h(){}function w(){}function v(){}var b={};s(b,r,(function(){return this}));var y=Object.getPrototypeOf,x=y&&y(y(M([])));x&&x!==n&&a.call(x,r)&&(b=x);var F=v.prototype=h.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,r,l){var c=_(e[i],e,o);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==_typeof(u)&&a.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,r,l)}),(function(e){n("throw",e,r,l)})):t.resolve(u).then((function(e){s.value=e,r(s)}),(function(e){return n("throw",e,r,l)}))}l(c.arg)}var o;i(this,"_invoke",{value:function(e,a){function i(){return new t((function(t,i){n(e,a,t,i)}))}return o=o?o.then(i,i):i()}})}function $(t,n,a){var i=p;return function(o,r){if(i===d)throw Error("Generator is already running");if(i===g){if("throw"===o)throw r;return{value:e,done:!0}}for(a.method=o,a.arg=r;;){var l=a.delegate;if(l){var c=T(l,a);if(c){if(c===f)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(i===p)throw i=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);i=d;var s=_(t,n,a);if("normal"===s.type){if(i=a.done?g:m,s.arg===f)continue;return{value:s.arg,done:a.done}}"throw"===s.type&&(i=g,a.method="throw",a.arg=s.arg)}}}function T(t,n){var a=n.method,i=t.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),f;var o=_(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,f;var r=o.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function M(t){if(t||""===t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(a.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_typeof(t)+" is not iterable")}return w.prototype=v,i(F,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:w,configurable:!0}),w.displayName=s(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,c,"GeneratorFunction")),e.prototype=Object.create(F),e},t.awrap=function(e){return{__await:e}},k(C.prototype),s(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,a,i,o){void 0===o&&(o=Promise);var r=new C(u(e,n,a,i),o);return t.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},k(F),s(F,c,"Generator"),s(F,r,(function(){return this})),s(F,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function e(){for(;n.length;){var a=n.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=M,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(a,i){return l.type="throw",l.arg=t,n.next=a,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],l=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var c=a.call(r,"catchLoc"),s=a.call(r,"finallyLoc");if(c&&s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=e,r.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:M(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),f}},t}function asyncGeneratorStep(e,t,n,a,i,o,r){try{var l=e[o](r),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(a,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){asyncGeneratorStep(o,a,i,r,l,"next",e)}function l(e){asyncGeneratorStep(o,a,i,r,l,"throw",e)}r(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var controllers=[];function getFSMCreditsText(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&t.val>1&&(e+="_p");var n=lan.faceSwapPop02[e];for(var a in t){var i=new RegExp("{{".concat(a,"}}"),"g");n=n.replace(i,t[a])}return n}function getfsCreditsText(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&t.val>1&&(e+="_p");var n=lan.faceSwapPop[e];for(var a in t){var i=new RegExp("{{".concat(a,"}}"),"g");n=n.replace(i,t[a])}return n}var multitextContentObj=lan;function getMultiText(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=lan[e];for(var a in t){var i=new RegExp("{{".concat(a,"}}"),"g");n=n.replace(i,t[a])}return n}var show_ppriority=0,textContentObj=lan.faceSwapPop01;function setTextContentObj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=textContentObj[e];for(var a in t){var i=new RegExp("{{".concat(a,"}}"),"g");n=n.replace(i,t[a])}return n}function getNumberNow(){return multiAiFace?multiAiFace.formdata.avatar_main_key.filter((function(e){return e.main_part_key})).length:0}function isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function setmultitextContentObj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=lan[e];for(var a in t){var i=new RegExp("{{".concat(a,"}}"),"g");n=n.replace(i,t[a])}return n}var photo_task_id=null,canMultiFaceData={},isShowBtnCredit=!1;window.multiphotoAiFaceChanging={};var MultiAiFace=function(){return _createClass((function e(t){var n=this;_classCallCheck(this,e),_defineProperty(this,"getUploadFileUrl",(function(e){var t=e;try{t=e.split("/")[1]||"png"}catch(e){t="png"}return fetchPost("ai/source/temp-upload-url",{file_name:"Vidnoz_AiFaceSwap_"+(new Date).getTime()+"."+t},TOOL_API)})),_defineProperty(this,"uploadFile",(function(e){var t=e.url,n=e.file;return new Promise(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(a,i){var o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetchPut(t,n,"");case 3:o=e.sent,a(o),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message),i(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}())})),_defineProperty(this,"setLiLoading",(function(e){e?$("#multiple_Face_swapper_container .multi_pics li").attr("style","filter: blur(3px);pointer-events: none;"):$("#multiple_Face_swapper_container .multi_pics li").attr("style","")})),_defineProperty(this,"setBigImageStart",(function(e){e?($("#multiple_Face_swapper_container #mult_main_face_change_img").attr("style","filter: blur(5px) brightness(0.7)"),$("#multiple_Face_swapper_container .loading_multi_box p").text(multitextContentObj.Loading),$("#multiple_Face_swapper_container .loading_multi_box").show()):($("#multiple_Face_swapper_container #mult_main_face_change_img").attr("style",""),$("#multiple_Face_swapper_container .loading_multi_box").hide())})),_defineProperty(this,"transtoBlob",(function(e){var t=e.b64data,n=e.contentType,a=void 0===n?"image/png":n;a=a||"";for(var i=1024,o=atob(t.split(",")[1]),r=o.length,l=Math.ceil(r/i),c=new Array(l),s=0;s<l;++s){for(var u=s*i,_=Math.min(u+i,r),p=new Array(_-u),m=u,d=0;m<_;++d,++m)p[d]=o[m].charCodeAt(0);c[s]=new Uint8Array(p)}return new Blob(c,{type:a})})),_defineProperty(this,"setFirstStart",(function(e){e?($("#multiple_Face_swapper_container .multi_upload_before").addClass("loading"),$("#multiple_Face_swapper_container .multi_upload_after").addClass("loading"),$("#multiple_Face_swapper_container .multi_Input").addClass("disabled"),$("#multiple_Face_swapper_container .multi_Input .multi_uploader_btn_con").removeClass("show_btn_con").hide(),$("#multiple_Face_swapper_container .multi_Input .multi_uploader_btn_loading").show(),$("#multiple_Face_swapper_container .multi_uploader_btn .multi_uploader_btn_con").hide(),$("#multiple_Face_swapper_container .multi_uploader_btn .multi_uploader_btn_loading").show(),$("#multiple_Face_swapper_container .people_recognized_list").addClass("inter_loading"),n.form.firstPicLoading=!0,n.setBigImageStart(!0)):($("#multiple_Face_swapper_container .multi_upload_before").removeClass("loading"),$("#multiple_Face_swapper_container .multi_upload_after").removeClass("loading"),$("#multiple_Face_swapper_container .multi_Input").removeClass("disabled"),$("#multiple_Face_swapper_container .multi_Input .multi_uploader_btn_con").show().addClass("show_btn_con"),$("#multiple_Face_swapper_container .multi_Input .multi_uploader_btn_loading").hide(),$("#multiple_Face_swapper_container .multi_uploader_btn .multi_uploader_btn_loading").hide(),$("#multiple_Face_swapper_container .multi_uploader_btn .multi_uploader_btn_con").show(),$("#multiple_Face_swapper_container .people_recognized_list").removeClass("inter_loading"),n.form.firstPicLoading=!1,n.setBigImageStart(!1))})),_defineProperty(this,"checkMultiChangeFaceStatus",(function(){n.formdata.avatar_main_key.some((function(e){return e.main_part_key}))?($("#multiple_Face_swapper_container .change_multi_face_btn ._multi_step3_btn").text(multitextContentObj.step3_btn),$("#multiple_Face_swapper_container .multi-generating-animate").hide(),$("#multiple_Face_swapper_container .change_multi_face_btn").removeClass("disabled"),n.changeFaceLoading=!1):$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled")})),_defineProperty(this,"changeMultiFace",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.changeFaceLoading){e.next=3;break}return e.abrupt("return");case 3:return n.setLoadingStart(!0),n.showToolBtn(!1),e.next=7,n.getCanSwapFaceBool();case 7:if(e.sent){e.next=11;break}return n.setLoadingStart(!1),e.abrupt("return");case 11:a=_objectSpread(_objectSpread({},n.formdata),{},{avatar_main_key:n.formdata.avatar_main_key.filter((function(e){return e.main_part_key})),is_hd:null===(t=multicreditSystem)||void 0===t?void 0:t.is_hd}),fetchPost("ai/ai-tool/add-task",{param:a,action:"multiple_face_swap"},TOOL_API,{"X-TASK-VERSION":"2.0.0"}).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:200===t.code?(showBtnCreditsMultiImage(!0),1===t.data.is_wateremark?showRemoveWatemark_btn(!0):showRemoveWatemark_btn(!1),n.getFinalImg(t.data.task_id)):3014===t.code?(showMaximumM(),n.checkMultiChangeFaceStatus(),(n.mergeKey||"multi_img"!==$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key"))&&n.showToolBtn(!0,!0),n.setFirstStart(!1),n.setLiLoading(!1)):401===t.code?(n.multimodel.errorMessage({conText:multitextContentObj.loginFirst,btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1)):3001===t.code?("multi_img"!==$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key")&&n.showToolBtn(!0,!0),$("#multiple_Face_swapper_container .multi_stpe3_upload .v_step3_btn_credits").show(),multicreditSystem.showCreditBanner(!1),showMaximumM(),n.setLoadingStart(!1)):3008===t.code?showNotEnoughCreditsM():(n.multimodel.errorMessage({conText:"\n              <h1>".concat(multitextContentObj.faceSwapPop01.errorUploadTitle,"</h1>\n              <p>").concat(multitextContentObj.faceSwapPop01.errorUpload,"</p>\n            "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),n.multimodel.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.errorUploadTitle,"</h1>\n            <p>").concat(multitextContentObj.faceSwapPop01.errorUpload,"</p>\n          "),btnText:multitextContentObj.OK}),n.checkMultiChangeFaceStatus(),n.multimodel.options.visible=!0,n.setLoadingStart(!1)}));case 13:case"end":return e.stop()}}),e)})))),_defineProperty(this,"checkFileType",(function(e){if("string"==typeof e)return!0;var t=e.type;return isMobileDevice()&&e.size>104857600?(n.multimodel.errorMessage({conText:"\n          <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n          <p>").concat(getFSMCreditsText("toolarge",{val:100}),"</p>\n        "),btnText:textContentObj.ok}),n.multimodel.options.visible=!0,n.setBigImageStart(!1),n.setFirstStart(!1),!1):!!["image/jpeg","image/png","image/webp","application/octet-stream"].includes(t)||(n.multimodel.errorMessage({conText:"\n          <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n          <p>").concat(multitextContentObj.faceSwapPop01.limit,"</p>\n        "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setBigImageStart(!1),n.setFirstStart(!1),$("#multiple_Face_swapper_container #multi_uploader")[0].value="",!1)})),_defineProperty(this,"getFinalImg",(function(e){var t=n;n.showToolBtn(!1),n.setLoadingStart(!0),n.taskid=e,fetchPost("ai/tool/get-task",{id:e},TOOL_API).then((function(a){if(a.message.includes("nsfw")){var i,o=multitextContentObj.nsfw_photo;return null!==(i=t.canMultiFaceData.data)&&void 0!==i&&i.credit&&(o=multitextContentObj.faceSwapPop01.Credits_failed_nsfw),n.multimodel.errorMessage({conText:"\n              <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n              <p>").concat(o,"</p>\n            "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1),t.setLoadingMaskTip(!1),void("multi_img"!==$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key")&&n.showToolBtn(!0,!0))}if(a.message.includes("celebrity")){var r,l=multitextContentObj.faceSwapPop01.Target_Photo;return null!==(r=t.canMultiFaceData.data)&&void 0!==r&&r.credit&&(l=multitextContentObj.faceSwapPop01.Credits_failed_celebrity),n.multimodel.errorMessage({conText:"\n              <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n              <p>").concat(l,"</p>\n            "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1),t.setLoadingMaskTip(!1),void("multi_img"!==$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key")&&n.showToolBtn(!0,!0))}if(a.message.includes("faces=")&&a.message.includes("faces=0")){var c,s=multitextContentObj.NoFaceMulti;return null!==(c=t.canMultiFaceData.data)&&void 0!==c&&c.credit&&(s=multitextContentObj.faceSwapPop01.Credits_failed_NoFaceMulti),n.multimodel.errorMessage({conText:"\n                <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n                <p>").concat(s,"</p>\n              "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1),t.setLoadingMaskTip(!1),void("multi_img"!==$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key")&&n.showToolBtn(!0,!0))}if(200!==a.code){var u,_=multitextContentObj.faceSwapPop01.processImage;null!==(u=n.canMultiFaceData.data)&&void 0!==u&&u.credit&&(_=multitextContentObj.faceSwapPop01.Credits_failed),n.multimodel.errorMessage({conText:"\n              <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n              <p>").concat(_,"</p>\n            "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1),t.setLoadingMaskTip(!1)}else{var p,m,d;if(1===(null===(p=a.data.wait)||void 0===p?void 0:p.show_wait)){0==show_ppriority&&(gtag("event","show_mulfaceswap_imgpriority"),show_ppriority++);var g=a.data.wait,f=g.num,h=g.second;t.setLoadingMaskTip(!0,{show_wait:1,num:f,second:h})}else t.setLoadingMaskTip(!1);if(n.tryCount=0,0===a.data.status)show_ppriority=0,n.mergeImgUrl=null===(m=a.data.additional_data)||void 0===m?void 0:m.merge_url,n.mergeKey=null===(d=a.data.additional_data)||void 0===d?void 0:d.merge_key,setCookie("faceSwapTime_swap",Date.now(),2),window.userRuleConfig.credit=a.data.credit,multicreditSystem.showCreditBanner({bool:!0}),multiVcreditSystem.showCreditBanner({bool:!0}),changeHeaderCredit(a.data.credit),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key",""),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",n.mergeImgUrl),gtag("event","succ_mulfaceswap_imgswapbtn"),n.lastSuccessTaskid=n.taskid,setTimeout((function(){n.setLoadingStart(!1),$("#multiple_Face_swapper_container .change_multi_face_btn").removeClass("disabled"),n.showToolBtn(!0)}),1e3);else setTimeout((function(){n.getFinalImg(e)}),2e3)}})).catch((function(t){if(console.error(t),n.tryCount>=3){var a,i=multitextContentObj.faceSwapPop01.processImage;null!==(a=n.canMultiFaceData.data)&&void 0!==a&&a.credit&&(i=multitextContentObj.faceSwapPop01.Credits_failed),n.multimodel.errorMessage({conText:"\n                <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n                <p>").concat(i,"</p>\n              "),btnText:multitextContentObj.OK}),n.multimodel.options.visible=!0,n.setLoadingStart(!1),n.setLoadingMaskTip(!1)}else console.log("retrying"),setTimeout((function(){n.getFinalImg(e),n.tryCount++}),5e3)}))})),_defineProperty(this,"faceCheck",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blobUrl,a=void 0===n?"":n,e.abrupt("return",new Promise((function(e,t){var n=new Image;n.src=a,n.onload=_asyncToGenerator(_regeneratorRuntime().mark((function a(){var i,o;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,faceapi.detectAllFaces(n,new faceapi.SsdMobilenetv1Options);case 3:if(!(i=a.sent).length){a.next=8;break}e(i.length),a.next=12;break;case 8:return a.next=10,faceapi.detectAllFaces(n,new faceapi.TinyFaceDetectorOptions({inputSize:416}));case 10:o=a.sent,e(o.length);case 12:a.next=18;break;case 14:a.prev=14,a.t0=a.catch(0),console.log(a.t0),t(a.t0);case 18:case"end":return a.stop()}}),a,null,[[0,14]])}))),n.onerror=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(error),t(error);case 2:case"end":return e.stop()}}),e)})))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_defineProperty(this,"checkFacePicMulti",(function(e){return new Promise(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,a){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{"string"!=typeof e&&URL.createObjectURL(e),n(1)}catch(e){a(e)}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())})),_defineProperty(this,"showModalAboutFaceNumber",(function(e,t){$("#multiple_Face_swapper_container .multi_uploader_multi")[0].value="";var a=multitextContentObj.NoFaceMulti;e&&e>1&&(a=multitextContentObj.faceSwapPop01.manyFace),n.multimodel.errorMessage({conText:"\n        <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n        <p>").concat(a,"</p>\n      "),btnText:multitextContentObj.faceSwapPop01.replaceImg,btnClick:function(){"faces_recognized"===t?$("#multiple_Face_swapper_container #multi_uploader").click():$("#multiple_Face_swapper_container .multi_uploader_multi").click()}}),n.multimodel.options.visible=!0}));var a=this;this.multimodel=t.multimodel,a.setMaskUnlockPriority(),Object.setPrototypeOf(e.prototype,this.data()),this.form=new Proxy(a.proxyData,{set:function(e,t,n){return e[t]=n,e.originImage?a.handleOriginImageExist():($("#multiple_Face_swapper_container .multi_upload_before").show(),$("#multiple_Face_swapper_container .multi_upload_after").hide(),$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled")),e.firstPicLoading?($("#multiple_Face_swapper_container .multi_Input").addClass("disabled"),$("#multiple_Face_swapper_container .random_btn").addClass("disabled")):($("#multiple_Face_swapper_container .multi_Input").removeClass("disabled"),$("#multiple_Face_swapper_container .random_btn").removeClass("disabled")),!0},get:function(e,t){return e[t]}})}),[{key:"data",value:function(){return{mergeImg:{width:0,height:0},proxyData:{originImage:null,firstPicLoading:!1},tryCount:0,multipleIndex:null,delay:2e3,lastCall:0,lastSuccessTaskid:null,taskid:null,imgList:[],mergeImgUrl:null,mergeKey:null,changeFaceLoading:!1,canMultiFaceData:{},showCreditBannerBool:!0,uploadFacesNumber:0,costCoins:0,formdata:{avatar_obey_key:null,get_face_id:null,watermark_type:2,avatar_main_key:[]},itemLoading:[]}}},{key:"resizeImageByFile",value:function(e){var t=this;return new Promise((function(n,a){var i=new FileReader;i.onloadend=function(){var e=new Image;e.onload=function(){var a=document.createElement("canvas"),i=a.getContext("2d"),o=Math.max(e.width,e.height);if(o>1920){var r=1920/o;a.width=e.width*r,a.height=e.height*r}else a.width=e.width,a.height=e.height;i.drawImage(e,0,0,a.width,a.height);var l=a.toDataURL(),c=t.transtoBlob({b64data:l,contentType:"image/png"}),s="width";a.width<a.height&&(s="height"),n({blog:c,imgType:s})},e.onerror=function(){a(new Error("Image load failed"))},e.src=i.result},i.onerror=a,i.readAsDataURL(e)}))}},{key:"handleOriginImageExist",value:function(){$("#multiple_Face_swapper_container .multi_upload_before").hide(),$("#multiple_Face_swapper_container .multi_upload_after").show(),$("#multiple_Face_swapper_container .drag_loadbox").addClass("height160")}},{key:"addMultiImage",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a,i,o,r,l,c,s,u,_,p,m,d,g,f,h;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.addData,a=void 0===n?{}:n,i=t.file,o=t.callback,r=t.ourPicsIndex,l=void 0===r?null:r,c=(null==a?void 0:a.demoKey)||void 0,this.setFirstStart(!0),showRemoveWatemark_btn(!1),"string"==typeof i||this.checkFileType(i)){e.next=6;break}return e.abrupt("return");case 6:if(e.prev=6,this.setLiLoading(!0),"string"==typeof i){e.next=18;break}return e.next=11,this.checkFacePicMulti(i);case 11:if(!(e.sent<1)){e.next=18;break}return $("#multiple_Face_swapper_container .multi_uploader_multi")[0].value="",this.setFirstStart(!1),this.setLiLoading(!1),this.showModalAboutFaceNumber(),e.abrupt("return");case 18:if(this.showToolBtn(!1),$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled"),p=i.type,!c){e.next=27;break}s=a.demoSrc,u=a.demoSrc,this.formdata.avatar_obey_key=c,e.next=37;break;case 27:return e.next=29,this.uploadMultiImagePromise(i);case 29:m=e.sent,d=m.blog,g=m.res,f=m.imgType,this.formdata.avatar_obey_key=g.data.key,s=d,_=f,u=URL.createObjectURL(s);case 37:this.mergeKey=null,h={file:s,showUrl:u,suffix:p,demoKey:c},this.uploadFacesNumber=0,showBtnCreditsMultiImage(!1),o&&o(h,_,l),e.next=55;break;case 44:e.prev=44,e.t0=e.catch(6),console.error(e.t0),multitextContentObj.faceSwapPop01.upload_file_failed,window.userRuleConfig.credit&&multitextContentObj.faceSwapPop01.upload_file_failed_credits,this.multimodel.errorMessage({conText:"\n        <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n        <p>").concat(textContentObj.filereadfail,"</p>\n        "),btnText:multitextContentObj.OK}),this.checkMultiChangeFaceStatus(),this.multimodel.options.visible=!0,$("#multiple_Face_swapper_container .multi_uploader_multi")[0].value="",this.setFirstStart(!1),this.setLiLoading(!1);case 55:case"end":return e.stop()}}),e,this,[[6,44]])}))),function(e){return i.apply(this,arguments)})},{key:"addFindFacesTask",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.changeFaceLoading=!0,e.next=4,fetchPost("ai/ai-tool/add-task",{action:"multiple_get_face",param:{avatar_obey_key:this.formdata.avatar_obey_key}},TOOL_API,{"X-TASK-VERSION":"2.0.0"});case 4:n=e.sent,a=n.data,200===(i=n.code)?(this.formdata.get_face_id=a.task_id,this.getFindFacesTask(t)):3014===i?(this.changeFaceLoading=!1,showMaximumM(),this.checkMultiChangeFaceStatus(),this.setFirstStart(!1),this.setLiLoading(!1)):(this.changeFaceLoading=!1,this.multimodel.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n          "),btnText:multitextContentObj.OK}),this.multimodel.options.visible=!0,this.setFirstStart(!1),this.setLiLoading(!1),this.checkMultiChangeFaceStatus()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),this.changeFaceLoading=!1,console.error(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e){return a.apply(this,arguments)})},{key:"getFindFacesTask",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,a=this.formdata.get_face_id){e.next=5;break}return this.changeFaceLoading=!1,e.abrupt("return");case 5:fetchPost("ai/tool/get-task",{id:a},TOOL_API).then((function(e){if(e.message.includes("no face"))return i.changeFaceLoading=!1,i.multimodel.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n            <p>").concat(multitextContentObj.NoFaceMulti,"</p>\n          "),btnText:multitextContentObj.OK}),i.multimodel.options.visible=!0,i.setLoadingStart(!1),i.setLoadingMaskTip(!1),$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled"),i.formdata.avatar_main_key=[],n.setMultipleListImgs(),void $("#multiple_Face_swapper_container .people_recognized_box").hide();if(200!==e.code){i.changeFaceLoading=!1;var a=multitextContentObj.faceSwapPop01.processImage;i.multimodel.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n            <p>").concat(a,"</p>\n          "),btnText:multitextContentObj.OK}),i.multimodel.options.visible=!0,i.setLoadingStart(!1),i.setLoadingMaskTip(!1)}else i.tryCount=0,0===e.data.status?(i.formdata.avatar_main_key=e.data.additional_data.map((function(e){return{obey_part_key:e.avatar_part_key,obey_part_url:e.avatar_part_url}})),n.setMultipleListImgs(),null==t||t(),setTimeout((function(){i.changeFaceLoading=!1,$("#multiple_Face_swapper_container .people_recognized_box").show(),i.setFirstStart(!1),i.setLiLoading(!1)}),1e3)):setTimeout((function(){i.getFindFacesTask(t)}),2e3)})).catch((function(e){i.changeFaceLoading=!1,i.tryCount>=3?(i.multimodel.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n            <p>").concat(multitextContentObj.processImage,"</p>\n          "),btnText:multitextContentObj.OK}),i.multimodel.options.visible=!0,i.setLoadingStart(!1)):(console.log("retrying"),setTimeout((function(){i.getFinalImg(a),i.tryCount++}),5e3))}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"urlToFile",value:function(e){return new Promise((function(t,n){fetch(e).then((function(e){return e.blob()})).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"setLoadingStart",value:function(e){e?($("#multiple_Face_swapper_container .random_btn").addClass("disabled"),this.setFirstStart(!0),$("#multiple_Face_swapper_container .change_multi_face_btn ._multi_step3_btn").text(multitextContentObj.Generating),$("#multiple_Face_swapper_container .multi-generating-animate").show(),this.changeFaceLoading=!0,$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("style","filter: blur(5px) brightness(0.7)"),$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled"),this.setLiLoading(!0),$("#multiple_Face_swapper_container .loading_multi_box p").text(getMultiText("Loading2")),$("#multiple_Face_swapper_container .loading_multi_box").show(),$("#multiple_Face_swapper_container .people_recognized_list").addClass("inter_loading"),$(".high_quality_append_dom").attr("style","pointer-events:none")):(this.setFirstStart(!1),$("#multiple_Face_swapper_container .random_btn").removeClass("disabled"),$("#multiple_Face_swapper_container .change_multi_face_btn ._multi_step3_btn").text(multitextContentObj.step3_btn),$("#multiple_Face_swapper_container .multi-generating-animate").hide(),$("#multiple_Face_swapper_container .change_multi_face_btn").removeClass("disabled"),this.changeFaceLoading=!1,this.setLiLoading(!1),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("style",""),$("#multiple_Face_swapper_container .loading_multi_box").hide(),$("#multiple_Face_swapper_container .people_recognized_list").removeClass("inter_loading"),$(".high_quality_append_dom").attr("style",""))}},{key:"showToolBtn",value:function(e){if(e){var t=window.getComputedStyle(document.querySelector("#mult_main_face_change_img"));this.mergeImg={width:t.getPropertyValue("width").split("px")[0],height:t.getPropertyValue("height").split("px")[0]},$("#multiple_Face_swapper_container .multi_img_btns").attr("style","display: flex;")}else $("#multiple_Face_swapper_container .multi_img_btns").hide()}},{key:"getImgList",value:function(){var e=this,t=this;fetchGet("ai/public/pic-example?action=multiple_face_swap&water_type=2").then((function(n){if(401===n.code)return e.multimodel.errorMessage({conText:multitextContentObj.loginFirst,btnText:multitextContentObj.OK}),e.multimodel.options.visible=!0,void $("#multiple_Face_swapper_container .multi_pics").html(multitextContentObj.loginFirst);t.imgList=n.data,n.data.forEach((function(e,t){$("#multiple_face_swapper_try .photo-content-box .content-box").append('\n            <li><img src="'.concat(e.pic_url,'" data-key="').concat(e.pic_key,'" data-index="').concat(t+1,'"/></li> \n          '))})),$("#multiple_face_swapper_try .photo-content-box .content-box li").each((function(){var e=this;$(this).on("click",(function(n){var a=$(e).find("img").attr("src"),i=$(e).find("img").attr("data-key");a&&!t.changeFaceLoading&&(gtag("event","click_mulfaceswap_imgtpl"),t.showToolBtn(!1),t.addMultiImage({addData:{demoKey:i,demoSrc:a},file:a,callback:function(e,n,a){var i="width"===n?"height":"width";$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key","multi_img"),$("#multiple_Face_swapper_container .multi_img").find("img").attr("src",e.showUrl).removeClass(i).addClass("".concat(n)),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",e.showUrl),t.form.originImage=e,t.addFindFacesTask((function(){a||$("#multiple_Face_swapper_container #multi_img").attr("data-index",null),a&&$("#multiple_Face_swapper_container #multi_img").attr("data-index",a)}))},ourPicsIndex:$(e).index()+1}))}))}))})).catch((function(e){console.error("fail",e)}))}},{key:"uploadMultiImagePromise",value:function(e){var t=this;return new Promise(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function n(a,i){var o,r,l,c;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.getUploadFileUrl(e.type);case 3:return o=n.sent,n.next=6,t.resizeImageByFile(e);case 6:r=n.sent,l=r.blog,c=r.imgType,t.uploadFile({url:o.data.upload_url,file:l}).then((function(e){a({res:o,blog:l,imgType:c})})).catch((function(e){return i(e)})),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),console.log(n.t0),i(!1);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getSourceUrl",value:function(e){return fetchPost("ai/source/get-access-url",{key:e,file_name:"Vidnoz_AiFaceSwap_"+(new Date).getTime()+".png"})}},{key:"setDragLoading",value:function(e,t){t?(this.proxyData.originImage?$(".".concat(e," .can_drag_box")).addClass("blur"):$(".".concat(e," .other_box")).addClass("blur"),$(".".concat(e," .drag_loadbox")).show()):($(".".concat(e," .other_box")).removeClass("blur"),$(".".concat(e," .can_drag_box")).removeClass("blur"),$(".".concat(e," .drag_loadbox")).hide())}},{key:"throttle",value:function(e,t){var n=0;return function(){var a=(new Date).getTime();a-n>=t&&(e.apply(void 0,arguments),n=a)}}},{key:"getCanSwapFaceBool",value:function(){var e=this;return new Promise(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,a){var i,o,r,l;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getCanSwapFaceData();case 2:if(!getCookie("access_token")){t.next=20;break}if(200!==(null===(i=e.canMultiFaceData)||void 0===i?void 0:i.code)){t.next=12;break}if(1!==(null===(o=e.canMultiFaceData.data)||void 0===o?void 0:o.last_use_credit)||0!==(null===(r=e.canMultiFaceData.data)||void 0===r?void 0:r.credit)){t.next=9;break}return t.next=7,showRemoveWatermarkM();case 7:l=t.sent,n(l);case 9:n(!0),t.next=18;break;case 12:if(3008!==e.canMultiFaceData.code){t.next=16;break}return showNotEnoughCreditsM(),n(!1),t.abrupt("return");case 16:showMaximumM(),n(!1);case 18:t.next=21;break;case 20:200!==e.canMultiFaceData.code?(showMaximumM(),n(!1)):n(!0);case 21:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"setLoadingMaskTip",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.maskSpan,t.show_wait),a=t.num,i=t.second,o=$("#multiple_Face_swapper_container #createTaskMaskPhoto"),r=$("#multiple_Face_swapper_container #multiple_Face_swapper_container .v_mask_background");if(e){if(1===n){o.find(".v_mask_content2").show();var l=i,c="wait_minutes";i>=60?l=Math.ceil(i/60):c="wait_seconds",o.find(".v_mask_content2 .v_mask_span").html(setTextContentObj("estimated_wait_time",{val:a,val2:l,val3:setTextContentObj(c)}))}else o.find(".v_mask_content2").hide();o.show(),r.show()}else o.hide(),r.hide()}},{key:"setMaskUnlockPriority",value:function(){$("#multiple_Face_swapper_container #createTaskMaskPhoto .v_mask_unlock_priority").on("click",(function(e){setSessionCookie("st","mulcreditpriority"),gtag("event","click_mulfaceswap_imgpriority")}))}},{key:"setMultipleListImgs",value:function(){var e=this,t=$("#multiple_Face_swapper_container #people_recognized_list");if(t){var n="";t.html(),e.itemLoading=[],this.formdata.avatar_main_key.forEach((function(t){e.itemLoading.push(!1),n+='\n          <div class="people_recognized_item">\n            <img src="'.concat(t.obey_part_url,'" />\n            <div class="add_icon_box">\n              <img class="add_icon_img" src="" style="display: none" />\n              <img class="add_icon" src="/dist/img/face-swap/icon_add_i.svg" />\n              <div class="add_icon_loading" style="display: none"></div>\n              <div class="add_icon_change"></div>\n            </div>\n            <div class="add_icon_close" style="display: none"></div>\n          </div>\n        ')})),t.html(n),$("#multiple_Face_swapper_container .people_recognized_item").each((function(t){var n=$(this).index(),a=$(this);a.find(".add_icon_box").on("click",(function(){e.multipleIndex=n,gtag("event","up_mulfaceswap_targetimg"),$("#multiple_Face_swapper_container #multi_uploader").click()})),a.find(".add_icon_close").on("click",(function(){var t;a.find(".add_icon").show(),a.find(".add_icon_img").hide(),a.find(".add_icon_close").hide(),e.formdata.avatar_main_key[n]&&(e.formdata.avatar_main_key[n].main_part_key=void 0),e.checkMultiChangeFaceStatus();var i=null===(t=e.formdata.avatar_main_key.filter((function(e){return e.main_part_key})))||void 0===t?void 0:t.length;showBtnCreditsMultiImage(i>0)})),a.on("dragover",(function(e){e.preventDefault(),a.find(".add_icon_loading").attr("style").includes("display: none")&&a.addClass("draggable")})),a.on("dragenter",(function(e){e.preventDefault(),a.find(".add_icon_loading").attr("style").includes("display: none")&&a.addClass("draggable")})),a.on("dragleave",(function(e){e.preventDefault(),a.find(".add_icon_loading").attr("style").includes("display: none")&&a.removeClass("draggable")})),a.on("drop",(function(t){if(t.preventDefault(),a.removeClass("draggable"),a.find(".add_icon_loading").attr("style").includes("display: none")){if(1!==t.originalEvent.dataTransfer.files.length)return e.multimodel.errorMessage({conText:"<h1>".concat(textContentObj.processImageTitle,"</h1>\n              <p>").concat(multitextContentObj.faceSwapPop01.onlyone,"</p>"),btnText:multitextContentObj.OK}),void(e.multimodel.options.visible=!0);gtag("event","up_mulfaceswap_targetimg"),e.multipleIndex=n,e.itemUploading(t.originalEvent.dataTransfer.files[0])}}))}))}}},{key:"setCurrentImgLoading",value:function(e,t){var n=this.itemLoading;e?(n[t]=!0,$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_loading").show(),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_close").hide(),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon").hide(),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_img").hide(),$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled"),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_box").addClass("disabled")):(n[t]=!1,n.some((function(e){return!0===e}))||this.form.firstPicLoading?$("#multiple_Face_swapper_container .change_multi_face_btn").addClass("disabled"):$("#multiple_Face_swapper_container .change_multi_face_btn").removeClass("disabled"),this.formdata.avatar_main_key[t].main_part_key||$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon").show(),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_loading").hide(),$("#multiple_Face_swapper_container .people_recognized_item").eq(t).find(".add_icon_box").removeClass("disabled"))}},{key:"itemUploading",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,a,i,o,r,l,c,s,u,_;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.itemLoading,"string"==typeof t||this.checkFileType(t)){e.next=4;break}return $("#multiple_Face_swapper_container #multi_uploader")[0].value="",e.abrupt("return");case 4:if(n=$("#multiple_Face_swapper_container .people_recognized_item .add_icon").eq(this.multipleIndex),a=$("#multiple_Face_swapper_container .people_recognized_item .add_icon_img").eq(this.multipleIndex),$("#multiple_Face_swapper_container .people_recognized_item .add_icon_close").eq(this.multipleIndex),i=this.multipleIndex,n){e.next=10;break}return e.abrupt("return");case 10:return this.setCurrentImgLoading(!0,i),e.next=13,this.checkFacePicMulti(t);case 13:return e.sent,o={},e.prev=15,e.next=18,this.uploadMultiImagePromise(t);case 18:o=e.sent,e.next=30;break;case 21:return e.prev=21,e.t0=e.catch(15),c=multitextContentObj.faceSwapPop01.upload_file_failed,$("#multiple_Face_swapper_container #multi_uploader")[0].value="",this.multimodel.errorMessage({conText:"\n        <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n        <p>").concat(c,"</p>\n        "),btnText:multitextContentObj.OK}),this.multimodel.options.visible=!0,this.setCurrentImgLoading(!1,i),this.checkMultiChangeFaceStatus(),e.abrupt("return");case 30:u=(s=o).blog,_=s.res,s.imgType,r=u,l=URL.createObjectURL(r),n.hide(),a.attr("src",l),a.show(),console.log(_),this.formdata.avatar_main_key[i]=_objectSpread(_objectSpread({},this.formdata.avatar_main_key[i]),{},{main_part_key:_.data.key}),$("#multiple_Face_swapper_container .change_multi_face_btn").removeClass("disabled"),this.setCurrentImgLoading(!1,i),$("#multiple_Face_swapper_container .people_recognized_item").eq(i).find(".add_icon_close").show(),$("#multiple_Face_swapper_container #multi_uploader")[0].value="",showBtnCreditsMultiImage(!0);case 44:case"end":return e.stop()}}),e,this,[[15,21]])}))),function(e){return t.apply(this,arguments)})},{key:"getCanSwapFaceData",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.abrupt("return",new Promise(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,a){var i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetchPost("ai/tool/can-face",{action:"multiple_face_swap"},TOOL_API);case 3:o=e.sent,t.canMultiFaceData=o,changeHeaderCredit(null==o||null===(i=o.data)||void 0===i?void 0:i.credit),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:n();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"eventLoginsuccess",value:function(){var e=this;document.querySelector("my-component").addEventListener("loginsuccess",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(n){var a,i,o,r,l;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,multiAiFace.getCanSwapFaceData();case 2:l=null===(a=e.formdata.avatar_main_key.filter((function(e){return e.main_part_key})))||void 0===a?void 0:a.length,null!==(i=e.formdata)&&void 0!==i&&i.avatar_main_key&&l>0&&showBtnCreditsMultiImage(!0),isLogin(!0),multicreditSystem.showCreditBanner({bool:!0}),multiVcreditSystem.showCreditBanner({bool:!0}),multiVcreditSystem.setHighQualityHtml($(".high_quality_append_dom_multiv"),1!==(null===(o=window.userRuleConfig)||void 0===o?void 0:o.is_subscriber),(function(){gtag("event","alert_faceswap_hd_v"),showHdCredits({clickfn:function(){gtag("event","click_faceswap_hd_v")},type:"multiv"})}),"multiv"),multicreditSystem.setHighQualityHtml($(".high_quality_append_dom"),1!==(null===(r=window.userRuleConfig)||void 0===r?void 0:r.is_subscriber),(function(){gtag("event","alert_faceswap_hd_m"),showHdCredits({clickfn:function(){gtag("event","click_faceswap_hd_m")},type:"multi"})}),"multi");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]);var e,t,n,a,i}(),MutiModel=function(){return _createClass((function e(){_classCallCheck(this,e);var t=this;this.options=new Proxy({visible:!1,type:"error",downloading:!1,downloadUrl:null,downloadType:0},{set:function(e,n,a){if(e[n]=a,"visible"===n)t.controlVisible(a);return!0},get:function(e,t){return e[t]}})}),[{key:"controlVisible",value:function(e){e?$("#multiple_Face_swapper_container #multi_change_face_modal").show():$("#multiple_Face_swapper_container #multi_change_face_modal").hide()}},{key:"errorMessage",value:function(e){var t=e.conText,n=e.btnText,a=e.btnClick;$("#multiple_Face_swapper_container .change_face_modal_content").html('\n      <div class="error_con">\n          <div class="error_p">'.concat(t,"</div>\n          </div>\n      ")),$("#multiple_Face_swapper_container .change_face_modal_btns").html('\n      <div class="change_face_modal_btn">'.concat(n,"</div>\n    ")),$("#multiple_Face_swapper_container .change_face_modal_btn").on("click",(function(){a&&a(),$("#multiple_Face_swapper_container #multi_change_face_modal").hide()}))}},{key:"downloadMessage",value:function(){var e=this;$("#multiple_Face_swapper_container #multi_change_face_modal").attr("style","width: 550px;height: 125px"),$("#multiple_Face_swapper_container .change_face_modal_btns").hide(),$("#multiple_Face_swapper_container .close_btn").hide(),$("#multiple_Face_swapper_container .change_face_modal_content").html('\n      <div class="download_multi_con">\n        <p class="loading_download_title">'.concat(multitextContentObj.faceSwapPop01.downloading,'</p>\n        <div class="loading_prograss">\n          <div class="loading_prograss_con"></div>\n        </div>\n      </div>\n    '));var t=0,n=setInterval((function(){if((t+=1)>=90&&(t=90),!e.options.downloading)return $("#multiple_Face_swapper_container .close_btn").show(),clearInterval(n),void(1===e.options.downloadType?($("#multiple_Face_swapper_container .loading_prograss_con").attr("style","width: 100%"),setTimeout((function(){e.options.visible=!1,e.downloadSuccess(),e.options.visible=!0}),500)):2===e.options.downloadType&&setTimeout((function(){e.options.visible=!1,e.downloadError(),e.options.visible=!0}),500));$("#multiple_Face_swapper_container .loading_prograss_con").attr("style","width: ".concat(t,"%"))}),50)}},{key:"downloadSuccess",value:function(){var e=this;$("#multiple_Face_swapper_container .change_face_modal_btns").show(),$("#multiple_Face_swapper_container .close_btn").show(),$("#multiple_Face_swapper_container #multi_change_face_modal").attr("style","padding: 20px 25px;"),$("#multiple_Face_swapper_container .change_face_modal_content").html('\n      <div class="download_con">\n        <h1>'.concat(multitextContentObj.faceSwapPop01.downloadH1,'</h1>\n        <p class="download_con_p">').concat(multitextContentObj.faceSwapPop01.downloadTips,"</p>\n      </div>\n    ")),$("#multiple_Face_swapper_container .change_face_modal_btns").html('\n      <div class="change_face_modal_btn">'.concat(multitextContentObj.faceSwapPop01.continue,"</div>\n    ")),$("#multiple_Face_swapper_container .change_face_modal_btn").on("click",(function(){e.options.visible=!1,$("#multiple_Face_swapper_container #multi_change_face_modal").hide()})),$("#multiple_Face_swapper_container .click_multi_me").on("click",_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,checkFileExpired(e.options.downloadUrl);case 2:if(t.sent){t.next=9;break}return e.errorMessage({conText:"\n            <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n            <p>").concat(multitextContentObj.expired_file,"</p>\n          "),btnText:multitextContentObj.OK}),e.options.downloadType=0,e.options.downloading=!1,e.options.visible=!0,t.abrupt("return");case 9:$(this).attr("href",e.options.downloadUrl),$(this).click();case 11:case"end":return t.stop()}}),t,this)}))))}},{key:"downloadError",value:function(){$("#multiple_Face_swapper_container #multi_change_face_modal").attr("style",""),$("#multiple_Face_swapper_container .change_face_modal_btns").show(),this.errorMessage({conText:"\n        <h1>".concat(multitextContentObj.faceSwapPop01.downloadError,"</h1>\n        <p>").concat(multitextContentObj.faceSwapPop01.errorUpload,"</p>\n      "),btnText:multitextContentObj.OK})}}])}(),MutiCreditPhotoModel=function(){return _createClass((function e(t,n,a){_classCallCheck(this,e),this.element=t,this.showModelIndex=0,this.data=n,this.type=a,this.onloadMessage()}),[{key:"onloadMessage",value:function(){var e=this,t=this;this.element.find(".win_icon_close").click((function(){t.data.setLoadingStart(!1),e.closeModel(),4===e.showModelIndex&&e.buttonClick1()})),this.element.find(".v_other_button").click((function(){e.buttonClick()})),this.element.find(".v_other_button1").click((function(){e.buttonClick1()}))}},{key:"buttonClick",value:function(){}},{key:"buttonClick1",value:function(){}},{key:"showNotEnoughCredits",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.showModelIndex=1,this.type?gtag("event","show_miofs_mulnocredit_mv"):gtag("event","show_miofs_mulnocredit");var t=this,n=getFSMCreditsText("Model_not_credits_title"),a=getFSMCreditsText("Model_not_credit_span",{val:e},!0),i=getFSMCreditsText("Model_not_credits_btn");this.element.find(".v_message_icon_notCredits").css({display:"block"}),this.buttonClick=function(){this.type?(gtag("event","click_miofs_mulnocredit_mv"),setSessionCookie("st","mulnocreditmv"),multiAiFaceV.uploadFacesNumber>3?(gtag("event","click_miofs_mulnocredit_10mv"),setCookie("st","mulnocreditm_10mv")):(gtag("event","click_miofs_mulnocredit_3mv"),setCookie("st","mulnocreditm_3mv"))):(getNumberNow()>6?(gtag("event","click_miofs_mulnocredit_10m"),setCookie("st","mulnocreditm_10m")):(gtag("event","click_miofs_mulnocredit_6m"),setCookie("st","mulnocreditm_6m")),gtag("event","click_miofs_mulnocredit"),setSessionCookie("st","mulnocredit")),t.data.setLoadingStart(!1),setTimeout((function(){t.closeModel()}),500)},this.showModel({title:n,spanHtml:a,buttonText:i})}},{key:"showModel",value:function(e){var t=e.title,n=e.spanHtml,a=e.buttonText,i=e.buttonText1;this.element.find(".v_error_title").text(t),this.element.find(".v_error_span").html(n),this.element.find(".v_button_text").text(a),this.element.find(".v_button_text1").text(i),this.element.css({display:"block"})}},{key:"closeModel",value:function(){this.element.css({display:"none"}),this.element.find(".v_message_icon").css({display:"none"}),this.element.find(".v_other_button1").css({display:"none"}),this.showModelIndex=0}}])}(),createMultiDialog=function(e,t){$("#large_multi_face_modal .large_multi_img").attr("src",e),t.mergeImg.width>t.mergeImg.height?$("#large_multi_face_modal .large_multi_img").removeClass("height").addClass("width"):$("#large_multi_face_modal .large_multi_img").removeClass("width").addClass("height");var n=document.querySelector(".large_multi_img");window.getComputedStyle(n);$("#large_multi_face_modal .multi_img_btns").attr("style","display: flex;"),$("#large_multi_face_modal").attr("style","display: flex")},muticreditsPhotoModel=null;function showNotEnoughCreditsM(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;gtag("event","alert_mulfaceswap_imgnocredit"),multicreditSystem.showCreditPopup({title:getfsCreditsText("Model_not_credits_title"),content:getfsCreditsText("Model_not_credit_span",{val:e},!0),btn:getfsCreditsText("Model_not_credits_btn"),btnFn:function(){gtag("event","click_mulfaceswap_imgnocredit"),setCookie("st","mulfsimgnocredit")},modalCoins:"notenough"})}function showMaximumM(){var e;gtag("event","alert_mulfaceswap_imgmaxlimit"),multicreditSystem.showCreditPopup({title:textContentObj.exceedTitle,content:getfsCreditsText("Model_Maximum_span",{val:null===(e=window)||void 0===e||null===(e=e.userRuleConfig)||void 0===e?void 0:e.m_times},!0),btn:getfsCreditsText("Model_Unlock_btn"),btnFn:function(){gtag("event","click_mulfaceswap_imgmaxlimit")},modalCoins:"timesmax"})}function showRemoveWatermarkM(){return new Promise((function(e,t){multicreditSystem.showCreditPopup({title:getfsCreditsText("Model_Remove_Watermark_title"),content:getfsCreditsText("Model_Remove_Watermark_span"),btn:getfsCreditsText("Model_Remove_Watermark_btn"),btnWater:getfsCreditsText("Model_Remove_Watermark_btn1"),btnWaterFn:function(){gtag("event","click_faceswap_stock_m"),e(!0)},closeClick:function(){e(!0)},btnFn:function(){setCookie("st","removewatermark_m"),gtag("event","click_faceswap_no_m"),e(!1)},modalCoins:"watermarker"})}))}function showRemoveWatemark_btn(e){e?($("#multiple_Face_swapper_container #multiple_Face_swapper_container .removeWatemark_btn").show(),$("#large_multi_face_modal .removeWatemark_btn").show(),$("#multiple_Face_swapper_container .removeWatemark_btn").parent().addClass("img_btns_group2"),$("#large_multi_face_modal .multi_img_btns").addClass("img_btns2_r")):($("#multiple_Face_swapper_container #multiple_Face_swapper_container .removeWatemark_btn").hide(),$("#large_multi_face_modal .removeWatemark_btn").hide(),$("#multiple_Face_swapper_container .removeWatemark_btn").parent().removeClass("img_btns_group2"),$("#large_multi_face_modal .multi_img_btns").removeClass("img_btns2_r"))}function tabbarItemClick(){$(".tab__bar_item").each((function(){var e=$(this).index();$(this).on("click",(function(t){$(".tab__bar_item").removeClass("active"),$(this).addClass("active"),$("#multiple_face_swapper_try").removeClass("photo video"),1===e&&(gtag("event","click_mulfaceswap_videotab"),$("#multiple_Face_swapper_container_v").show(),$("#multiple_Face_swapper_container").hide(),$("#multiple_face_swapper_try").addClass("video"),setNewTag()),0===e&&(gtag("event","click_mulfaceswap_phototab"),$("#multiple_Face_swapper_container_v").hide(),$("#multiple_Face_swapper_container").show(),$("#multiple_face_swapper_try").addClass("photo"))}))}))}var checkImg=new Image;function checkFileExpired(e){return new Promise((function(t,n){checkImg.src=e,checkImg.onload=function(){t(!0)},checkImg.onerror=function(){t(!1)}}))}function showBtnCreditsMultiImage(e){var t;if(200!==multiAiFace.canMultiFaceData.code||0!==(null===(t=multiAiFace.canMultiFaceData)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.credit)){var n=multiAiFace.formdata.avatar_main_key.filter((function(e){return e.main_part_key})).length;multiAiFace.uploadFacesNumber=n,multicreditSystem.showBtnCredits({bool:e,credits:getCreditsFromVideoOrPic(multiAiFace,"image"),appendDom:$("#multiple_Face_swapper_container .change_multi_face_btn"),type:"image"})}}function getCountryConfig(){return new Promise((function(e,t){fetchPost("ai/tool/videoface-user",{},TOOL_API).then((function(n){200===n.code?(window.userRuleConfig=n.data,initCreditsComponents(),changeHeaderCredit(n.data.credit),e()):(console.error("Error getCountryConfig",n),ToolTip({type:"error",title:textContentObj.Failed,content:textContentObj.processImage,btn:textContentObj.ok}),t())})).catch((function(e){console.error(e),ToolTip({type:"error",title:textContentObj.errorNetworkTitle,content:textContentObj.errorNetwork,btn:textContentObj.ok}),t()}))}))}var btnLoading1=!1,multimodel=new MutiModel,multiAiFace=new MultiAiFace({multimodel:multimodel});muticreditsPhotoModel=new MutiCreditPhotoModel($("#multiple_Face_swapper_container .multi_credits_messageModel"),multiAiFace),window.multiphotoAiFaceChanging=multiAiFace,$(document).ready((function(){gtag("event","open_mulfaceswap_page"),multiAiFace.eventLoginsuccess(),multiAiFace.getImgList(),multiAiFace.getCanSwapFaceData(),setFsNewTag(),setNewTag(!0),tabbarItemClick(),getCountryConfig();var e=$(".appsigninbtn"),t=($(".signupfootbtn"),$(".signupnavbtn")),n=$(".appsignupbtn");function a(e){e?($("#multiple_Face_swapper_container .multi_Input").addClass("draggable"),$("#multiple_Face_swapper_container .multi_Input").find("svg").hide(),$("#multiple_Face_swapper_container .multi_Input").find(".change_image_text").text(getMultiText("drag_btn"))):($("#multiple_Face_swapper_container .multi_Input").removeClass("draggable"),$("#multiple_Face_swapper_container .multi_Input").find("svg").show(),$("#multiple_Face_swapper_container .multi_Input").find(".change_image_text").text(getMultiText("change_btn")))}e.attr("product-position","isTool-no-reloading"),t.attr("product-position","isTool-no-reloading"),n.attr("product-position","isTool-no-reloading"),$("#multiple_Face_swapper_container .multi_uploader_btn").on("click",(function(e){e.stopPropagation(),$("#multiple_Face_swapper_container .multi_uploader_multi").click()})),$("#multiple_Face_swapper_container .upload_step").on("dragover",(function(e){e.preventDefault()})),$("#multiple_Face_swapper_container .multi_upload .can_drag_box").on("dragenter",(function(e){e.preventDefault(),multiAiFace.form.firstPicLoading||(multiAiFace.setDragLoading("multi_upload",!0),multiAiFace.setDragLoading("change_upload",!1))})),$("#multiple_Face_swapper_container .multi_upload .uploader_loading_mask").on("dragleave",(function(e){multiAiFace.setDragLoading("multi_upload",!1)})),$("#multiple_Face_swapper_container .multi_upload .uploader_loading_mask").on("dragenter",(function(e){e.preventDefault(),multiAiFace.form.firstPicLoading||multiAiFace.setDragLoading("multi_upload",!0)})),$("#multiple_Face_swapper_container .multi_upload .uploader_loading_mask").on("dragover",(function(e){e.preventDefault(),multiAiFace.form.firstPicLoading||multiAiFace.setDragLoading("multi_upload",!0)})),$("#large_multi_face_modal").on("wheel",(function(e){e.preventDefault()})),$("#multiple_Face_swapper_container .multi_uploader_multi").on("change",(function(e){if(gtag("event","up_mulfaceswap_img"),e.target.files&&e.target.files[0]){if(1!==e.target.files.length)return multiAiFace.multimodel.errorMessage({conText:"<h1>".concat(textContentObj.processImageTitle,"</h1>\n          <p>").concat(multitextContentObj.faceSwapPop01.onlyone,"</p>"),btnText:multitextContentObj.OK}),void(multiAiFace.multimodel.options.visible=!0);var t=e.target.files[0],n=$(this)[0];multiAiFace.addMultiImage({file:t,callback:function(e,t,a){n.value="";var i="width"===t?"height":"width";$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key","multi_img"),$("#multiple_Face_swapper_container .multi_img").find("img").attr("src",e.showUrl).removeClass(i).addClass("".concat(t)),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",e.showUrl),multiAiFace.form.originImage=e,multiAiFace.addFindFacesTask((function(){multiAiFace.showToolBtn(!1),a||$("#multiple_Face_swapper_container #multi_img").attr("data-index",null)}))}})}})),$("#multiple_Face_swapper_container .multi_upload .uploader_loading_mask, .multi_uploader_btn_con_mask").on("drop",(function(e){if(e.preventDefault(),a(!1),multiAiFace.setDragLoading("multi_upload",!1),!multiAiFace.form.firstPicLoading){if(1!==e.originalEvent.dataTransfer.files.length)return multiAiFace.multimodel.errorMessage({conText:"<h1>".concat(textContentObj.processImageTitle,"</h1>\n            <p>").concat(multitextContentObj.faceSwapPop01.onlyone,"</p>"),btnText:multitextContentObj.OK}),void(multiAiFace.multimodel.options.visible=!0);gtag("event","up_mulfaceswap_img");var t=e.originalEvent.dataTransfer.files[0];$("#multiple_Face_swapper_container .multi_upload").addClass("loading_mask"),multiAiFace.addMultiImage({file:t,callback:function(e,t,n){var a="width"===t?"height":"width";$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key","multi_img"),$("#multiple_Face_swapper_container .multi_img").find("img").attr("src",e.showUrl).removeClass(a).addClass("".concat(t)),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",e.showUrl),multiAiFace.form.originImage=e,multiAiFace.addFindFacesTask((function(){n||$("#multiple_Face_swapper_container #multi_img").attr("data-index",null)}))}})}})),$("#multiple_Face_swapper_container .multi_Input").on("click",(function(e){e.stopPropagation(),btnLoading1||(btnLoading1=!0,setTimeout((function(){btnLoading1=!1}),2e3),$("#multiple_Face_swapper_container .multi_uploader_multi").click())})),$("#multiple_Face_swapper_container .multi_Input .multi_uploader_btn_con_mask").on("dragover",(function(e){e.preventDefault(),a(!0)})).on("dragenter",(function(e){e.preventDefault(),a(!0)})).on("dragleave",(function(e){e.preventDefault(),a(!1)})),$("#multiple_Face_swapper_container .multi_Input").on("dragover",(function(e){e.preventDefault(),a(!0)})).on("dragenter",(function(e){e.preventDefault(),a(!0)})),$("#large_multi_face_modal .removeWatemark_btn").on("click",(function(e){})),$("#large_multi_face_modal .removeWatemark_btn").on("click",(function(e){})),$("#large_multi_face_modal .compare_multi_btn, #multiple_Face_swapper_container .compare_multi_btn").on("pointerdown",(function(e){var t;if(e.preventDefault(),gtag("event","compare_mulfaceswap_imgres"),!multimodel.options.downloading&&!multiAiFace.changeFaceLoading&&2!==e.button){var n,a;if(null!==(t=multiAiFace.form)&&void 0!==t&&null!==(t=t.originImage)&&void 0!==t&&t.showUrl)$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",null===(n=multiAiFace.form)||void 0===n?void 0:n.originImage.showUrl),$("#large_multi_face_modal .large_multi_img").attr("src",null===(a=multiAiFace.form)||void 0===a?void 0:a.originImage.showUrl);document.addEventListener("pointerup",(function(e){$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key")||i(e)}))}})),$("#multiple_Face_swapper_container .share_multi_btn, #large_multi_face_modal .share_multi_btn").on("click",(function(e){gtag("event","share_mulfaceswap_imgres");var t=document.querySelector("#shareDialogEl");t.changeTips({title:multitextContentObj.faceSwapPop01.share__Tile,content:getMultiText("share__box__text")}),t.showShare({url:multiAiFace.mergeImgUrl,action:"multiplefaceswapmioshare",imageKey:multiAiFace.mergeKey,text:getMultiText("share__text"),title:multitextContentObj.faceSwapPop01.share__Tile,id:multiAiFace.lastSuccessTaskid,task_id:multiAiFace.lastSuccessTaskid,btoaUrl:btoa(multiAiFace.mergeKey+","+multiAiFace.lastSuccessTaskid),backParams:function(e){return{id:multiAiFace.lastSuccessTaskid,key:null==e?void 0:e.merge_key}}})})),$("#large_multi_face_modal .compare_multi_btn, #multiple_Face_swapper_container .compare_multi_btn").on("pointerleave",(function(e){i(e)}));var i=function(e){e.preventDefault(),multimodel.options.downloading||multiAiFace.changeFaceLoading||2!==e.button&&($("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",multiAiFace.mergeImgUrl),$("#large_multi_face_modal .large_multi_img").attr("src",multiAiFace.mergeImgUrl),document.removeEventListener("pointerup",(function(e){i(e)})))};$("#multiple_Face_swapper_container #mult_main_face_change_img").on("contextmenu",(function(e){e.originalEvent.preventDefault()})),$("#large_multi_face_modal .large_multi_img width").on("contextmenu",(function(e){e.originalEvent.preventDefault()})),$("#multiple_Face_swapper_container .large_multi_image").on("click",(function(e){e.preventDefault(),gtag("event","zoomin_mulfaceswap_imgres"),multimodel.options.downloading||multiAiFace.changeFaceLoading||2!==e.button&&createMultiDialog(multiAiFace.mergeImgUrl,multiAiFace)})),$(".download_multi_btn_p").on("click",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),gtag("event","download_mulfaceswap_imgres"),!multimodel.options.downloading&&!multiAiFace.changeFaceLoading){e.next=4;break}return e.abrupt("return");case 4:if(2!==t.button){e.next=6;break}return e.abrupt("return");case 6:if(getCookie("access_token")){e.next=9;break}return showLoginWindow({isReloading:!1}),e.abrupt("return");case 9:multimodel.options.downloading=!0,multimodel.downloadMessage(),multimodel.options.visible=!0,fetchPost("ai/source/get-access-url",{key:multiAiFace.mergeKey,action:"download",file_name:"Vidqu_faceswap.png"},TOOL_API).then(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.code){e.next=6;break}return multimodel.errorMessage({conText:multitextContentObj.loginFirst,btnText:multitextContentObj.OK}),multimodel.options.visible=!0,multimodel.options.downloadType=2,multimodel.options.downloading=!1,e.abrupt("return");case 6:return e.next=8,checkFileExpired(t.data.url);case 8:if(e.sent){e.next=19;break}return $("#multiple_Face_swapper_container #multi_change_face_modal").attr("style",""),$("#multiple_Face_swapper_container .change_face_modal_btns").show(),multimodel.errorMessage({conText:"\n                <h1>".concat(multitextContentObj.faceSwapPop01.processImageTitle,"</h1>\n                <p>").concat(multitextContentObj.expired_file,"</p>\n              "),btnText:multitextContentObj.OK}),multimodel.options.downloadType=0,multimodel.options.downloading=!1,multimodel.options.visible=!0,e.abrupt("return");case 19:multimodel.options.downloadType=1,multimodel.options.downloading=!1,n=document.createElement("a"),multimodel.options.downloadUrl=t.data.url,n.href=t.data.url,n.download="Vidqu_faceswap.png",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(n.href),gtag("event","dwsucc_miofs_res_m");case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){multimodel.options.downloadType=2,multimodel.options.downloading=!1,console.error("fail",e)}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$("#multiple_Face_swapper_container #change_face_login").on("click",(function(){window.location.href=thGotoApplibraryUrl+"signup?page_name=face-swap&name=ai"})),$("#multiple_Face_swapper_container .modal__main_close").on("click",(function(){$("#multiple_Face_swapper_container .vocalRemover__modal").hide()})),$("#multiple_Face_swapper_container .close_btn").on("click",(function(){multimodel.options.visible=!1,$("#multiple_Face_swapper_container #multi_change_face_modal").hide(),$("#multiple_Face_swapper_container #multi_change_face_modal").hide()})),$("#large_multi_face_modal .multi_close_btn").on("click",(function(){$("#large_multi_face_modal").hide()})),$("#multiple_Face_swapper_container .change_multi_face_btn").on("click",(function(e){gtag("event","click_mulfaceswap_imgswapbtn"),getNumberNow()>6?gtag("event","succ_mulfaceswap_img10"):gtag("event","succ_mulfaceswap_img6"),multiAiFace.changeMultiFace($(this))})),$("#multiple_Face_swapper_container .face_swap_now").on("click",(function(){scrollToPositions(".ai-change-face")})),$("#multiple_Face_swapper_container .see_more_multi").on("click",(function(){$("#multiple_Face_swapper_container .multi_pics").removeClass("hide_other_pics"),$("#multiple_Face_swapper_container .see_more_multi").hide(),$("#multiple_Face_swapper_container .fold_multi").show()})),$("#multiple_Face_swapper_container .fold_multi").on("click",(function(){$("#multiple_Face_swapper_container .multi_pics").addClass("hide_other_pics"),$("#multiple_Face_swapper_container .see_more_multi").show(),$("#multiple_Face_swapper_container .fold_multi").hide()})),$("#multiple_Face_swapper_container #multi_uploader").on("change",function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.files&&t.target.files[0]){e.next=2;break}return e.abrupt("return");case 2:multiAiFace.itemUploading(t.target.files[0]);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$("#multiple_Face_swapper_container .face_random_multi").on("click",(function(){var e;gtag("event","img_miofs_quickbtn_m");var t=randomchoice(multiAiFace.imgList);if(0!==(null===(e=multiAiFace.imgList)||void 0===e?void 0:e.length)&&!multiAiFace.form.firstPicLoading&&!multiAiFace.changeFaceLoading){var n=t();multiAiFace.showToolBtn(!1),multiAiFace.addMultiImage({addData:{demoKey:n.pic_key,demoSrc:n.pic_url},file:n.pic_url,callback:function(e,t,n){var a="width"===t?"height":"width";$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("data-key","multi_img"),$("#multiple_Face_swapper_container .multi_img").find("img").attr("src",e.showUrl).removeClass(a).addClass("".concat(t)),$("#multiple_Face_swapper_container #mult_main_face_change_img").attr("src",e.showUrl),multiAiFace.form.originImage=e,multiAiFace.addFindFacesTask((function(){n||$("#multiple_Face_swapper_container #multi_img").attr("data-index",null),n&&$("#multiple_Face_swapper_container #multi_img").attr("data-index",n)}))},ourPicsIndex:$(this).index()+1})}})),$("#header_user").on("mouseenter",(function(){gtag("event","show_mulfaceswap_profilepopover")})),$("#header_user #go_credits").click((function(){gtag("event","click_mulfaceswap_profileaccount")})),$("#header_user .signout").click((function(){gtag("event","click_mulfaceswap_profilesignout")}))}));var initScrollBarPos=function(){document.querySelector(".recommende__article_swiper .swiper-wrapper").scrollTo(300,0)};function setGtag(e){e.className.includes("_compare")?gtag("event","upclick_miomfs_compare"):e.className.includes("_one")?gtag("event","upclick_miomfs_one"):e.className.includes("_two")?gtag("event","upclick_miomfs_two"):e.className.includes("_three")||(e.className.includes("_four")?gtag("event","upclick_miomfs_four"):e.className.includes("_step")?gtag("event","upclick_miomfs_step"):e.className.includes("_scroll")&&gtag("event","upclick_miomfs_scroll"))}function photo_isSameDay(){var e=Date.now(),t=getCookie("faceSwapTime_swap");if(!t)return!1;var n=new Date(e),a=new Date(Number(t)),i=n.getFullYear(),o=n.getMonth(),r=n.getDate(),l=a.getFullYear(),c=a.getMonth(),s=a.getDate();return i===l&&o===c&&r===s}$((function(){$("#multiple_Face_swapper_container .head-portrait .appsigninbtn").click((function(e){e.stopPropagation(),e.preventDefault()})),$("#multiple_Face_swapper_container .swap_credit_btn_multiphoto").on("click",(function(){getCookie("access_token")?(setSessionCookie("st","mulloggedcreditbanner"),gtag("event","logged_credit_mulbannerbtn")):(setSessionCookie("st","mulnotcreditbanner"),gtag("event","notlogged_credit_mulbannerbtn"))})),new Swiper(".seo_section1_swiper_continer",{initialSlide:0,spaceBetween:20,allowTouchMove:!1,autoplay:"pc"!=judgeClient()&&{delay:6e3,disableOnInteraction:!1},speed:800,slidesPerView:1,navigation:{nextEl:".swiper-button-next1",prevEl:".swiper-button-prev1",disabledClass:"disabled"},pagination:{el:".swiper-pagination",clickable:!0}});var e=document.querySelectorAll(".right_line_button");document.querySelectorAll(".right_line_button_big").forEach((function(t,n){t.onmousedown=function(a){var i=t.parentNode.querySelector(".right_line"),o=t.parentNode.querySelector(".right_imgB"),r=a.clientX-e[n].getBoundingClientRect().left;document.onmousemove=function(a){var l=a.clientX-r-t.parentNode.getBoundingClientRect().left,c=e[n].offsetWidth/2,s=t.parentNode.offsetWidth-c;l<c&&(l=c),l>s&&(l=s),e[n].style.left=l+"px",t.style.left=l+"px",i.style.left=l+"px",o.style.width=l+"px"},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}},t.ondragstart=function(){return!1},t.addEventListener("touchstart",(function(a){var i=a.touches[0],o=t.parentNode.querySelector(".right_line"),r=t.parentNode.querySelector(".right_imgB"),l=i.clientX-e[n].getBoundingClientRect().left;function c(a){!function(a){var i=a.clientX-l-t.parentNode.getBoundingClientRect().left,c=e[n].offsetWidth/2,s=t.parentNode.offsetWidth-c;i<c&&(i=c),i>s&&(i=s),e[n].style.left=i+"px",t.style.left=i+"px",o.style.left=i+"px",r.style.width=i+"px"}(a.touches[0])}function s(){document.removeEventListener("touchmove",c)}document.addEventListener("touchmove",c),t.addEventListener("touchend",(function(){document.removeEventListener("touchmove",c),t.removeEventListener("touchend",s)})),t.addEventListener("touchend",s)})),t.ondragstart=function(){return!1}})),"pc"==judgeClient()&&new Swiper(".recommende__article_swiper",{width:1088,slidesPerView:4,spaceBetween:16,speed:800,navigation:{nextEl:".recommende__article .swiper-button-next",prevEl:".recommende__article .swiper-button-prev",disabledClass:"disabled"}});var t=document.querySelectorAll(".faqs__translator_item");function n(){for(var e=function(){var e=t[n],a=e.querySelector(".faqs__translator_item-header"),i=e.querySelector(".faqs__translator_item-body");a.onclick=function(){var e="0px"===i.style.maxHeight||""===i.style.maxHeight;i.style.maxHeight=e?i.scrollHeight+"px":"0",e?a.classList.add("show"):a.classList.remove("show")}},n=0;n<t.length;n++)e()}n();var a=document.querySelectorAll(".seo_section4_item"),i=document.querySelectorAll(".seo_section4_item_body"),o=document.querySelectorAll(".seo_section4_item h3"),r=document.querySelectorAll(".imgBox img"),l=document.querySelectorAll(".seo_section4_itemBox_mob .section4_img");n(),function(){for(var e=function(e){var t=a[e],n=t.querySelector("h3"),c=t.querySelector(".seo_section4_item_body");n.onclick=function(){var t="0px"===c.style.maxHeight||""===c.style.maxHeight;i.forEach((function(e,t){e.style.maxHeight="0",o[t].classList.remove("show"),"pc"==judgeClient()&&t<r.length?r[t].style.zIndex="0":l[t]&&(l[t].style.maxHeight="0")})),c.style.maxHeight=t?c.scrollHeight+"px":"0",t?n.classList.add("show"):n.classList.remove("show"),"pc"==judgeClient()?r[e].style.zIndex="1":(l[e-4].style.maxHeight=t?"calc(641 / 750 * 100vw)":"0",l[e-4].style.marginTop=t?"calc(38.5 / 750 * 100vw)":"0")}},t=0;t<a.length;t++)e(t)}(),_toConsumableArray(document.querySelectorAll(".seo_button")).forEach((function(e){e.onclick=function(){window.scrollTo({top:0,left:0,behavior:"smooth"}),setGtag(e)}}))}));