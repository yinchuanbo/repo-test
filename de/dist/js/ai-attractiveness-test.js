var TOOL_API=location.host.includes("vidqu.ai")&&!location.host.includes("test")?"https://tool-api.vidqu.ai/":"https://tool-api-test.vidqu.ai/";let attractivenessObj;const textContentObj=jsonData.aiAttractivenessTest.javascript;function getMultiText(t,e={},a=!1){let i=textContentObj[t];for(let t in e){const a=new RegExp(`{{${t}}}`,"g");i=i.replace(a,e[t])}return i}function isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function setTextContentObj(t,e={}){let a=textContentObj[t];for(let t in e){const i=new RegExp(`{{${t}}}`,"g");a=a.replace(i,e[t])}return a}var fetchPut=function(t,e,a={}){return new Promise(((i,n)=>{fetch(t,{method:"PUT",headers:a,body:e}).then((t=>{200===t.status?i(t.status):n("image upload failed in put!")})).catch((t=>n(t)))}))},fetchPost=(t,e,a={})=>new Promise(((i,n)=>{fetch(TOOL_API+t,{method:"POST",headers:{"Content-Type":"application/json","Request-Origin":"vidqu","Request-language":"de",Authorization:"Bearer "+getCookie("access_token")||"",...a},body:JSON.stringify(e)}).then((t=>i(t.json()))).catch((t=>n(t)))}));function parseStr(t=""){try{return JSON.parse(t)}catch(e){return t}}var fetchGet=function(t,e={}){return new Promise(((a,i)=>{fetch(TOOL_API+t,{method:"GET",headers:{"Content-Type":"application/json","Request-Origin":"vidqu","Request-language":"de",Authorization:"Bearer "+getCookie("access_token")||"",...e}}).then((t=>a(t.json()))).catch((t=>i(t)))}))},photo_task_id=null,canMultiFaceData={},userRuleConfig={};class Attractiveness{constructor(t){Object.setPrototypeOf(Attractiveness.prototype,this.data());const e=this.data().proxyData;Object.setPrototypeOf(Attractiveness.prototype.form,this.form(e))}data(){return{mergeImg:{width:0,height:0},proxyData:{originImage:null,firstPicLoading:!1,formdata:{is_fun:1,is_smartness:2,is_confidence:1,is_attractiveness:1,is_trustworthiness:2,is_approachability:2}},isInitFace:!1,imgSize:0,imgWidth:0,imgHeight:0,tryCount:0,multipleIndex:null,multicountryConfig:{},finalImage:{finalImageUrl:null,finalImageKey:null},isDemo:null,attractiveList:[],delay:2e3,lastCall:0,taskid:null,imgList:[],showurl:null,mergeImgUrl:null,mergeKey:null,changeFaceLoading:!1,canMultiFaceData:{},showCreditBannerBool:!0,itemLoading:[],result6list:[],showObject:["Fun","Smartness","Confidence","Trustworthiness","Attractiveness","Approachability"],resultData:{}}}form(t){const e=this;return new Proxy(t,{set(t,a,i){if(t[a]=i,t.originImage?e.handleOriginImageExist():($(".multi_upload_before").show(),$(".multi_upload_after").hide(),$(".change_multi_face_btn").addClass("disabled")),t.firstPicLoading?$(".multi_Input").addClass("disabled"):$(".multi_Input").removeClass("disabled"),t.formdata)for(const[t,e]of Object.entries(i))1==e?$(`#${t}`).addClass("active"):$(`#${t}`).removeClass("active");return!0},get:(t,e)=>t[e]})}resizeImageByFile(t){var e=this;return new Promise(((a,i)=>{var n=new FileReader;n.onloadend=()=>{let t=new Image;t.onload=()=>{let i=document.createElement("canvas"),n=i.getContext("2d"),o=Math.max(t.width,t.height);if(o>1080){let e=1080/o;i.width=t.width*e,i.height=t.height*e}else i.width=t.width,i.height=t.height;n.drawImage(t,0,0,i.width,i.height);var s=i.toDataURL(),r=e.transtoBlob({b64data:s,contentType:"image/png"});let l="width";i.width<i.height&&(l="height"),a({blog:r,imgType:l})},t.onerror=()=>{i(new Error("Image load failed"))},t.src=n.result},n.onerror=i,n.readAsDataURL(t)}))}initFace=async()=>{var t="/dist/js/weights";await faceapi.loadTinyFaceDetectorModel(t);await faceapi.loadSsdMobilenetv1Model(t),this.isInitFace=!0};getUploadFileUrl=(t,e="temp")=>{let a=t;try{a=t.split("/")[1]||"png"}catch(t){a="png"}return fetchPost(`ai/source/${e}-upload-url`,{file_name:"Vidnoz_AI_Attractiveness_Test."+a})};uploadFile=({url:t,file:e})=>new Promise((async(a,i)=>{try{a(await fetchPut(t,e))}catch(t){console.error(t.message),i(t)}}));handleOriginImageExist(){$(".multi_upload_before").hide(),$(".multi_upload_after").show(),$(".people_recognized_box").show(),$(".change_multi_face_btn").removeClass("disabled")}async addImage({addData:t={},file:e,callback:a,ourPicsIndex:i=null}){const n=t?.demoKey||void 0;if($(".change_multi_face_btn").addClass("disabled"),this.setFirstStart(!0),"string"==typeof e||this.checkFileType(e)){if(e.size>104857600&&isMobileDevice())return ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.toolarge,btn:textContentObj.ok}),this.setFirstStart(!1),void($(".multi_uploader_multi")[0].value="");try{if(this.setLiLoading(!0),"string"!=typeof e){var o=await this.checkFacePicMulti(e);if(1!==o)return $(".multi_uploader_multi")[0].value="",this.setFirstStart(!1),this.setLiLoading(!1),void this.showModalAboutFaceNumber(o)}this.showToolBtn(!1),$(".change_multi_face_btn").addClass("disabled"),$(".img_url").show(),$("#final_img_url").hide();let c,d,g,m=e.type;if(n)c=t.demoSrc,d=t.demoSrc,this.showurl=d,this.isDemo={url:d,key:n};else{gtag("event","upload_attracttest_img");var{blog:s,imgType:r}=await this.resizeImageByFile(e);c=s,g=r,d=URL.createObjectURL(c),this.showurl=c,this.isDemo=null}var l={file:c,showUrl:d,suffix:m,demoKey:n};this.setLiLoading(!1),$("#main_final_img").attr("src",d),$(".change_multi_face_btn").removeClass("disabled"),a&&a(l,g,i)}catch(t){console.error(t),ToolTip({type:"error",title:textContentObj.errorUploadTitle,content:textContentObj.errorUpload,btn:textContentObj.ok}),$(".multi_uploader_multi")[0].value="",this.setFirstStart(!1),this.setLiLoading(!1)}}}setLoadingStart(t){t?(this.setFirstStart(!0),$("#final_img_url").hide(),$(".img_url").show(),$(".change_multi_face_btn ._multi_step3_btn").text(textContentObj.swapping),$(".multi-generating-animate").show(),this.changeFaceLoading=!0,$("#main_face_change_img").attr("style","filter: blur(5px)"),$(".change_multi_face_btn").addClass("disabled"),this.setLiLoading(!0),$(".loading_multi_box p").text(getMultiText("Loading2")),$(".loading_multi_box").show(),$(".loading_multi_box").find(".imgloading").hide(),$(".loading_multi_box").find(".submitLoadingbox").show(),$(".people_recognized_list").addClass("inter_loading"),$(".step2").addClass("loading"),$(".multi_upload").addClass("loading_mask")):(this.setFirstStart(!1),$(".change_multi_face_btn ._multi_step3_btn").text(textContentObj.step3_btn),$(".multi-generating-animate").hide(),$(".change_multi_face_btn").removeClass("disabled"),this.changeFaceLoading=!1,this.setLiLoading(!1),$("#main_face_change_img").attr("style",""),$(".loading_multi_box").hide(),$(".people_recognized_list").removeClass("inter_loading"),$(".step2").removeClass("loading"),$(".multi_upload").removeClass("loading_mask"))}setLiLoading=t=>{t?$(".multi_pics li").attr("style","filter: blur(3px);pointer-events: none;"):$(".multi_pics li").attr("style","")};setBigImageStart=t=>{t?($("#main_face_change_img").attr("style","filter: blur(5px)"),$(".loading_multi_box p").text(textContentObj.multiLoading),$(".loading_multi_box").show(),$(".loading_multi_box").find(".imgloading").show(),$(".loading_multi_box").find(".submitLoadingbox").hide()):($("#main_face_change_img").attr("style",""),$(".loading_multi_box").hide())};transtoBlob=({b64data:t,contentType:e="image/png"})=>{e=e||"";let a=1024,i=atob(t.split(",")[1]),n=i.length,o=Math.ceil(n/a),s=new Array(o);for(let t=0;t<o;++t){let e=t*a,o=Math.min(e+a,n),r=new Array(o-e);for(let t=e,a=0;t<o;++a,++t)r[a]=i[t].charCodeAt(0);s[t]=new Uint8Array(r)}return new Blob(s,{type:e})};setFirstStart=t=>{t?($(".multi_upload_before .multi_uploader_btn").attr("style","background-color: #281FAE !important;"),$(".multi_upload_before").addClass("loading"),$(".multi_upload_after").addClass("loading"),$(".multi_Input").addClass("disabled"),$(".multi_Input .multi_uploader_btn_con").hide(),$(".multi_Input .multi_uploader_btn_loading").show(),$(".multi_uploader_btn .multi_uploader_btn_con").hide(),$(".multi_uploader_btn .multi_uploader_btn_loading").show(),$(".people_recognized_list").addClass("inter_loading"),$(".multi_upload_before").find(".divImgback").hide(),this.form.firstPicLoading=!0,this.setBigImageStart(!0)):($(".multi_upload_before").removeClass("loading"),$(".multi_upload_after").removeClass("loading"),$(".multi_Input").removeClass("disabled"),$(".multi_Input .multi_uploader_btn_con").show(),$(".multi_Input .multi_uploader_btn_loading").hide(),$(".multi_uploader_btn .multi_uploader_btn_loading").hide(),$(".multi_uploader_btn .multi_uploader_btn_con").show(),$(".people_recognized_list").removeClass("inter_loading"),$(".multi_upload_before").find(".divImgback").show(),this.form.firstPicLoading=!1,this.setBigImageStart(!1))};setFinalresult=function(t){const e=this;$(".img_url").hide();const a=t||{key:"demo/user_id/20230629/649d5d969d11f.png",url:"",face_score:60,age:18,Fun:70,Smartness:70,Confidence:60,Attractiveness:50,Trustworthiness:50,Approachability:90};a?.url&&$("#main_final_img").attr("src",a.url),isMobileDevice()?($("#score_prograss").hide(),$("#score_prograss_m").show()):($("#score_prograss_m").hide(),$("#score_prograss").show()),this.setScoreList(a),this.setEvaluates(),this.playAnime(a),$(".final_img_url").css("display","flex"),$(".change_multi_face_btn").addClass("disabled"),getCookie("user_info")&&"vip"===parseStr(getCookie("user_info"))?.usertype&&$("#water_marker").hide(),setTimeout((async()=>{try{await e.loadImage(a.url);const t=document.getElementById("final_img_url");$("#final_img_url_large").html(t.cloneNode(!0)),html2canvas(t,{useCORS:!0,scale:2,backgroundColor:"Transparent"}).then((async function(t){const a=t.toDataURL(),i=await e.transtoBlob({b64data:a,contentType:"image/png"}),{data:n}=await e.uploadImagePromise(i,"get");e.finalImage={finalImageKey:n.key,finalImageUrl:n.access_url};const o=await computedParams(e.finalImage.finalImageUrl);e.imgSize=o.imgSize,e.imgWidth=o.imgWidth,e.imgHeight=o.imgHeight,e.showToolBtn(!0),e.setLoadingStart(!1)})).catch((t=>{console.error(t);let a=textContentObj.processImage;ToolTip({type:"error",title:textContentObj.processImageTitle,content:a,btn:textContentObj.ok}),$(".change_multi_face_btn").removeClass("disabled"),e.setFirstStart(!1),e.setLoadingStart(!1)}))}catch(t){console.error(t.message);let a=textContentObj.processImage;ToolTip({type:"error",title:textContentObj.processImageTitle,content:a,btn:textContentObj.ok}),$(".change_multi_face_btn").removeClass("disabled"),e.setFirstStart(!1),e.setLoadingStart(!1)}}),2e3)};loadImage=t=>new Promise(((e,a)=>{const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{e(i)},i.onerror=function(){a(new Error("Image load error: "+t))},i.src=t}));svgToPng=async t=>{const e=await this.loadImage(t);return this.imageToPng(e)};imageToPng=t=>{const e=document.createElement("canvas"),a=e.getContext("2d");return e.width=2*t.width,e.height=2*t.height,a.drawImage(t,0,0,2*t.width,2*t.height),e.toDataURL("image/png",1)};startTest=async()=>{const t=this;if(this.changeFaceLoading)return;this.setLoadingStart(!0),this.showToolBtn(!1);let e={};try{if("string"==typeof t.showurl&&t.isDemo)e=t.isDemo;else{e=(await this.uploadImagePromise(t.showurl)).data}}catch(t){ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.failed_des11,btn:textContentObj.ok}),this.setLoadingStart(!1)}fetchPost("ai/ai-tool/add-task",{param:{...t.form.formdata,key:e.key},action:"ai_attractiveness_test"},{"X-TASK-VERSION":"2.0.0"}).then((async e=>{if(200===e.code)this.getFinalImg(e.data.task_id);else if(401===e.code)ToolTip({type:"error",content:textContentObj.loginFirst,btn:textContentObj.ok}),this.setLoadingStart(!1);else if(3002===e.code){t.showMaximum(),this.setLoadingStart(!1),this.setLiLoading(!1);let e=$("#multi_img").attr("src");$(".main_face_change_img").attr("src",e)}else ToolTip({type:"error",title:textContentObj.errorUploadTitle,content:textContentObj.errorUpload,btn:textContentObj.ok}),this.setLoadingStart(!1)})).catch((t=>{console.error(t),ToolTip({type:"error",title:textContentObj.errorUploadTitle,content:textContentObj.errorUpload,btn:textContentObj.ok}),this.setLoadingStart(!1)}))};checkFileType=t=>{if("string"==typeof t)return!0;var e=t.type;return!!["image/jpeg","image/png","image/webp","application/octet-stream"].includes(e)||(ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.limit,btn:textContentObj.ok}),this.setBigImageStart(!1),this.setFirstStart(!1),!1)};showToolBtn(t){if(t){var e=window.getComputedStyle(document.querySelector("#main_face_change_img"));this.mergeImg={width:e.getPropertyValue("width").split("px")[0],height:e.getPropertyValue("height").split("px")[0]},$(".multi_img_btns").attr("style",`width: ${this.mergeImg.width>600?600:this.mergeImg.width}px; display: flex;`)}else $(".multi_img_btns").hide()}getFinalImg=t=>{this.showToolBtn(!1),this.setLoadingStart(!0),this.taskid=t,fetchPost("ai/tool/get-task",{id:t}).then((e=>{if(e.message.includes("face=0"))return ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.NoFaceMulti,btn:textContentObj.ok}),void this.setLoadingStart(!1);if(e.message.includes("face>1"))return ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.manyFace,btn:textContentObj.ok}),void this.setLoadingStart(!1);if(200!==e.code){let t=textContentObj.processImage;ToolTip({type:"error",title:textContentObj.processImageTitle,content:t,btn:textContentObj.ok}),this.setLoadingStart(!1)}else this.tryCount=0,0===e.data.status?(this.setFinalresult(e.data.additional_data),gtag("event","succ_attracttest_btn")):setTimeout((()=>{this.getFinalImg(t)}),3e3)})).catch((e=>{console.error(e),this.tryCount>=3?(ToolTip({type:"error",title:textContentObj.errorUploadTitle,content:textContentObj.errorUpload,btn:textContentObj.ok}),this.setLoadingStart(!1)):(console.log("retrying"),setTimeout((()=>{this.getFinalImg(t),this.tryCount++}),5e3))}))};faceCheck=async({blobUrl:t=""})=>new Promise(((e,a)=>{var i=new Image;i.src=t,i.onload=async()=>{try{const t=await faceapi.detectAllFaces(i,new faceapi.SsdMobilenetv1Options);if(t.length)e(t.length);else{const t=await faceapi.detectAllFaces(i,new faceapi.TinyFaceDetectorOptions({inputSize:416}));e(t.length)}}catch(t){console.log(t),a(t)}},i.onerror=async t=>{console.log(t),a(t)}}));checkFacePicMulti=t=>new Promise((async(e,a)=>{try{let a=t;"string"!=typeof t&&(a=URL.createObjectURL(t)),e(await this.faceCheck({blobUrl:a}))}catch(t){a(t)}}));showModalAboutFaceNumber=t=>{$(".multi_uploader_multi")[0].value="";let e=textContentObj.NoFaceMulti;t&&t>1&&(e=textContentObj.manyFace),ToolTip({type:"error",title:textContentObj.processImageTitle,content:e,btn:textContentObj.ok})};uploadImagePromise(t,e){return new Promise((async(a,i)=>{try{var n=await this.getUploadFileUrl(t.type,e);this.uploadFile({url:n.data.upload_url,file:t}).then((t=>{a({data:n.data})})).catch((t=>i(t)))}catch(t){console.log(t),i(t)}}))}getSourceUrl(t){return jqAjaxPromise("ai/source/get-access-url",{key:t,file_name:"Vidnoz_AI_Attractiveness_Test.png"})}setDragLoading(t,e){e?($(`.${t} .other_box`).addClass("blur"),$(`.${t} .drag_loadbox`).show()):($(`.${t} .other_box`).removeClass("blur"),$(`.${t} .drag_loadbox`).hide())}setAttractiveList(){let t="";this.attractiveList.forEach((e=>{t+=`\n        <div class="test_item ${1===e.is_default?"active":""}" id="${e.key}" key="${e.key}">\n          <block class="choose_checkbox"><i class="go_right"></i></block>\n          ${e.name}\n        </div>\n      `})),$(".test_box").html(t),$(".step").removeClass("loading"),this.bindAttractiveCheckbox()}setScoreList(t){let e="";this.result6list=[];for(const e of this.showObject)t[e]>0&&this.result6list.push({name:e,value:t[e]});this.result6list.forEach((t=>{e+=`\n        <li>\n          <p>${getMultiText(t.name)}</p>\n          <div class="score_li_prograss">\n            <div class="score_li_prograss_con" id="${t.name}">\n              <span>${t.value}%</span>\n            </div>\n          </div>\n        </li>\n      `})),$("#score_ul").html(e)}bindAttractiveCheckbox(){const t=this;$(".test_item").each((function(){$(this).on("click",(function(){const e=$(this).attr("id"),a=$(this).attr("key"),i=e.toLowerCase().split("is_")?.[1];gtag("event",`${i}_attracttest_test`);const n=t.form.formdata,o=Object.values(n).filter((t=>1==t)).length;if(1==n[a]){if(o<=1)return;n[a]=2,t.form.formdata=n}else n[a]=1,t.form.formdata=n}))}))}playAnime(t){const e=t.face_score,a=t.age,i=$(".circle_prograss"),n=$(".test_score span"),o=$(".age_prediction span");let s=e/100*190;i.attr("stroke-dasharray",`${s} 190`),n.text(e),o.text(a),this.result6list.forEach((t=>{$(`#${t.name}`).css("width",`${t.value}%`)}))}setEvaluates(){const t=getMultiText("evaluates"),e=[...this.result6list];e.sort((function(t,e){return e.value-t.value}));const a=e[0],i=e.filter((t=>t.value===a)),n=this.getRandomNum(1,29);let o=this.getRandomNum(1,10),s=e.find((t=>t.name===a.name));i>1&&(o=this.getRandomNum(1,50)),$(".face_score_text").html(`\n      ${t[`${s.name}${o}`]}\n      <img src="/dist/img/ai-attractiveness-test/icon/icon${n}.svg" />\n    `)}getRandomNum=(t,e)=>{const a=e-t+1,i=Math.random();return t+Math.floor(i*a)};getPublicOptions(){const t=this;fetchGet("ai/public/options?type=ai-attractiveness-test&country=de").then((e=>{t.attractiveList=e.data.test_type,t.imgList=e.data.demos_vidqu,$(".multi_pics").html(""),$(".multi_pics").addClass("img9_show"),$(".see_more_multi").hide(),$(".fold_multi").hide(),e.data.demos_vidqu.forEach(((t,e)=>{$(".multi_pics").append(`\n          <li>\n            <img src="${t.image_url}" data-key="${t.key}" data-index="${e+1}" />\n          </li>\n        `)})),$(".multi_pics li").each((function(){$(this).on("click",(e=>{gtag("event","select_attracttest_photo");var a=$(this).find("img").attr("src"),i=$(this).find("img").attr("data-key");a&&!t.changeFaceLoading&&(t.showToolBtn(!1),t.addImage({addData:{demoKey:i,demoSrc:a},file:a,callback:(e,a,i)=>{t.setFirstStart(!1);var n="width"===a?"height":"width";$("#main_face_change_img").attr("data-key","multi_img"),$(".multi_img").find("img").attr("src",e.showUrl).removeClass(n).addClass(`${a}`),t.form.originImage=e,$("#main_face_change_img").attr("src",e.showUrl),i||$("#multi_img").attr("data-index",null),i&&$("#multi_img").attr("data-index",i)},ourPicsIndex:$(this).index()+1}))}))})),t.setAttractiveList()}))}showMaximum(){let t=getMultiText("Model_Maximum_title");gtag("event","alert_attracttest_maxlimit");let e=getMultiText("exceed",{val:"T1"===userRuleConfig?.countrycode||"T2"===userRuleConfig?.countrycode?5:3},!0);ToolTip({type:"error",title:t,content:e,btn:textContentObj.ok})}}function getCountryConfig(t){return new Promise(((t,e)=>{fetchPost("ai/tool/videoface-user",{}).then((a=>{200===a.code?t(a.data):e(a)}))}))}var createMultiDialog=(t,e)=>{$("#large_multi_face_modal .large_multi_img").attr("src",t),e.mergeImg.width>e.mergeImg.height?$("#large_multi_face_modal .large_multi_img").removeClass("height").addClass("width"):$("#large_multi_face_modal .large_multi_img").removeClass("width").addClass("height"),$("#large_multi_face_modal .multi_img_btns").attr("style","width: 800px; display: flex;justify-content: flex-end;"),$("#large_multi_face_modal").attr("style","display: flex")};const checkImg=new Image;function checkFileExpired(t){return new Promise(((e,a)=>{checkImg.src=t,checkImg.onload=()=>{e(!0)},checkImg.onerror=()=>{e(!1)}}))}function computedParams(t){return new Promise((async(e,a)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onload=function(){if(200===i.status){const n=i.response,o=new FileReader;o.onload=function(){let a=new Image;a.crossOrigin="Anonymous",a.src=t,a.onload=function(){const t=a.width,i=a.height,n=o.result.byteLength;a=null,e({imgSize:n,imgWidth:t,imgHeight:i})}},o.onerror=function(){a(new Error("Failed to read image data"))},o.readAsArrayBuffer(n)}else a(new Error("Failed to load image"))},i.onerror=function(){a(new Error("Failed to load image"))},i.send()}))}!function(){let t=!1;window.attractiveness=new Attractiveness,attractivenessObj=attractiveness,$(document).ready((function(){gtag("event","open_attracttest_page"),attractiveness.getPublicOptions(),getCountryConfig().then((t=>{userRuleConfig=t})),attractiveness.initFace();const e=$(".appsigninbtn"),a=$(".signupfootbtn"),i=$(".signupnavbtn"),n=$(".appsignupbtn");function o(t){t?($(".multi_Input").addClass("draggable"),$(".multi_Input").find("svg").hide(),$(".multi_Input").find(".change_image_text").text(getMultiText("drag_btn"))):($(".multi_Input").removeClass("draggable"),$(".multi_Input").find("svg").show(),$(".multi_Input").find(".change_image_text").text(getMultiText("change_btn")))}e.attr("product-position","isTool-no-reloading"),i.attr("product-position","isTool-no-reloading"),n.attr("product-position","isTool-no-reloading"),e.on("click",(function(){gtag("event","login_attracttest_header")})),i.on("click",(function(){gtag("event","signup_attracttest_header")})),a.attr("onclick","gtag('event', 'signup_attracttest_footer');"),$(".multi_uploader_btn").on("click",(function(t){t.stopPropagation(),$(".multi_uploader_multi").click()})),$(".upload_step").on("dragover",(function(t){t.preventDefault()})),$(".multi_upload").on("dragenter",(function(t){t.preventDefault(),attractiveness.proxyData.originImage||(attractiveness.setDragLoading("multi_upload",!0),attractiveness.setDragLoading("change_upload",!1))})),$(".multi_upload .drag_loadbox").on("dragleave",(function(t){attractiveness.setDragLoading("multi_upload",!1)})),$(".change_upload").on("dragenter",(function(t){t.preventDefault(),attractiveness.proxyData.originImage||(attractiveness.setDragLoading("change_upload",!0),attractiveness.setDragLoading("multi_upload",!1))})),$(".change_upload .drag_loadbox").on("dragleave",(function(t){attractiveness.setDragLoading("change_upload",!1)})),$("#large_multi_face_modal").on("wheel",(function(t){t.preventDefault()})),$(".multi_uploader_multi").on("change",(async function(t){if(t.target.files&&t.target.files[0]){$(".multi_uploader_btn").css("background","#281FAE !important"),attractiveness.isInitFace||await attractiveness.initFace();var e=t.target.files[0],a=$(this)[0];attractiveness.addImage({file:e,callback:(t,e,i)=>{a.value="",attractiveness.setFirstStart(!1),attractiveness.showToolBtn(!1);let n="width"===e?"height":"width";$("#main_face_change_img").attr("data-key","multi_img"),$(".multi_img").find("img").attr("src",t.showUrl).removeClass(n).addClass(`${e}`),attractiveness.form.originImage=t,$("#main_face_change_img").attr("src",t.showUrl),i||$("#multi_img").attr("data-index",null)}})}})),$(".multi_upload .uploader_loading_mask, .multi_Input").on("drop",(function(t){if(t.preventDefault(),o(!1),attractiveness.setDragLoading("multi_upload",!1),!attractiveness.form.firstPicLoading){var e=t.originalEvent.dataTransfer.files[0];attractiveness.addImage({file:e,callback:(t,e,a)=>{attractiveness.setFirstStart(!1),attractiveness.showToolBtn(!1);let i="width"===e?"height":"width";$("#main_face_change_img").attr("data-key","multi_img"),$(".multi_img").find("img").attr("src",t.showUrl).removeClass(i).addClass(`${e}`),attractiveness.form.originImage=t,$("#main_face_change_img").attr("src",t.showUrl),a||$("#multi_img").attr("data-index",null)}})}})),$(".multi_Input").on("click",(function(e){e.stopPropagation(),t||(t=!0,setTimeout((()=>{t=!1}),2e3),$(".multi_uploader_multi").click())})),$(".multi_Input").on("dragover",(function(t){t.preventDefault(),o(!0)})).on("dragenter",(function(t){t.preventDefault(),o(!0)})).on("dragleave",(function(t){t.preventDefault(),o(!1)})),$(".compare_multi_btn").on("pointerdown",(function(t){t.preventDefault(),attractiveness.changeFaceLoading||2!==t.button&&(attractiveness.form?.originImage?.showUrl&&($("#main_face_change_img").attr("src",attractiveness.form?.originImage.showUrl),$("#large_multi_face_modal .large_multi_img").attr("src",attractiveness.form?.originImage.showUrl)),document.addEventListener("pointerup",(function(t){$("#main_face_change_img").attr("data-key")||s(t)})))})),$(".share_multi_btn").on("click",(t=>{gtag("event","share_attracttest_res");let e=document.querySelector("#shareDialogEl");e.changeTips({title:textContentObj.share__Tile,content:getMultiText("share__box__text")}),e.showShare({url:attractiveness.finalImage.finalImageUrl,action:"aiattractivenesstestshare",imageKey:attractiveness.finalImage.finalImageKey,text:getMultiText("share__text"),title:textContentObj.share__Tile,id:attractiveness.taskid,task_id:attractiveness.taskid,btoaUrl:btoa(attractiveness.finalImage.finalImageKey+","+getPreferredLanguage()),backParams:function(){return{id:attractiveness.taskid,key:attractiveness.finalImage.finalImageKey}}})})),$(".compare_multi_btn").on("pointerleave",(t=>{s(t)}));const s=function(t){t.preventDefault(),attractiveness.changeFaceLoading||2!==t.button&&($("#main_face_change_img").attr("src",attractiveness.mergeImgUrl),$("#large_multi_face_modal .large_multi_img").attr("src",attractiveness.mergeImgUrl),document.removeEventListener("pointerup",(function(t){s(t)})))};function r(t){ToolTip({type:"success",title:textContentObj.downloadH1,content:textContentObj.downloadTips_multi,btn:textContentObj.continue,clickHereFn:e=>{e.setAttribute("href",t),e.click(),setTimeout((()=>r(t)),300)}})}$("#main_face_change_img").on("contextmenu",(t=>{t.originalEvent.preventDefault()})),$("#large_multi_face_modal .large_multi_img width").on("contextmenu",(t=>{t.originalEvent.preventDefault()})),$(".large_multi_image").on("click",(function(t){t.preventDefault(),attractiveness.changeFaceLoading||2!==t.button&&createMultiDialog(attractiveness.mergeImgUrl,attractiveness)}));new Image;async function l(){$(".download_multi_btn").addClass("downDisabled"),ToolTip({type:"progress",content:textContentObj.downloading,contentClass:"downloading"});try{fetchPost("ai/source/get-access-url",{key:attractiveness.finalImage.finalImageKey,action:"download",file_name:"Vidqu_attractivenesstest.png"}).then((async t=>{if(200===t.code){if(!await checkFileExpired(t.data.url))return void ToolTip({type:"error",title:textContentObj.processImageTitle,content:textContentObj.expired_file,btn:textContentObj.ok});let e=document.createElement("a");e.href=t.data.url,e.download="Vidqu_attractivenesstest.png",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(e.href),r(t.data.url)}else ToolTip({type:"error",title:textContentObj.downloadError,content:textContentObj.failed_des10,btn:textContentObj.ok})})).catch((t=>{console.error(t),ToolTip({type:"error",title:textContentObj.downloadError,content:textContentObj.failed_des10,btn:textContentObj.ok})}))}catch(t){console.error(t),ToolTip({type:"error",title:textContentObj.downloadError,content:textContentObj.failed_des10,btn:textContentObj.ok})}}$(".download_multi_btn").on("click",(async t=>{t.preventDefault(),gtag("event","download_attracttest_res"),attractiveness.changeFaceLoading||2!==t.button&&l()})),$(".click_attractive_me").on("click",(function(){ToolTip({type:"success",title:textContentObj.downloadH1,content:textContentObj.downloadTips_multi,btn:textContentObj.continue})})),$("#change_face_login").on("click",(function(){window.location.href=thGotoApplibraryUrl+"signup?page_name=face-swap&name=ai"})),$(".modal__main_close").on("click",(function(){$(".vocalRemover__modal").hide()})),$(".close_btn").on("click",(function(){$("#large_multi_face_modal").hide(),$("#large_multi_face_modal").find(".removeWatemark_btn").show()})),$(".multi_close_btn").on("click",(function(){$("#large_multi_face_modal").hide()})),$(".change_multi_face_btn").on("click",(function(t){gtag("event","click_attracttest_btn"),attractiveness.startTest($(this))})),$(".face_swap_now").on("click",(function(){scrollToPositions(".ai-change-face")})),$("#multi_uploader").on("change",(async function(t){t.target.files&&t.target.files[0]&&attractiveness.itemUploading(t.target.files[0])}))}))}(),$(".line-wrapper-left-box-item").hover((function(t){$(".line-wrapper-left-box-item").removeClass("active");const e=$(this).attr("data-alt"),a=$(this).attr("data-url");$(this).addClass("active"),$(".line-wrapper-right").find("img").attr("src",a).attr("alt",e)})),$(".wrapper-faq-mob-item-main").click((function(){faqHover(this,!1)})),$(".title-p").click((function(){faqHover(this,!0)}));const faqHover=(t,e)=>{let a,i,n,o;a=e?".hover-p":".wrapper-faq-mob-item",i=e?".hover-desc":".wrapper-faq-mob-item-desc",n=e?".arrow-img":".wrapper-faq-mob-item-icon",o=e?".title-p":".wrapper-faq-mob-item-main";var s=$(t).parent(a),r=$(t).parent(a).children(o).children("img");s.hasClass("active")?(s.removeClass("active").find(i).slideUp(300),r.removeClass("transfor-180")):($(`${a}.active`).removeClass("active").find(i).slideUp(300),$(`${n}.transfor-180`).removeClass("transfor-180"),s.addClass("active").find(i).slideDown(300),r.addClass("transfor-180"))};$(".to-top").click((async function(){$("html,body").animate({scrollTop:"0px"},100)})),$(".test-btn").click((async function(){$("html,body").animate({scrollTop:"0px"},100),await new Promise((t=>setTimeout(t,500))),fetch($(this).prev().attr("src")).then((t=>t.blob())).then((t=>{const e=new File([t],"image.jpg",{type:"image/jpeg"});attractivenessObj.setFirstStart(!0),attractivenessObj.addImage({file:e,callback:async(t,e,a)=>{let i="width"===e?"height":"width";$("#main_face_change_img").attr("data-key","multi_img"),$(".multi_img").find("img").attr("src",t.showUrl).removeClass(i).addClass(`${e}`),attractivenessObj.form.originImage=t,$("#main_face_change_img").attr("src",t.showUrl),await new Promise((t=>setTimeout(t,3e3))),attractivenessObj.setFirstStart(!1),a||$("#multi_img").attr("data-index",null)}})}))})),$(document).ready((function(){}));