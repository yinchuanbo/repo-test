"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw n}}}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function d(e,t,r,a){var n=t&&t.prototype instanceof m?t:m,s=Object.create(n.prototype),o=new j(a||[]);return i(s,"_invoke",{value:G(e,r,o)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",g="suspendedYield",_="executing",v="completed",p={};function m(){}function f(){}function y(){}var b={};l(b,s,(function(){return this}));var C=Object.getPrototypeOf,k=C&&C(C(F([])));k&&k!==r&&a.call(k,s)&&(b=k);var $=y.prototype=m.prototype=Object.create(b);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(i,n,s,o){var c=u(e[i],e,n);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==_typeof(d)&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,o)}))}o(c.arg)}var n;i(this,"_invoke",{value:function(e,a){function i(){return new t((function(t,i){r(e,a,t,i)}))}return n=n?n.then(i,i):i()}})}function G(t,r,a){var i=h;return function(n,s){if(i===_)throw Error("Generator is already running");if(i===v){if("throw"===n)throw s;return{value:e,done:!0}}for(a.method=n,a.arg=s;;){var o=a.delegate;if(o){var c=T(o,a);if(c){if(c===p)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(i===h)throw i=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);i=_;var l=u(t,r,a);if("normal"===l.type){if(i=a.done?v:g,l.arg===p)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(i=v,a.method="throw",a.arg=l.arg)}}}function T(t,r){var a=r.method,i=t.iterator[a];if(i===e)return r.delegate=null,"throw"===a&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),p;var n=u(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,p;var s=n.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,p):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function r(){for(;++i<t.length;)if(a.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return n.next=n}}throw new TypeError(_typeof(t)+" is not iterable")}return f.prototype=y,i($,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create($),e},t.awrap=function(e){return{__await:e}},x(w.prototype),l(w.prototype,o,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,a,i,n){void 0===n&&(n=Promise);var s=new w(d(e,r,a,i),n);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x($),l($,c,"Generator"),l($,s,(function(){return this})),l($,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=F,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(a,i){return o.type="throw",o.arg=t,r.next=a,i&&(r.method="next",r.arg=e),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),l=a.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=e,s.arg=t,n?(this.method="next",this.next=n.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var i=a.arg;M(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,a){return this.delegate={iterator:F(t),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=e),p}},t}function asyncGeneratorStep(e,t,r,a,i,n,s){try{var o=e[n](s),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(a,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var n=e.apply(t,r);function s(e){asyncGeneratorStep(n,a,i,s,o,"next",e)}function o(e){asyncGeneratorStep(n,a,i,s,o,"throw",e)}s(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var winRef=null,tryTimes=0,evt=document.createEvent("HTMLEvents");evt.initEvent("input",!0,!0);var informTimer=null,AiGirlFriend=function(){return _createClass((function e(){_classCallCheck(this,e);var t=this;if(this.proxy=new Proxy(this.data(),{set:function(e,r,a){return setTimeout(_asyncToGenerator(_regeneratorRuntime().mark((function i(){var n,s,o,c,l,d;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:"mc_Avatar"===r?e.mc_Avatar?($(".createMc_container .avatar").addClass("has"),$(".createMc_container .avatar .addImage span").text(jsonAiGirlFriend.createMc.avatar_btnAdd)):($(".createMc_container .avatar").removeClass("has"),$(".createMc_container .avatar .addImage span").text(jsonAiGirlFriend.createMc.avatar_btnSet)):"mc_Background"===r?e.mc_Background?($(".createMc_container .background").addClass("has"),$(".background .addImage span").text(jsonAiGirlFriend.createMc.background_btnAdd)):($(".createMc_container .background").removeClass("has"),$(".background .addImage span").text(jsonAiGirlFriend.createMc.background_btnSet)):"mc_Desc"===r?$(".whiteMeOut").val(a):"mc_Name"===r?$(".createMC_name").val(a):"mc_Gender"===r?$(".createMC_gender").val(a):"mc_Persona"===r?$(".createMC_persona").val(a):"mc_Greeting"===r?$(".createMC_Greeting").val(a):"mc_Scenario"===r?$(".createMC_Scenario").val(a):"mc_Dialogue"===r?$(".createMC_Dialogue").val(a):"mc_visibility"===r?($(".createMc_select .select_content").text(a),$(".createMc_select .select_list_item").removeClass("active"),$(".createMc_select .select_list_item[data-type='".concat(a,"']")).addClass("active")):"mc_Categories"===r?("",s=a.length>1?jsonAiGirlFriend.createMc.Categories_tips:jsonAiGirlFriend.createMc.Categories_tip,n=s.replace("%ss",a.length),$(".checkNum").text(n),$(".createMc_radio").prop("checked",!1),$(".createMc_radio").each((function(){var e=this,t=$(this).attr("value");a.forEach((function(r){r==t&&$(e).prop("checked",!0)}))}))):"editMcType"===r?a?($("#myCharacters").click(),$(".myCharacters_Box,.noFoundMc,.Mycharacters_loading").hide(),$(".createMyCharacter_Box").show(),$(".createBtn").addClass("active"),$(".myCharactersBox .classify").hide(),"create"===a?(gtag("event","show_aigirlfriend_create"),$(".createMc_container").removeClass("editStart")):(gtag("event","show_aigirlfriend_edit"),$(".createMc_container").addClass("editStart"))):($(".createMyCharacter_Box").hide(),$(".classify").show(),t.isMyLoading?$(".Mycharacters_loading").show():0==t.mycharactersList.length?$(".noFoundMc").show():$(".myCharacters_Box").show()):"homeTag"===r?t.initCharacters():"mcTag"===r||"primary"===r?t.GetMyCharacters():"voice_json"===r?(o=$("#voice_type")[0],c=t.voiceArr.findIndex((function(e){return e.name==a.name})),l=$(".voice_box .voice_item[data-name='".concat(a.name,"']")),d=t.voiceArr[c].url,$(".voice_box .voice_item").removeClass("active"),$(".voice_item .icon").removeClass("active"),l.addClass("active"),o.pause(),o.setAttribute("src",d),o.currentTime=0):"editUser_Avatar"===r?e.editUser_Avatar?($(".editUser .avatar").addClass("has"),$(".editUser .avatar .addImage span").text(jsonAiGirlFriend.createMc.avatar_btnAdd)):($(".editUser .avatar").removeClass("has"),$(".editUser .avatar .addImage span").text(jsonAiGirlFriend.createMc.avatar_btnSet)):"editUserAge"===r?0!=Number(a)?$(".editUserAge .select_content").text(a).attr("data-age",a):$(".editUserAge .select_content").text(jsonAiGirlFriend.editUser.age_tip).attr("data-age",0):"isLoadingInform"===r&&(a?($(".inform_notMore").hide(),$(".inform_loading").show()):($(".inform_notMore").show(),$(".inform_loading").hide())),"tab"!=r&&"CharactersCount"!=r&&"MyCharactersCount"!=r||t.pageProcess();case 2:case"end":return i.stop()}}),i)}))),10),e[r]=a,!0},get:function(e,t){return e[t]}}),Object.setPrototypeOf(e.prototype,this.proxy),this.access_token=getCookie("access_token")?getCookie("access_token"):"",getCookie("aiGirlSort")&&this.access_token){var r=getCookie("aiGirlSort");this.sort=r;var a=$(".character_select .select_list_item[data-sort='".concat(r,"']"));$(".character_select .select_list_item[data-sort]").removeClass("active"),a.addClass("active"),a.parents(".select_list").siblings(".select_content").text(a.text()),"top"==this.sort&&$(".select_time").css("display","flex")}$(window).bind("beforeunload",(function(){this.access_token=getCookie("access_token")?getCookie("access_token"):"",this.access_token||setCookie("aiGirlSort","")}))}),[{key:"data",value:function(){return{access_token:"",charactersList:[],mycharactersList:[],recentCharacters:[],sort:"",sort_time:"",tab:"all",isLoading:!1,isLoadingTimer:null,isMyLoading:!1,isMyLoadingTimer:null,isLike:!1,num:0,numMy:0,CharactersPage:0,MyCharactersPage:0,CharactersCount:0,MyCharactersCount:0,editMcType:"",classifys:[],homeTag:[],mcTag:[],primary:"",mc_Avatar:"",mc_Name:"",mc_Desc:"",mc_Gender:"",mc_Background:"",mc_Persona:"",mc_visibility:jsonAiGirlFriend.classifySelect.Public,mc_Categories:[],mc_Greeting:"",mc_Scenario:"",mc_Dialogue:"",my_characters_id:0,head_portrait:[],head_portrait_background:[],mc_roleId:"",is_draft:!1,oldRoleInfo:{},isUploadAvatar:!1,isUploadBackground:!1,voiceArr:[],voice_json:{},isUploadUserAvatar:!1,editUser_Avatar:"",editUserAge:0,editUser_firstName:"",editUser_lastName:"",informaPage:0,isLoadingInform:!1,unlook:!1,resetMy:!0,resetAll:!0,voiceOpen:"pool_voice",voicePool_json:{},lastTab:"all"}}},{key:"init",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.reSetAllCharacters=refreshData(6e5),e.next=3,this.initCharacters();case 3:this.reSetMyCharacters=refreshData(6e5),this.GetMyCharacters(),this.pageProcess(),this.GetRecentChatting(),this.GetSetting(),this.GetIfications(),this.clickFn(),this.eventLoginsuccess(),this.composeBrief(),this.isShowNewTag();case 13:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"initCharacters",value:(p=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n,s,o,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(c.length>0&&void 0!==c[0])||c[0],this.reSetAllCharacters(this.resetAll)){e.next=4;break}return this.resetAll=!0,e.abrupt("return");case 4:return this.resetAll=!0,this.num++,e.next=8,this.isShowCharacterLoading(!0,!t);case 8:if(r=e.sent,console.log(r,"isRun"),r){e.next=12;break}return e.abrupt("return");case 12:return a=this.sort?this.sort:"hot",t?this.CharactersPage=0:this.CharactersPage++,e.prev=15,e.next=18,fetchGet("chat/user/get-role-list?sort=".concat(a,"&sort_time=").concat(this.sort_time,"&is_like=").concat(this.isLike?1:2,"&page=").concat(this.CharactersPage,"&tag=").concat(this.homeTag.join(",")));case 18:200===(i=e.sent).code&&(n=i.data.list,this.CharactersCount=i.data.page_count,s="",o=0,n.forEach((function(e,t){var r,a,i;o>=6?o=1:o++;var n=null===(r=e.json)||void 0===r?void 0:r.tag.split(","),c=e.json.Character_author?jsonAiGirlFriend.by+" "+e.json.Character_author:"";s+='<div class="characters_item" data-indexId="'.concat(e.id,'" data-id="').concat(e.role_id,'">\n          <div class="headPortrait">\n            <img src="').concat(null===(a=e.head_portrait[0])||void 0===a?void 0:a.url,'" alt="" class="avatar">\n            <div class="share_icon">\n              <img src="/dist/img/aiFriend/btn_more_normal.svg" />\n            </div>\n            <div class="head_shareBox">\n            ').concat(1==e.is_self?'<div class="editInbox" >\n                <div class="icon"></div>'.concat(jsonAiGirlFriend.edit,"\n              </div>"):"",'\n              <div class="shareInbox">\n                <div class="icon"></div>').concat(jsonAiGirlFriend.Share,'\n              </div>\n            </div>\n            <div class="chat_info">\n              <img src="/dist/img/aiFriend/icon_chat.svg" alt="">\n              <span>').concat(formatNumber(e.msg_num),'</span>\n            </div>\n          </div>\n          <div class="character_info">\n            <div class="character_name">\n              <div class="name">').concat(e.name,"</div>\n              ").concat(c?'<div class="author">'.concat(c,"</div>"):"",'\n            </div>\n            <div class="infoBox">\n              <div class="info_l">\n                <div class="like_icon ').concat(1===e.is_like?"active":"",'" data-likes="').concat(e.like_num,'"></div>\n                <span class="num">').concat(formatNumber(e.like_num),'</span>\n                <div class="like_num">').concat(e.like_num>1?jsonAiGirlFriend.likes:jsonAiGirlFriend.like,'</div>\n               </div>\n              <div class="info_r">\n                <button class="chatNow">').concat(jsonAiGirlFriend.chatNow,'</button>\n              </div>\n            </div>\n          </div>\n          <div class="brief_hover"></div>\n          <div class="brief">\n            <div class="brief_top">\n              <img class="brief_avatar" src="').concat(null===(i=e.head_portrait[0])||void 0===i?void 0:i.url,'"/>\n              <div class="tagBox">\n                <div class="brief_tag" style="display:').concat(n.length>1&&n[n.length-2]?"block":"none",'">').concat(jsonAiGirlFriend.setting_tag[n[n.length-2]]||n[n.length-2],'</div>\n                <div class="brief_tag" style="display:').concat(n.length>0&&n[n.length-1]?"block":"none",'">').concat(jsonAiGirlFriend.setting_tag[n[n.length-1]]||n[n.length-1],'</div>\n              </div>\n            </div>\n            <div class="brief_name">').concat(e.json.Character_name,"</div>\n            ").concat(c?'<div class="brief_author">'.concat(c,"</div>"):"",'\n            <div class="brief_created">').concat(e.json.Created,'</div>\n            <div class="brief_des">').concat(e.json.Character_des,"</div>\n          </div>\n        </div>")})),t?(this.charactersList=n,$(".characters").html(s)):(this.charactersList=[].concat(_toConsumableArray(this.charactersList),_toConsumableArray(n)),$(".characters").append(s))),this.num--,this.isShowCharacterLoading(!1),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(15),this.num--,this.isShowCharacterLoading(!1),console.log(e.t0,"error Failed to initialize all characters");case 29:case"end":return e.stop()}}),e,this,[[15,24]])}))),function(){return p.apply(this,arguments)})},{key:"GetMyCharacters",value:(v=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n,s,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(o.length>0&&void 0!==o[0])||o[0],this.reSetMyCharacters(this.resetMy)){e.next=4;break}return this.resetMy=!0,e.abrupt("return");case 4:return e.prev=4,this.numMy++,e.next=8,this.isShowMyCharacterLoading(!0,!t);case 8:if(e.sent){e.next=11;break}return e.abrupt("return");case 11:return t?this.MyCharactersPage=0:this.MyCharactersPage++,e.next=14,fetchGet("chat/user/get-role-list?type=my_characters&page=".concat(this.MyCharactersPage,"&tag=").concat(this.mcTag.join(","),"&role_type=").concat(this.primary.toLowerCase()));case 14:200===(r=e.sent).code&&(a=r.data.list,this.MyCharactersCount=r.data.page_count,i="",n=0,s=$(".edit:not(.recent)").hasClass("active"),a.forEach((function(e,t){var r,a,o;n>=6?n=1:n++;var c=null===(r=e.json)||void 0===r?void 0:r.tag.split(","),l=e.json.Character_author?jsonAiGirlFriend.by+" "+e.json.Character_author:"";i+='<div class="myCharacters_item" data-indexId="'.concat(e.id,'" data-id="').concat(e.role_id,'" data-status="').concat(e.status,'">\n                        <div class="headPortrait">\n                          <img src="').concat(null===(a=e.head_portrait[0])||void 0===a?void 0:a.url,'" alt="" class="avatar" />\n                          <div class="share_icon" style="display: ').concat(s?"none":"flex",';">\n                            <img src="/dist/img/aiFriend/btn_more_normal.svg" />\n                          </div> \n                          <div class="lock_icon" style="display:').concat(2==e.type?"block":"none",'"></div>\n                          <div class="head_shareBox">\n                            <div class="editInbox">\n                              <div class="icon"></div>').concat(jsonAiGirlFriend.edit,"\n                            </div>\n                            ").concat(1==e.status&&2!=e.type?'<div class="shareInbox" style="display:">\n                              <div class="icon"></div>'.concat(jsonAiGirlFriend.Share,"\n                            </div>"):"",'\n                          </div>\n                          <div class="deleteChat ').concat(s?"active":"",'">\n                            <img src="/dist/img/aiFriend/btn_close_big_normal.svg" alt="" class="" />\n                          </div>\n                        </div>\n                        \n                        <div class="character_info">\n                          <div class="character_name">\n                            <div class="name">').concat(e.name,"</div>\n                            ").concat(l?'<div class="author">'.concat(l,"</div>"):"",'\n                          </div>\n                          <div class="infoBox">\n                            <div class="info_l">\n                              <div class="like_icon ').concat(1===e.is_like?"active":"",'"" data-likes="').concat(e.like_num,'" style="display:').concat(4!=e.status?"block":"none",'"></div>\n                                    </div>\n                            <div class="info_r">\n                            ').concat(4!=e.status?'<button class="chatNow">'.concat(jsonAiGirlFriend.chatNow,"</button>"):'<button class="editDraft"><div class="icon"></div>'.concat(jsonAiGirlFriend.edit,"</button>"),'\n                            </div>\n                          </div>\n                        </div>\n                        <div class="brief_hover"></div>\n                        <div class="brief">\n                          <div class="brief_top">\n                            <img class="brief_avatar" src="').concat(null===(o=e.head_portrait[0])||void 0===o?void 0:o.url,'"/>\n                            <div class="tagBox">\n                              <div class="brief_tag" style="display:').concat(c.length>1&&c[c.length-2]?"block":"none",'">').concat(jsonAiGirlFriend.setting_tag[c[c.length-2]]||c[c.length-2],'</div>\n                                    <div class="brief_tag" style="display:').concat(c.length>0&&c[c.length-1]?"block":"none",'">').concat(jsonAiGirlFriend.setting_tag[c[c.length-1]]||c[c.length-1],'</div>\n                          </div>\n                        </div>\n                        <div class="brief_name">').concat(e.json.Character_name,"</div>\n                        ").concat(l?'<div class="brief_author">'.concat(l,"</div>"):"",'\n                        <div class="brief_created">').concat(e.json.Created,'</div>\n                        <div class="brief_des">').concat(e.json.Character_des,"</div>\n                      </div>\n                      </div>")})),t?(this.mycharactersList=a,$(".myCharacters").html(i)):(this.mycharactersList=[].concat(_toConsumableArray(this.mycharactersList),_toConsumableArray(a)),$(".myCharacters").append(i)),this.numMy--,this.isShowMyCharacterLoading(!1)),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(4),this.numMy--,this.isShowMyCharacterLoading(!1),console.log(e.t0,"error Failed to initialize my chat partner");case 23:case"end":return e.stop()}}),e,this,[[4,18]])}))),function(){return v.apply(this,arguments)})},{key:"GetRecentChatting",value:(_=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetchGet("chat/user/get-role-list?type=recent_chatting");case 3:200===(t=e.sent).code&&((r=t.data.list).length>0?(a=$(".edit.recent").hasClass("active"),$(".Recent_hr").css("display","flex"),$(".RecentChatting").css("display","flex"),this.recentCharacters=r,i="",r.forEach((function(e,t){var r;i+='<div class="Recent_item" data-index="'.concat(t,'" data-id="').concat(e.chat_id,'">\n                          <img src="').concat(null===(r=e.head_portrait[0])||void 0===r?void 0:r.url,'" alt="" class="recent_head_port"/>\n                          <div class="name">').concat(e.name,'</div>\n                          <div class="deleteChat recent ').concat(a?"active":"",'" style="display: ').concat(a?"flex":"none",';">\n                            <img src="/dist/img/aiFriend/btn_close_normal.svg" alt="" class="" />\n                          </div>\n                        </div>')})),$(".RecentChattingBox").html(i),setTimeout((function(){n.composeRecent()}),200)):($(".Recent_hr").hide(),$(".RecentChatting").hide(),$(".RecentChattingBox").html(""),$(".edit.recent").removeClass("active").text(jsonAiGirlFriend.edit))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0,"error Failed to initialize recentCharacters");case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return _.apply(this,arguments)})},{key:"GetClassify",value:(g=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,a,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.length>0&&(this.classifys=t,r="<div class=\"classify_item active\" data-tag=''>".concat(jsonAiGirlFriend.AllCharacters,"</div>"),a="",t.forEach((function(e){var t=jsonAiGirlFriend.setting_tag[e]||e;r+='<div class="classify_item" data-tag=\''.concat(e,"'>").concat(t,"</div>"),a+='<div class="check_item">\n                                <input type="checkbox" value="'.concat(e,'" class="createMc_radio" />\n                                <label for="').concat(e,'">').concat(t,"</label>\n                              </div>")})),$(".classify_box_container").append(r),$(".createMc_checkbox").html(a),setTimeout((function(){i.composeClassify($(".SegmentBox")),i.composeClassify($(".myCharactersBox"))}),200));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"GetSetting",value:(h=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(".voicePoolBox_loading").show(),e.prev=1,e.next=4,fetchGet("chat/user/get-setting");case 4:200===(t=e.sent).code&&(r=t.data.voice,this.GetClassify(t.data.tag),r.length>0&&(this.voiceArr=r,this.voice_json=r[0],this.voicePool_json=r[0],$("#voicePool_type").attr("src",r[0].ai_url_2),a="",i="",r.forEach((function(e,t){var r=jsonAiGirlFriend.setting_voice[e.name]||e;a+='<div class="voice_item" data-name=\''.concat(e.name,'\'>\n                          <div class="icon"></div>').concat(r.name,"\n                        </div>"),i+='<div class="voicePool_item '.concat(0==t?"active":"",'">\n                                <div class="pool_avatar">\n                                  <img src="').concat(e.image_url,'" alt="">\n                                </div>\n                                <div class="pool_des">\n                                  <div>').concat(r.name_desc,'</div>\n                               </div>\n                                <div class="pool_voice" data-name=\'').concat(e.name,'\'>\n                                  <div class="icon"></div>').concat(r.name,"\n                                </div>\n                              </div>")})),$(".voice_box").html(a),$(".voicePool_box").html(i),$(".voiceBtnCreate").show(),$(".voicePoolBox_loading").hide())),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0,"error Failed to initialize voice");case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return h.apply(this,arguments)})},{key:"GetIfications",value:(u=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n,s=this,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=!(o.length>0&&void 0!==o[0])||o[0])&&(this.informaPage=0,$(".inform_list").html("")),!this.isLoadingInform&&""!==this.informaPage&&getCookie("access_token")){e.next=4;break}return e.abrupt("return");case 4:return this.isLoadingInform=!0,r=!1,e.prev=6,e.next=9,fetchGet("chat/notifications/list?page=".concat(this.informaPage));case 9:200===(a=e.sent).code&&((i=a.data.list).length>0?(this.informaPage=""!==a.data.page?a.data.page:"",n="",i.forEach((function(e,t){var a=1==e.status,i=e.head_portrait?e.head_portrait:defaultHeadImg;a&&(r=!0),n+='<div class="inform_item '.concat(a?"unlook":"",'">\n                            <div class="inform_avatar">\n                              <img src="').concat(i,'" alt="">\n                            </div>\n                            <div class="inform_info_box">\n                              <div class="inform_info_name">').concat(e.user_name,'</div>\n                              <div class="inform_info_text">').concat(e.title,'</div>\n                              <div class="inform_info_time">').concat(checkTimestamp(e.created_at),'</div>\n                            </div>\n                            <div class="inform_chat">\n                              <img src="').concat(e.image,'" alt="">\n                            </div>\n                          </div>')})),t?$(".inform_list").html(n):$(".inform_list").append(n),r?($("#header_inform").addClass("unlook"),this.unlook=!0):(this.unlook=!1,$("#header_inform").removeClass("unlook")),$(".noInform").hide(),$(".inform_list").show()):($(".noInform").css("display","block"),$(".inform_list").hide()),informTimer=setTimeout((function(){s.GetIfications()}),12e4)),this.isLoadingInform=!1,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),this.isLoadingInform=!1,console.log(e.t0,"error Failed to initialize voice");case 18:case"end":return e.stop()}}),e,this,[[6,14]])}))),function(){return u.apply(this,arguments)})},{key:"clearIfication",value:(d=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.unlook){e.next=3;break}return e.next=3,fetchPost("chat/notifications/clear");case 3:this.GetIfications();case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"GetSettingInfo",value:(l=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(tryTimes<=3)){e.next=48;break}return e.prev=1,e.next=4,fetchPost("ai/tool/get-task",{id:t});case 4:if(200!==(r=e.sent).code){e.next=20;break}if(0!==r.data.status){e.next=18;break}return a=r.data.additional_data,this.mc_Dialogue=a.example_chat,this.mc_Greeting=a.greeting,this.mc_Persona=a.persona,this.mc_Scenario=a.scenario,$(".createMC_persona").val(this.mc_Persona).get(0).dispatchEvent(evt),$(".createMC_Greeting").val(this.mc_Greeting).get(0).dispatchEvent(evt),$(".createMC_Scenario").val(this.mc_Scenario).get(0).dispatchEvent(evt),$(".createMC_Dialogue").val(this.mc_Dialogue).get(0).dispatchEvent(evt),this.editMcType="edit",e.abrupt("return");case 18:case 25:e.next=29;break;case 20:if(!(tryTimes<=3)){e.next=27;break}return console.log("try repeat1 -",tryTimes),tryTimes++,e.next=25,new Promise((function(e){return setTimeout(e,2e3)}));case 27:case 42:return $Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.generateError,type:"error"}),e.abrupt("return");case 29:e.next=44;break;case 31:if(e.prev=31,e.t0=e.catch(1),console.log(e.t0,"error"),!(tryTimes<=3)){e.next=42;break}return console.log("try repeat2 -",tryTimes),tryTimes++,e.next=39,new Promise((function(e){return setTimeout(e,2e3)}));case 39:return e.abrupt("return");case 44:return e.next=46,new Promise((function(e){return setTimeout(e,2e3)}));case 46:e.next=0;break;case 48:case"end":return e.stop()}}),e,this,[[1,31]])}))),function(e){return l.apply(this,arguments)})},{key:"addTaskGetSettingInfo",value:(c=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetchPost("ai/ai-tool/add-task",{action:"aichat_role_generate",param:{type:2,name:this.mc_Name,description:this.mc_Desc,lang:questLanguage}});case 3:if(t=e.sent,tryTimes=0,200==t.code){e.next=8;break}return $Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.generateError,type:"error"}),e.abrupt("return");case 8:return e.next=10,this.GetSettingInfo(t.data.task_id);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.generateError,type:"error"}),console.log(e.t0,"error get-task");case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(){return c.apply(this,arguments)})},{key:"GetRoleInfo",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,a,i,n,s,o,c,l=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:2,a=l.length>2&&void 0!==l[2]?l[2]:0,e.prev=2,e.next=5,fetchGet("chat/user/get-role-info?id=".concat(t,"&is_my_characters=").concat(r,"&my_characters_id=").concat(a));case 5:200===(i=e.sent).code&&(c=i.data,this.my_characters_id=c.my_characters_id,this.mc_Avatar=c.head_portrait[0].url,this.mc_Name=c.name,this.mc_Desc=c.json.Character_des,this.mc_Background=null===(n=c.head_portrait_background[0])||void 0===n?void 0:n.url,this.mc_Persona=c.persona,this.mc_Gender=c.json.gender,this.is_draft=4==c.status,this.mc_visibility=1==c.type?jsonAiGirlFriend.classifySelect.Public:jsonAiGirlFriend.classifySelect.Private,this.mc_Categories=c.json.tag.length>0?c.json.tag.split(","):[],this.mc_Greeting=c.role_content.greeting.toString(),this.mc_Scenario=c.role_content["scene description"],this.mc_Dialogue=c.role_content.context,this.head_portrait=c.head_portrait,this.head_portrait_background=c.head_portrait_background,this.mc_roleId=c.role_id,this.voice_json=c.voice_json?c.voice_json:this.voiceArr[0],$("#createMC_background_img").attr("src",null===(s=c.head_portrait_background[0])||void 0===s?void 0:s.url),$("#createMC_avatar_img").attr("src",null===(o=c.head_portrait[0])||void 0===o?void 0:o.url),$(".whiteMeOut").val(this.mc_Desc).get(0).dispatchEvent(evt),$(".createMC_name").val(this.mc_Name).get(0).dispatchEvent(evt),$(".createMC_gender").val(this.mc_Gender).get(0).dispatchEvent(evt),$(".createMC_persona").val(this.mc_Persona).get(0).dispatchEvent(evt),$(".createMC_Greeting").val(this.mc_Greeting).get(0).dispatchEvent(evt),$(".createMC_Scenario").val(this.mc_Scenario).get(0).dispatchEvent(evt),$(".createMC_Dialogue").val(this.mc_Dialogue).get(0).dispatchEvent(evt),this.oldRoleInfo={role_id:this.mc_roleId,name:this.mc_Name,type:this.mc_visibility,is_draft:this.is_draft,tag:this.mc_Categories.join(","),description:this.mc_Desc,persona:this.mc_Persona,scene:this.mc_Scenario,greeting:this.mc_Greeting,context:this.mc_Dialogue,head_portrait:JSON.stringify(this.head_portrait),head_portrait_background:JSON.stringify(this.head_portrait_background)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0,"error get role info");case 12:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return o.apply(this,arguments)})},{key:"GetAiDesc",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:function(){},e.prev=1,e.next=4,fetchGet("chat/user/get-setting?type=role");case 4:200===(r=e.sent).code&&(a=r.data,i=randomchoice(a),$(".whiteMe").val(i().description),null==t||t()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0,"error get role info");case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),function(){return s.apply(this,arguments)})},{key:"roleEdit",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a,i,n,s,o,c,l,d=this,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:function(){},r=u.length>1&&void 0!==u[1]?u[1]:function(){},e.prev=2,this.mc_visibility==jsonAiGirlFriend.classifySelect.Public?(a=1,gtag("event","public_aigirlfriend_edit")):(a=2,gtag("event","private_aigirlfriend_edit")),i=this.is_draft?1:2,n=this.head_portrait,s=this.head_portrait_background,delete n.url,delete s.url,o={role_id:this.mc_roleId,my_characters_id:this.my_characters_id,name:this.mc_Name.trim(),type:a,is_draft:i,persona:this.mc_Persona.trim(),gender:this.mc_Gender.trim(),tag:this.mc_Categories.join(","),description:this.mc_Desc.trim(),scene:this.mc_Scenario.trim(),greeting:this.mc_Greeting.trim(),context:this.mc_Dialogue.trim(),head_portrait:JSON.stringify(n),head_portrait_background:JSON.stringify(s),voice_json:JSON.stringify(this.voice_json)},e.next=11,fetchPost("chat/user/role-edit",o,{},!1);case 11:401==(c=e.sent).code?(gtag("event","alert_aigirlfriend_loginwinedit"),l=$Popup({title:jsonAiGirlFriend.createMc.bootLoginTitle,content:jsonAiGirlFriend.createMc.bootLoginDesc,closeBtn:jsonAiGirlFriend.login,applyBtn:jsonAiGirlFriend.createMc.NotNow,autoClose:!1,exist:"bootLogin",onClose:function(){gtag("event","login_aigirlfriend_loginwinedit"),l.close(),showLoginWindow({fn:function(){gtag("evet","succ_aigirlfriend_loginwinedit")}})},onApply:function(){gtag("event","notnow_aigirlfriend_loginwindit"),l.close(),d.clearInput(),d.closeCD()},topCloseFn:function(){gtag("event","close_aigirlfriend_loginwinedit")}}),null==r||r()):200===c.code?null==t||t():(this.is_draft?$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.draftSaveError,type:"error"}):$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.publishError,type:"error"}),null==r||r()),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(r,"error"),this.is_draft?$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.draftSaveError,type:"error"}):$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.publishError,type:"error"}),null==r||r(),console.log(e.t0," create or edit role error");case 21:case"end":return e.stop()}}),e,this,[[2,15]])}))),function(){return n.apply(this,arguments)})},{key:"addRecentChatting",value:function(e){var t=this;console.log(e,"addRecentChatting");var r,a,i=e.chat_id,n=this.recentCharacters.findIndex((function(e){return e.chat_id==i})),s=$(".edit.recent").hasClass("active"),o="";-1!=n?($(".RecentChattingBox").children().eq(n).insertBefore($(".RecentChattingBox").children().eq(0)),$(".Recent_item").eq(0).find(".recent_head_port").attr("src",null===(r=e.head_portrait[0])||void 0===r?void 0:r.url),$(".Recent_item").eq(0).find(".name").text(e.name),this.recentCharacters.splice(n,1)):(o='<div class="Recent_item" data-id="'.concat(e.chat_id,'">\n        <img src="').concat(null===(a=e.head_portrait[0])||void 0===a?void 0:a.url,'" alt="" class=\'recent_head_port\'/>\n        <div class="name">').concat(e.name,'</div>\n        <div class="deleteChat recent ').concat(s?"active":"",'" style="display: ').concat(s?"flex":"none",';">\n          <img src="/dist/img/aiFriend/btn_close_normal.svg" alt="" class="" />\n        </div>\n      </div>'),$(".RecentChattingBox").prepend(o));this.recentCharacters.unshift(e),$(".Recent_hr").css("display","flex"),$(".RecentChatting").css("display","flex"),setTimeout((function(){t.composeRecent()}),500)}},{key:"clickFn",value:function(){var e=this,t=$("#voice_type"),r=$("#voicePool_type");function a(){gtag("event","alert_aigirlfriend_loginwinedit");var t=$Popup({title:jsonAiGirlFriend.createMc.bootLoginTitle,content:jsonAiGirlFriend.createMc.bootLoginDesc,closeBtn:jsonAiGirlFriend.login,applyBtn:jsonAiGirlFriend.createMc.NotNow,autoClose:!1,exist:"bootLogin",onClose:function(){gtag("event","login_aigirlfriend_loginwinedit"),t.close(),showLoginWindow({fn:function(){gtag("evet","succ_aigirlfriend_loginwinedit")}})},onApply:function(){gtag("event","notnow_aigirlfriend_loginwindit"),t.close(),e.closeCD()},topCloseFn:function(){gtag("event","close_aigirlfriend_loginwinedit")}})}t.on("ended",(function(){$(".voice_item.active .icon").removeClass("active")})),t.on("play",(function(){$(".voice_item.active .icon").addClass("active")})),t.on("pause",(function(){$(".voice_item.active .icon").removeClass("active")})),r.on("ended",(function(){$(".pool_voice.active .icon").removeClass("active")})),r.on("play",(function(){$(".pool_voice.active .icon").addClass("active")})),r.on("pause",(function(){$(".pool_voice.active .icon").removeClass("active")})),$(".heart").click((function(){$(".Characters_hr")[0].scrollIntoView({behavior:"instant",block:"start",inline:"end"}),$(this).hasClass("active")?e.isLike=!1:(e.isLike=!0,gtag("event","like_aigirlfriend_hfilter")),$(this).toggleClass("active"),e.initCharacters()})),$(".Segment_item").click((function(){$(".Segment_item").removeClass("active"),$("body")[0].scrollIntoView({behavior:"instant",inline:"nearest"}),$(this).addClass("active"),$(".myCharactersBox,.voicePoolBox_banner,.SegmentBox,.voicePoolBox").hide(),$(".createBtn").show(),"myCharacters"===$(this).attr("id")?(gtag("event","click_aigirlfriend_mytab"),e.tab="my",$(".myCharactersBox").show(),e.composeClassify($(".myCharactersBox"))):"voicepool"===$(this).attr("id")?(e.tab="voice",$(".voicePoolBox,.voicePoolBox_banner").show(),$(".createBtn").hide()):(gtag("event","click_aigirlfriend_htab"),e.tab="all",$(".SegmentBox").show(),e.composeRecent(),e.composeClassify($(".SegmentBox")))})),$(".edit").click((function(){$(this).hasClass("active")?($(this).removeClass("active"),$(this).text(jsonAiGirlFriend.edit),$(this).hasClass("recent")?($(".Recent_item .deleteChat").removeClass("active").hide(),gtag("event","click_aigirlfriend_hrctedit")):($(".myCharacters_item .deleteChat").removeClass("active").hide(),gtag("event","click_aigirlfriend_mycedit"),$(".myCharacters_item .share_icon").css("display","flex"))):($(this).addClass("active"),$(this).text(jsonAiGirlFriend.Done),$(this).hasClass("recent")?($(".Recent_item .deleteChat").addClass("active").css("display","flex"),gtag("event","click_aigirlfriend_hrctedit")):($(".myCharacters_item .deleteChat").addClass("active").show(),gtag("event","click_aigirlfriend_mycedit"),$(".myCharacters_item .share_icon").hide()))})),$(".createMc").click((function(){e.lastTab=e.tab,e.editMcType="create",$(this).hasClass("createBtn")?gtag("event","click_aigirlfriend_create"):gtag("event","click_aigirlfriend_nodatacreate")})),$(".create_back_box,.mc_btn.discard").click((function(){var t,r=$(this).hasClass("create_back_box");if("edit"==e.editMcType)if($(this).hasClass("discard")?gtag("event","discard_aigirlfriend_edit"):gtag("event","back_aigirlfriend_edit"),getCookie("access_token")){var a={role_id:e.mc_roleId,name:e.mc_Name,type:e.mc_visibility,is_draft:e.is_draft,tag:e.mc_Categories.join(","),description:e.mc_Desc,scene:e.mc_Scenario,persona:e.mc_Persona,greeting:e.mc_Greeting,context:e.mc_Dialogue,head_portrait:JSON.stringify(e.head_portrait),head_portrait_background:JSON.stringify(e.head_portrait_background)};if(areObjectsEqual(a,e.oldRoleInfo))e.clearInput(),e.closeCD(!r,r);else var i=$Popup({title:jsonAiGirlFriend.toSaveTitle,content:jsonAiGirlFriend.toSaveDesc,closeBtn:jsonAiGirlFriend.save,applyBtn:jsonAiGirlFriend.createMc.NotNow,autoClose:!1,exist:"bootLogin",onClose:function(){i.loading.start(),e.is_draft=!0,e.editDraftUpload((function(){i.close()}),(function(){i.close()}))},onApply:function(){i.close(),e.clearInput(),e.closeCD(!r,r)}})}else{gtag("event","alert_aigirlfriend_loginwinedit");var n=$Popup({title:jsonAiGirlFriend.createMc.bootLoginTitle,content:jsonAiGirlFriend.createMc.bootLoginDesc,closeBtn:jsonAiGirlFriend.login,applyBtn:jsonAiGirlFriend.createMc.NotNow,autoClose:!1,exist:"bootLogin",onClose:function(){gtag("event","login_aigirlfriend_loginwinedit"),n.close(),showLoginWindow({fn:function(){gtag("evet","succ_aigirlfriend_loginwinedit")}})},onApply:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:gtag("event","notnow_aigirlfriend_loginwindit"),n.close(),e.clearInput(),e.closeCD(!r,r);case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)}),topCloseFn:function(){gtag("event","close_aigirlfriend_loginwinedit")}})}else e.clearInput(),e.closeCD(!r,r)})),$("#createMc").click(_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!0,e.mc_Avatar?$(".erorrTip[data-type='avatar']").css("visibility","hidden"):($(".erorrTip[data-type='avatar']").find(".image_error").text(jsonAiGirlFriend.createMc.avatar_not),$(".erorrTip[data-type='avatar']").css("visibility","visible"),r=!1),e.mc_Name&&0!=$(".maxLength[data-input='name'] span").text()?$(".erorrTip[data-type='name']").css("visibility","hidden"):($(".erorrTip[data-type='name']").css("visibility","visible"),r=!1),e.mc_Desc&&0!=$(".maxLength[data-input='description'] span").text()?$(".erorrTip[data-type='description']").css("visibility","hidden"):($(".erorrTip[data-type='description']").css("visibility","visible"),r=!1),r){t.next=6;break}return t.abrupt("return");case 6:return gtag("event","click_aigirlfriend_aicreate"),e.oldRoleInfo={role_id:e.mc_roleId,name:e.mc_Name,type:e.mc_visibility,is_draft:e.is_draft,tag:e.mc_Categories.join(","),description:e.mc_Desc,scene:e.mc_Scenario,greeting:e.mc_Greeting,persona:e.persona,context:e.mc_Dialogue,head_portrait:JSON.stringify(e.head_portrait),head_portrait_background:JSON.stringify(e.head_portrait_background)},$(this).addClass("loading"),$(".createMc_item,.create_back_box").addClass("loading"),t.next=12,e.addTaskGetSettingInfo();case 12:$(this).removeClass("loading"),$(".createMc_item,.create_back_box").removeClass("loading");case 14:case"end":return t.stop()}}),t,this)})))),$("#editMc").click(_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,i,n=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(gtag("event","publish_aigirlfriend_edit"),r=!0,e.mc_Avatar?$(".erorrTip[data-type='avatar']").css("visibility","hidden"):($(".erorrTip[data-type='avatar']").find(".image_error").text(jsonAiGirlFriend.createMc.avatar_not),$(".erorrTip[data-type='avatar']").css("visibility","visible"),r=!1),e.mc_Name&&0!=$(".maxLength[data-input='name'] span").text()?$(".erorrTip[data-type='name']").css("visibility","hidden"):($(".erorrTip[data-type='name']").css("visibility","visible"),r=!1),e.mc_Persona&&0!=$(".maxLength[data-input='persona'] span").text()?$(".erorrTip[data-type='persona']").css("visibility","hidden"):($(".erorrTip[data-type='persona']").css("visibility","visible"),r=!1),e.mc_Desc&&0!=$(".maxLength[data-input='description'] span").text()?$(".erorrTip[data-type='description']").css("visibility","hidden"):($(".erorrTip[data-type='description']").css("visibility","visible"),r=!1),0==e.mc_Categories.length?($(".erorrTip[data-type='Categories']").css("visibility","visible"),r=!1):$(".erorrTip[data-type='Categories']").css("visibility","hidden"),e.mc_Greeting&&0!=$(".maxLength[data-input='Greeting'] span").text()?$(".erorrTip[data-type='Greeting']").css("visibility","hidden"):($(".erorrTip[data-type='Greeting']").css("visibility","visible"),r=!1),e.mc_Scenario&&0!=$(".maxLength[data-input='Scenario'] span").text()?$(".erorrTip[data-type='Scenario']").css("visibility","hidden"):($(".erorrTip[data-type='Scenario']").css("visibility","visible"),r=!1),r){t.next=11;break}return t.abrupt("return");case 11:if(getCookie("access_token")){t.next=14;break}return a(),t.abrupt("return");case 14:return e.is_draft=!1,$(this).addClass("loading"),i=function(){return $(n).removeClass("loading")},t.next=19,e.editDraftUpload(i,i,"all");case 19:case"end":return t.stop()}}),t,this)})))),$("#draftMc").click(_asyncToGenerator(_regeneratorRuntime().mark((function t(){var r,i=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(gtag("event","draft_aigirlfriend_edit"),getCookie("access_token")){t.next=4;break}return a(),t.abrupt("return");case 4:return e.is_draft=!0,$(this).addClass("loading"),r=function(){return $(i).removeClass("loading")},t.next=9,e.editDraftUpload(r,r,"draft");case 9:case"end":return t.stop()}}),t,this)})))),$("#createMC_avatar").on("change",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var a=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isUploadAvatar=!0,e.uploadImage($(".createMyCharacter_Box .avatar"),r,this,"avatar",(function(){$(a).val("")}));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()),$("#createMC_background").on("change",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var a=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isUploadBackground=!0,e.uploadImage($("#background"),r,this,"background",(function(){$(a).val("")}));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()),$("#editUserAvatar").on("change",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var a=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isUploadUserAvatar=!0,e.uploadImage($(".modal.editUser .avatar"),r,this,"editAvatar",(function(){$(a).val("")}));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()),$(".writeMe").click((function(){gtag("event","show_aigirlfriend_aiwrite");var t=$Popup({type:"createMC",title:jsonAiGirlFriend.createMc.writeMe_title,content:$(".whiteMeContent").html(),closeBtn:jsonAiGirlFriend.createMc.Generate,applyBtn:jsonAiGirlFriend.createMc.Apply,autoClose:!1,exist:"exist",onClose:function(){gtag("event","generate_aigirlfriend_aiwrite"),t.loading.start(),e.GetAiDesc((function(){t.loading.end()}))},onApply:function(){gtag("event","apply_aigirlfriend_aiwrite");var r=$(".createMC .whiteMe").val();r.length>0&&(e.mc_Desc=r,t.close())}})})),$(".whiteMe,.whiteMeOut").on("input",(function(){var t=e.inputCharacter($(this),500,"description");$(this).hasClass("whiteMeOut")&&(e.mc_Desc=t)})),$(".createMC_name").on("input",(function(){var t=e.inputCharacter($(this),30,"name");e.mc_Name=t})),$(".createMC_gender").on("input",(function(){var t=e.inputCharacter($(this),30,"gender");e.mc_Gender=t})),$(".createMC_persona").on("input",(function(){var t=e.inputCharacter($(this),500,"persona");e.mc_Persona=t})),$(".createMC_Greeting").on("input",(function(){var t=e.inputCharacter($(this),330,"Greeting");e.mc_Greeting=t})),$(".createMC_Scenario").on("input",(function(){var t=e.inputCharacter($(this),500,"Scenario");e.mc_Scenario=t})),$(".createMC_Dialogue").on("input",(function(){var t=e.inputCharacter($(this),700,"Dialogue");e.mc_Dialogue=t})),$(".header_editUser").click((function(){gtag("event","editprofile_aigirlfriend_header"),$(".signout").hide(),e.clearUserData();var t,r=$Popup({type:"editUser",title:jsonAiGirlFriend.editUser.title,content:$(".editUserInfo").html(),closeBtn:jsonAiGirlFriend.editUser.save,applyBtn:jsonAiGirlFriend.editUser.cancel,autoClose:!1,exist:"editUser",onClose:function(){var t=!0;e.editUser_Avatar?$(".erorrTip[data-type='editUserAvatar']").css("visibility","hidden"):($(".erorrTip[data-type='editUserAvatar']").find(".image_error").text(jsonAiGirlFriend.createMc.avatar_not),$(".erorrTip[data-type='editUserAvatar']").css("visibility","visible"),t=!1),e.editUser_firstName?$(".erorrTip[data-type='editUser_firstName']").css("visibility","hidden"):($(".erorrTip[data-type='editUser_firstName']").css("visibility","visible"),t=!1),e.editUser_lastName?$(".erorrTip[data-type='editUser_lastName']").css("visibility","hidden"):($(".erorrTip[data-type='editUser_lastName']").css("visibility","visible"),t=!1),t&&(r.loading.start(),$(".modal .createMc_item").addClass("loading"),e.userInfoUpdate((function(){$(".modal .createMc_item").removeClass("loading"),r.loading.end(),r.close(),e.clearUserData(),updateUserData()}),(function(){r.loading.end()})))},onApply:(t=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.close(),e.clearUserData();case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})});e.getUserData(),e.clickUserEvent()})),$(".voiceBtnCreate").click((function(){e.lastTab=e.tab,gtag("event","click_aigirlfriend_voicecreate"),e.clearInput(),e.voice_json=_objectSpread({},e.voicePool_json),e.editMcType="create",r[0].pause()})),$("body").on("mouseup",function(){var a=_asyncToGenerator(_regeneratorRuntime().mark((function a(i){var n,s,o,c,l,d,u,h,g,_,v,p,m,f,y,b,C,k,x,w,G,T,A,M,j,F,S,R,L,P,I,B,U,N,D,E,O,q,V,W,z,H,J,K,X,Y,Q;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=$(i.target),s=0!=n.parents(".characters_item").length||n.hasClass("characters_item"),o=0!=n.parents(".myCharacters_item").length||n.hasClass("myCharacters_item"),s&&(l=n.parents(".characters_item").attr("data-indexid"),c=e.charactersList.findIndex((function(e){return parseInt(e.id)==parseInt(l)}))),o&&(d=n.parents(".myCharacters_item").attr("data-indexid"),u=e.mycharactersList.findIndex((function(e){return parseInt(e.id)==parseInt(d)})),c=u>=0?u:c),0!=n.parents(".chatSelect").length||n.hasClass("chatSelect")||$(".chatSelect").removeClass("active").children(".select_list").slideUp(),0==n.parents(".head_shareBox").length&&$(".head_shareBox").hide(),!n.hasClass("like_icon")){a.next=18;break}if(h=n.parents(".characters_item").data("id")||n.parents(".myCharacters_item").data("id"),0==(g=n.parents(".myCharacters_item").find(".deleteChat")).length||!g.hasClass("active")){a.next=12;break}return a.abrupt("return");case 12:return 0!=n.parents(".characters_item").length?(_=n.data("likes"),n.hasClass("active")?(_>0?_--:_=0,n.siblings(".num").text(formatNumber(_)),n.siblings(".like_num").text(_>1?jsonAiGirlFriend.likes:jsonAiGirlFriend.like),n.data("likes",_),e.charactersList[c].is_like=2):(_++,n.siblings(".num").text(formatNumber(_)),n.siblings(".like_num").text(_>1?jsonAiGirlFriend.likes:jsonAiGirlFriend.like),n.data("likes",_),gtag("event","click_aigirlfriend_hlikebtn"),e.charactersList[c].is_like=1)):n.hasClass("active")?e.mycharactersList[c].is_like=2:(gtag("event","click_aigirlfriend_myclikebtn"),e.mycharactersList[c].is_like=1),n.toggleClass("active"),e.changeLike(h),a.abrupt("return");case 18:if(0==n.parents(".share_icon").length){a.next=24;break}return(v=n.parents(".share_icon").siblings(".head_shareBox")).hasClass("active")?v.removeClass("active").hide():v.addClass("active").show(),a.abrupt("return");case 24:if(!n.hasClass("shareInbox")){a.next=30;break}return s?(gtag("event","click_aigirlfriend_hshare"),p=e.charactersList[c],e.showShare(p.role_id,p.head_portrait[0].value)):(gtag("event","click_aigirlfriend_mycshare"),m=e.mycharactersList[c],e.showShare(m.role_id,m.head_portrait[0].value)),$(".head_shareBox").hide(),a.abrupt("return");case 30:if(!n.hasClass("editInbox")){a.next=48;break}if(e.lastTab=e.tab,e.editMcType="edit",$("body")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),0==n.parents(".characters_item").length){a.next=41;break}return gtag("event","click_aigirlfriend_hedit"),f=e.charactersList[c],a.next=39,e.GetRoleInfo(f.role_id,1,f.my_chat_id);case 39:a.next=45;break;case 41:return gtag("event","click_aigirlfriend_mycchatedit"),y=e.mycharactersList[c],a.next=45,e.GetRoleInfo(y.role_id,1,y.my_characters_id);case 45:return a.abrupt("return");case 48:if(!n.hasClass("classify_item")){a.next=56;break}return $(".description")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"end"}),b=0!=n.parents(".SegmentBox").length,C=n.data("tag"),ttsBlank(C)?b?(e.homeTag=[],gtag("event","htag_aigirlfriend_allcharacters"),$(".SegmentBox .classify_item").removeClass("active"),$(".SegmentBox .classify_item").eq(0).addClass("active")):(e.mcTag=[],gtag("event","mytag_aigirlfriend_allcharacters"),$(".myCharactersBox .classify_item").removeClass("active"),$(".myCharactersBox .classify_item").eq(0).addClass("active")):(b?($(".SegmentBox .classify_item").eq(0).removeClass("active"),-1!==(k=e.homeTag.findIndex((function(e){return e===C})))?e.homeTag.splice(k,1):(e.homeTag.push(C),x=(x=n.attr("data-tag")).replace(/\s+/g,"").toLowerCase(),gtag("event","htag_aigirlfriend_".concat(x))),w=e.homeTag,e.homeTag=w,0==e.homeTag.length&&$(".SegmentBox .classify_item").eq(0).addClass("active")):($(".myCharactersBox .classify_item").eq(0).removeClass("active"),-1!==(G=e.mcTag.findIndex((function(e){return e===C})))?e.mcTag.splice(G,1):(e.mcTag.push(C),T=(T=n.attr("data-tag")).replace(/\s+/g,"").toLowerCase(),gtag("event","mytag_aigirlfriend_".concat(T))),A=e.mcTag,e.mcTag=A,0==e.mcTag.length&&$(".myCharactersBox .classify_item").eq(0).addClass("active")),n.toggleClass("active")),a.abrupt("return");case 56:if(!n.hasClass("createMc_radio")){a.next=61;break}return setTimeout((function(){if(n.is(":checked"))e.mc_Categories.push(n.attr("value"));else{var t=n.attr("value"),r=e.mc_Categories.findIndex((function(e){return e==t}));e.mc_Categories.splice(r,1)}var a=e.mc_Categories;e.mc_Categories=a;var i;i=(e.mc_Categories.length>1?jsonAiGirlFriend.createMc.Categories_tips:jsonAiGirlFriend.createMc.Categories_tip).replace("%ss",e.mc_Categories.length),$(".checkNum").text(i)}),5),a.abrupt("return");case 61:if(0==n.parents(".deleteChat").length){a.next=65;break}n.parents(".deleteChat").hasClass("recent")?(gtag("event","click_aigirlfriend_hrctdelete"),j=n.parents(".Recent_item").attr("data-id"),M=$Popup({title:jsonAiGirlFriend.deleteRecentTitle,content:jsonAiGirlFriend.deleteRecentText,closeBtn:jsonAiGirlFriend.Delete,otherBtns:'<button class="cannel">'.concat(jsonAiGirlFriend.Cancel,"</button>"),autoClose:!1,exist:"deletePop",onClose:function(){gtag("event","del_aigirlfriend_hrctdelete"),M.loading.start(),e.deleteChat(j,_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.GetRecentChatting();case 2:M.close();case 3:case"end":return t.stop()}}),t)}))))}}),$(".modal .cannel").click((function(){gtag("event","cancel_aigirlfriend_hrctdelete"),M.close()}))):(gtag("event","click_aigirlfriend_mycdelete"),F=e.mycharactersList[c].my_characters_id,M=$Popup({title:jsonAiGirlFriend.deleteMyChatTitle,content:jsonAiGirlFriend.deleteMyChatText,closeBtn:jsonAiGirlFriend.Delete,otherBtns:'<button class="cannel">'.concat(jsonAiGirlFriend.Cancel,"</button>"),autoClose:!1,exist:"deletePop",onClose:function(){gtag("event","del_aigirlfriend_mycdelete"),M.loading.start(),e.deleteMyChat(F,_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.GetMyCharacters();case 2:return t.next=4,e.GetRecentChatting();case 4:M.close();case 5:case"end":return t.stop()}}),t)}))))}}),$(".modal .cannel").click((function(){gtag("event","cancel_aigirlfriend_mycdelete"),M.close()}))),a.next=231;break;case 65:if(0==n.parents(".characters_item").length){a.next=71;break}return n.hasClass("chatNow")?gtag("event","click_aigirlfriend_hchatbtn"):gtag("event","click_aigirlfriend_hcard"),aiChatting.init(e.charactersList[c]),a.abrupt("return");case 71:if(0==n.parents(".myCharacters_item").length){a.next=90;break}if(n.hasClass("chatNow")?gtag("event","click_aigirlfriend_mycchatbtn"):gtag("event","click_aigirlfriend_myccard"),!n.parents(".myCharacters_item").find(".deleteChat").hasClass("active")){a.next=75;break}return a.abrupt("return");case 75:if(S=n.parents(".myCharacters_item"),4==S.attr("data-status")){a.next=81;break}aiChatting.init(e.mycharactersList[c]),a.next=87;break;case 81:return gtag("event","click_aigirlfriend_myccardedit"),e.lastTab=e.tab,e.editMcType="edit",R=e.mycharactersList[c],a.next=87,e.GetRoleInfo(R.role_id,1,R.my_characters_id);case 87:return a.abrupt("return");case 90:if(0==n.parents(".Recent_item").length){a.next=100;break}if(!n.parents(".Recent_item").find(".deleteChat").hasClass("active")){a.next=93;break}return a.abrupt("return");case 93:return gtag("event","click_aigirlfriend_hrctcard"),L=n.parents(".Recent_item").attr("data-id"),P=e.recentCharacters.findIndex((function(e){return e.chat_id==L})),aiChatting.init(e.recentCharacters[P]),a.abrupt("return");case 100:if(0==n.parents(".voicePool_item").length&&!n.hasClass("voicePool_item")){a.next=134;break}e.voiceOpen="pool_voice",I=0!=n.parents(".voicePool_item").length?n.parents(".voicePool_item"):n,$(".voicePool_item").removeClass,B=I.find(".pool_voice"),U=$("#voicePool_type")[0],N=B.attr("data-name"),a.t0=N,a.next="Sexy(Male)"===a.t0?110:"Youth(Male)"===a.t0?112:"Bass(Male)"===a.t0?114:116;break;case 110:return gtag("event","click_aigirlfriend_voicesexy2"),a.abrupt("break",117);case 112:return gtag("event","click_aigirlfriend_voiceyouth2"),a.abrupt("break",117);case 114:return gtag("event","click_aigirlfriend_voicebass2"),a.abrupt("break",117);case 116:gtag("event","click_aigirlfriend_voice".concat(N.toLowerCase()));case 117:if(!B.hasClass("active")){a.next=120;break}return U.paused?U.play():U.pause(),a.abrupt("return");case 120:D=e.voiceArr.findIndex((function(e){return e.name==N})),e.voicePool_json=e.voiceArr[D],E=e.voiceArr[D].ai_url_2,$(".voicePool_item,.pool_voice").removeClass("active"),$(".pool_voice .icon").removeClass("active"),I.addClass("active"),B.addClass("active"),U.pause(),U.setAttribute("src",E),U.currentTime=0,t[0].pause(),setTimeout((function(){U.play()}),30),a.next=231;break;case 134:if(0==n.parents(".voice_item").length&&!n.hasClass("voice_item")){a.next=148;break}if(e.voiceOpen="voice_item",O=0!=n.parents(".voice_item").length?n.parents(".voice_item"):n,q=$("#voice_type")[0],!O.hasClass("active")){a.next=141;break}return q.paused?q.play():q.pause(),a.abrupt("return");case 141:V=O.attr("data-name"),W=e.voiceArr.findIndex((function(e){return e.name==V})),e.voice_json=e.voiceArr[W],r[0].pause(),setTimeout((function(){q.play()}),30),a.next=231;break;case 148:if(0==n.parents(".addImage").length&&!n.hasClass("addImage")){a.next=153;break}0!=(z=0!=n.parents(".addImage").length?n.parents(".addImage"):n).parents(".avatar").length?0!=z.parents(".editUser").length?$("#editUserAvatar").click():$("#createMC_avatar").click():0!=z.parents(".background").length&&$("#createMC_background").click(),a.next=231;break;case 153:if(!n.hasClass("select_list_item")){a.next=230;break}if(H=n.data("sort_time"),J=n.data("sort"),K=n.data("type"),X=n.data("primary"),Y=n.data("age"),0!=n.parents("#select_sort_time").length&&(e.sort_time=H),0!=n.parents("#select_sort").length&&(e.sort=J,"top"==J?$(".select_time").css("display","flex"):$(".select_time").hide()),0==n.parents(".editUserAge").length){a.next=183;break}e.editUserAge=Y,n.parents(".select_list").siblings(".select_content").attr("data-age",Y),a.t1=Y,a.next="1-10"===a.t1?167:"10-15"===a.t1?169:"15-20"===a.t1?171:"20-25"===a.t1?173:"25-30"===a.t1?175:"30-40"===a.t1?177:"40-50"===a.t1?179:"50+"===a.t1?181:183;break;case 167:return gtag("event","click_aigirlfriend_agerange1"),a.abrupt("break",183);case 169:return gtag("event","click_aigirlfriend_agerange2"),a.abrupt("break",183);case 171:return gtag("event","click_aigirlfriend_agerange3"),a.abrupt("break",183);case 173:return gtag("event","click_aigirlfriend_agerange4"),a.abrupt("break",183);case 175:return gtag("event","click_aigirlfriend_agerange5"),a.abrupt("break",183);case 177:return gtag("event","click_aigirlfriend_agerange6"),a.abrupt("break",183);case 179:return gtag("event","click_aigirlfriend_agerange7"),a.abrupt("break",183);case 181:return gtag("event","click_aigirlfriend_agerange8"),a.abrupt("break",183);case 183:if(ttsBlank(K)||(e.mc_visibility=K),0==n.parents(".classify").length){a.next=198;break}e.composeClassify($(".myCharactersBox")),e.primary=X,a.t2=X,a.next=""===a.t2?190:a.t2===jsonAiGirlFriend.classifySelect.Public?192:a.t2===jsonAiGirlFriend.classifySelect.Private?194:a.t2===jsonAiGirlFriend.classifySelect.Draft?196:198;break;case 190:return gtag("event","all_aigirlfriend_filter"),a.abrupt("break",198);case 192:return gtag("event","public_aigirlfriend_filter"),a.abrupt("break",198);case 194:return gtag("event","private_aigirlfriend_filter"),a.abrupt("break",198);case 196:return gtag("event","draft_aigirlfriend_filter"),a.abrupt("break",198);case 198:if("sort"!==Object.keys(n.data())[0]||0==n.parents(".character_select").length){a.next=209;break}getCookie("access_token")?setCookie("aiGirlSort",J):setCookie("aiGirlSort",""),a.t3=!0,a.next=a.t3===("top"==J)?203:a.t3===("hot"==J)?205:207;break;case 203:return gtag("event","top_aigirlfriend_hfilter"),a.abrupt("break",207);case 205:return gtag("event","hot_aigirlfriend_hfilter"),a.abrupt("break",207);case 207:a.next=222;break;case 209:a.t4=!0,a.next=a.t4===("day"==H)?212:a.t4===("week"==H)?214:a.t4===("month"==H)?216:a.t4===("year"==H)?218:a.t4===(""==H)?220:222;break;case 212:return gtag("event","top_aigirlfriend_hdayfilter"),a.abrupt("break",222);case 214:return gtag("event","top_aigirlfriend_hweekfilter"),a.abrupt("break",222);case 216:return gtag("event","top_aigirlfriend_hmonthfilter"),a.abrupt("break",222);case 218:return gtag("event","top_aigirlfriend_hyearfilter"),a.abrupt("break",222);case 220:return gtag("event","top_aigirlfriend_halltimefilter"),a.abrupt("break",222);case 222:n.addClass("active"),n.siblings(".select_list_item").removeClass("active"),n.parents(".select_list").siblings(".select_content").text(n.text()),(J||H)&&(0==n.parents(".createMyCharacter_Box ").length&&$(".description")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"end"}),e.initCharacters()),n.parents(".select_list").slideUp(),n.parents(".chatSelect").removeClass("active"),a.next=231;break;case 230:0!=n.parents(".chatSelect").length||n.hasClass("chatSelect")?(Q=0!=n.parents(".chatSelect").length?n.parents(".chatSelect"):n,Q.hasClass("active")?(Q.children(".select_list").slideUp(),Q.removeClass("active")):(Q.children(".select_list").slideDown(),Q.addClass("active"),Q.siblings(".chatSelect").children(".select_list").slideUp())):n.hasClass("delete_image")&&(0!=n.parents(".background").length?e.mc_Background="":0==n.parents(".editUser").length?e.mc_Avatar="":e.editUser_Avatar="");case 231:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),$(".view,.viewMore,.back").click((function(){$(".Recent_item,.RecentChattingBox").css("transform","translateX(0px)"),$(this).hasClass("active")?($(".view").text(jsonAiGirlFriend.view),$(this).removeClass("active"),$(".RecentChatting").removeClass("viewAll"),e.composeRecent(),$(".viewMore").removeClass("active")):($(".view").text(jsonAiGirlFriend.viewLess),$(this).addClass("active"),$(".btn_left,.btn_right").hide(),$(".RecentChatting").addClass("viewAll"),$(".back").addClass("active"))}))}},{key:"editDraftUpload",value:(i=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,a){var i,n,s=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($(".createMc_item,.create_back_box").addClass("loading"),e.prev=1,!this.isUploadAvatar){e.next=7;break}return e.next=5,uploadImagePromise(this.mc_Avatar);case 5:i=e.sent,this.head_portrait=[{key:"head_portrait",url:i.res.data.access_url,value:i.res.data.key}];case 7:if(!this.isUploadBackground){e.next=12;break}return e.next=10,uploadImagePromise(this.mc_Background);case 10:n=e.sent,this.head_portrait_background=[{key:"head_portrait_background",url:n.res.data.access_url,value:n.res.data.key}];case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),null==r||r(),$(".createMc_item,.create_back_box").removeClass("loading");case 18:return e.next=20,this.roleEdit((function(){null==t||t(),$(".createMc_item,.create_back_box").removeClass("loading"),"all"==a?($(".myCharactersBox .classify_select .select_list_item").removeClass("active"),$(".myCharactersBox .classify_select .select_list_item").eq(0).addClass("active"),$(".myCharactersBox .classify_select .select_content").text(jsonAiGirlFriend.classifySelect.All),s.primary=""):"draft"==a&&($(".myCharactersBox .classify_select .select_list_item").removeClass("active"),$(".myCharactersBox .classify_select .select_list_item").eq(3).addClass("active"),$(".myCharactersBox .classify_select .select_content").text(jsonAiGirlFriend.classifySelect.Draft),s.primary=jsonAiGirlFriend.classifySelect.Draft),$(".classify_box_container .classify_item").removeClass("active"),$(".SegmentBox .classify_item").eq(0).addClass("active"),$(".myCharactersBox .classify_item").eq(0).addClass("active"),s.homeTag=[],s.mcTag=[],s.clearInput(),s.closeCD()}),(function(){null==r||r(),$(".createMc_item,.create_back_box").removeClass("loading")}));case 20:case"end":return e.stop()}}),e,this,[[1,14]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"isShowCharacterLoading",value:(a=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,a=this,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]&&i[1],e.abrupt("return",new Promise(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(i){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isLoading=t,!t||!r){e.next=5;break}return $(".characters_loading").show(),i(!0),e.abrupt("return");case 5:t&&a.num>0?($(".noFound").hide(),$(".characters").hide(),$(".characters_loading").show(),a.isLoadingTimer&&(clearTimeout(a.isLoadingTimer),a.isLoadingTimer=null,a.num>0&&a.num--),a.isLoadingTimer=setTimeout((function(){i(!0),clearTimeout(a.isLoadingTimer),a.isLoadingTimer=null}),500)):(0==a.charactersList.length?$(".noFound").show():$(".characters").show(),$(".characters_loading").hide());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"isShowMyCharacterLoading",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(){var a=_asyncToGenerator(_regeneratorRuntime().mark((function a(i){return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.isMyLoading=e,""==t.editMcType){a.next=4;break}return $(".Mycharacters_loading").hide(),a.abrupt("return");case 4:if(!e||!r){a.next=8;break}return $(".Mycharacters_loading").show(),i(!0),a.abrupt("return");case 8:e&&t.numMy>0?($(".noFoundMc").hide(),$(".myCharacters_Box").hide(),$(".Mycharacters_loading").show(),t.isMyLoadingTimer&&(clearTimeout(t.isMyLoadingTimer),t.isMyLoadingTimer=null,t.numMy>0&&t.numMy--),t.isMyLoadingTimer=setTimeout((function(){i(!0),clearTimeout(t.isMyLoadingTimer),t.isMyLoadingTimer=null}),500)):(0==t.mycharactersList.length?$(".noFoundMc").show():$(".myCharacters_Box").show(),$(".createBtn").hasClass("active")&&$(".myCharacters_Box,.noFoundMc").hide(),$(".Mycharacters_loading").hide());case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}},{key:"changeLike",value:function(e){fetchPost("chat/user/role-like",{role_id:e}).catch((function(e){console.log("role-like",e)}))}},{key:"deleteChat",value:function(e,t){fetchPost("chat/user/del-recent-chatting",{chat_id:e}).then((function(){null==t||t()})).catch((function(e){console.log("del-recent-chatting",e)}))}},{key:"deleteMyChat",value:function(e,t){fetchPost("chat/user/del-my-characters",{my_characters_id:e}).then((function(){null==t||t()})).catch((function(e){console.log("del-my-characters",e)}))}},{key:"composeRecent",value:function(){var e=$(".RecentChatting").width(),t=$(".Recent_item").width(),r=$(".Recent_item").css("margin-right"),a=$(".RecentChatting"),i=$(".RecentChattingBox");i.css("transform","translateX(0px)");var n=(t+parseFloat(r))*$(".Recent_item").length,s=0,o=3*(t+16);isShowBtnLR(s,-(n-e)),$(".btn_right").click((function(){Math.abs(s-o)>=n-e?s=-(n-e):s-=o,i.css("transform","translateX(".concat(s,"px)")),transformBtn(s,-(n-e))})),$(".btn_left").click((function(){s+o>0?s=0:s+=o,i.css("transform","translateX(".concat(s,"px)")),transformBtn(s,-(n-e))})),n>e&&"pc"!=userModel?($(".viewMore").css("visibility","visible"),$(".back").css("display","")):($(".viewMore").css("visibility","hidden"),$(".back").hide(),a.off())}},{key:"composeClassify",value:function(e){var t=e.find(".classify_item"),r=e.find(".classify_box_container").width(),a=e.find(".classify_btn_left"),i=e.find(".classify_btn_right");t.css("transform","translateX(0px)");var n=0;e.find(".classify_item").each((function(){n+=$(this).outerWidth(!0)}));var s=0,o=300;n>r&&"pc"==userModel&&transformBtn(s,-(n-r),a,i),i.click((function(){Math.abs(s-o)>=n-r?s=-(n-r):s-=o,t.css("transform","translateX(".concat(s,"px)")),transformBtn(s,-(n-r),a,i)})),a.click((function(){s+o>0?s=0:s+=o,t.css("transform","translateX(".concat(s,"px)")),transformBtn(s,-(n-r),a,i)}))}},{key:"composeBrief",value:function(){var e=this;$("body").on("mouseover",(function(t){var r=$(t.target);if("pc"==userModel&&(0!=r.parents(".characters_item").length||r.hasClass("characters_item")||0!=r.parents(".myCharacters_item").length||r.hasClass("myCharacters_item"))){var a,i,n;0!=r.parents(".characters_item").length?(a=r.parents(".characters_item").find(".brief"),i=r.parents(".characters_item"),n=e.charactersList.findIndex((function(e){return parseInt(e.id)==parseInt(i.attr("data-indexid"))}))):0!=r.parents(".myCharacters_item").length?(a=r.parents(".myCharacters_item").find(".brief"),i=r.parents(".myCharacters_item"),n=e.mycharactersList.findIndex((function(e){return parseInt(e.id)==parseInt(i.attr("data-indexid"))}))):(a=r.find(".brief"),i=r),a.removeClass("brief_left");var s=$(".aiFriend").width(),o=i.width();n++;var c=Math.floor(s/o);(Number.isInteger(n/c)?1:n/c%1)>.5&&a.addClass("brief_left")}}))}},{key:"showShare",value:function(e,t){gtag("event","share_aigirlfriend_winshow"),$Popup({title:$(".sharePop .shareTitle").html(),content:$(".sharePop .shareBox").html(),type:"share"});var r=TOOL_API+"chat/user/share?s="+btoa(t+","+window.location.origin+window.location.pathname+"?openShare="+e+","+questLanguage+",vidqu,girlfriend");$('meta[name="twitter:image"]').attr("content",t),$("meta[property='og:image']").attr("content",t),$(".shareIco.x").click((function(){gtag("event","share_aigirlfriend_tw"),openWindow("https://twitter.com/intent/tweet?url=".concat(r,"?play_source=Twitter&text=").concat(encodeURIComponent(jsonAiGirlFriend.shareText)))})),$(".shareIco.facebook").click((function(){gtag("event","share_aigirlfriend_fb"),openWindow("https://www.facebook.com/sharer.php?u=".concat(r,"?play_source=Facebook&text=").concat(encodeURIComponent(jsonAiGirlFriend.shareText))),$("meta[property='og:url']").attr("content",r)})),$(".shareIco.Link").click((function(){gtag("event","share_aigirlfriend_link"),copyText(window.location.origin+window.location.pathname+"?openShare="+e);try{ToolTip({text:"Copied successfully"})}catch(e){ToolTip({text:"Copied failed"})}}))}},{key:"eventLoginsuccess",value:function(){var e=this;document.querySelector("my-component").addEventListener("loginsuccess",function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return isLogin(!0),t.next=3,e.initCharacters();case 3:e.GetMyCharacters(),e.GetRecentChatting(),e.GetIfications();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),$(".signoutBtn").on("click",_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initCharacters();case 2:e.GetMyCharacters(),e.GetRecentChatting(),e.GetIfications();case 5:case"end":return t.stop()}}),t)}))))}},{key:"inputCharacter",value:function(e,t,r){var a=t-1,i=e.val(),n=0,s=0;"name"==r&&(i=i.replace(/[/*&\\%$#@]/g,""));var o,c="",l=_createForOfIteratorHelper(i);try{for(l.s();!(o=l.n()).done;){var d=o.value;if(s++,(n=(c+=d).trim().length)>a)break}}catch(e){l.e(e)}finally{l.f()}return n>=t?$(".maxLength[data-input='".concat(r,"']")).addClass("error"):$(".maxLength[data-input='".concat(r,"']")).removeClass("error"),n>a&&(n=t),$(".maxLength[data-input='".concat(r,"'] span")).text(n),e.val(i.substring(0,s)),i.substring(0,s)}},{key:"uploadImage",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r,a,i,n){var s,o,c,l,d,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this,r.target.files&&r.target.files[0]){e.next=5;break}return console.log("there is no file"),null==n||n(),e.abrupt("return");case 5:if(o=a.files[0],checkFileType(o)){e.next=12;break}return t.siblings(".erorrTip").find(".image_error").text(jsonAiGirlFriend.imageNoSupported),t.siblings(".erorrTip").css("visibility","visible"),$(a).val(null),null==n||n(),e.abrupt("return",!1);case 12:if(!((null==o?void 0:o.size)>104857600)){e.next=18;break}return t.siblings(".erorrTip").find(".image_error").text(jsonAiGirlFriend.imageSizeError),t.siblings(".erorrTip").css("visibility","visible"),$(a).val(null),null==n||n(),e.abrupt("return",!1);case 18:return e.next=20,resizeImageByFile(o);case 20:c=e.sent,l=c.blog,d=URL.createObjectURL(l),(u=new Image).src=d,u.onload=function(){var e=this.naturalHeight,r=this.naturalWidth;if("background"===i){if(e<128||r<128)return t.siblings(".erorrTip").find(".image_error").text(jsonAiGirlFriend.backGround_Error),t.siblings(".erorrTip").css("visibility","visible"),!1;s.mc_Background=o,$("#createMC_background_img").attr("src",d)}else{if(e<32||r<32)return t.siblings(".erorrTip").find(".image_error").text(jsonAiGirlFriend.avatar_error),t.siblings(".erorrTip").css("visibility","visible"),!1;"avatar"==i?(s.mc_Avatar=o,$("#createMC_avatar_img").attr("src",d)):(s.editUser_Avatar=o,$(".editUser #edit_user_avatar").attr("src",d))}t.siblings(".erorrTip").css("visibility","hidden")},u.error=function(){console.log("Error image loading")},null==n||n();case 28:case"end":return e.stop()}}),e,this)}))),function(e,t,a,i,n){return r.apply(this,arguments)})},{key:"clearInput",value:function(){this.mc_Avatar="",this.mc_Name="",this.mc_Desc="",this.mc_Gender="",this.mc_Background="",this.mc_Persona="",this.mc_visibility=jsonAiGirlFriend.classifySelect.Public,this.mc_Categories=[],this.mc_Greeting="",this.mc_Scenario="",this.mc_Dialogue="",this.head_portrait=[],this.head_portrait_background=[],this.isUploadAvatar=!1,this.isUploadBackground=!1,this.oldRoleInfo={},this.my_characters_id=0,this.is_draft=!1,this.mc_roleId="",this.voice_json=this.voiceArr[0],$(".maxLength span").text(0),$(".erorrTip").css("visibility","hidden")}},{key:"closeCD",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,a=this,i=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],r=i.length>1&&void 0!==i[1]&&i[1],this.editMcType="",$(".createBtn").removeClass("active"),this.resetAll=t,this.resetMy=t,!r){e.next=18;break}e.t0=this.lastTab,e.next="my"===e.t0?10:"voice"===e.t0?12:"all"===e.t0?14:16;break;case 10:return $("#myCharacters").click(),e.abrupt("break",16);case 12:return $("#voicepool").click(),e.abrupt("break",16);case 14:return $("#allMyCharacters").click(),e.abrupt("break",16);case 16:e.next=19;break;case 18:$("#myCharacters").click();case 19:$("body")[0].scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),console.log(t,"isReset"),setTimeout(_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.GetMyCharacters();case 2:a.initCharacters(),a.GetRecentChatting();case 4:case"end":return e.stop()}}),e)}))),10);case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pageProcess",value:function(){var e=this;$(window).off("scroll");var t,r,a="all"==this.tab;a?(t=this.CharactersPage+1,r=this.CharactersCount):(t=this.MyCharactersPage+1,r=this.MyCharactersCount),t>=r||""!=this.editMcType||$(window).on("scroll",(function(t){var r=$(".hr_pagePorgress").offset().top+parseFloat($(".hr_pagePorgress").css("padding-bottom"));window.scrollY+$(window).height()>=r&&($(".hr_pagePorgress")[0].scrollIntoView({behavior:"instant",inline:"end",block:"end"}),a?(!e.isLoading&&e.initCharacters(!1),e.isLoading=!0):(!e.isMyLoading&&e.GetMyCharacters(!1),e.isMyLoading=!0))}))}},{key:"userInfoUpdate",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){var a,i,n,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",!this.isUploadUserAvatar){e.next=7;break}return i=this.editUser_Avatar,(n=new FormData).append("file",i),e.next=7,fetchPostNormal("file-upload",n,interHost,{}).then((function(e){200!=e.code?(null==r||r(),$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.errorDesc,type:"error"})):a=e.data.url})).catch((function(e){console.error(e)}));case 7:s={head_portrait:a||this.editUser_Avatar,first_name:this.editUser_firstName,last_name:this.editUser_lastName,age:this.editUserAge},fetchPostNormal("api/user/set-user-info",s,interHost).then((function(e){200!=e.code?(null==r||r(),$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.errorDesc,type:"error"})):(console.log(e,"res"),null==t||t())})).catch((function(e){console.error(e),null==r||r(),$Popup({title:jsonAiGirlFriend.failedMsg.normalTitle,content:jsonAiGirlFriend.failedMsg.generateError,type:"error"})}));case 9:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"clearUserData",value:function(){$(".erorrTip[data-type='editUser_lastName']").css("visibility","hidden"),$(".erorrTip[data-type='editUserAvatar']").css("visibility","hidden"),$(".erorrTip[data-type='editUser_firstName']").css("visibility","hidden"),this.editUser_Avatar="",this.editUserAge=0,this.editUser_firstName="",this.editUser_lastName="",this.isUploadUserAvatar=!1}},{key:"getUserData",value:function(){var e=this;fetchPostNormal("api/user/get-profile",{},interHost).then((function(t){if(200==t.code){$(".editUser_email").val(t.data.email),$(".editUser #edit_user_avatar").attr("src",t.data.head_portrait),$(".editUser_lastName").val(t.data.last_name),e.editUser_Avatar=t.data.head_portrait,e.editUser_lastName=t.data.last_name;var r=t.data.first_name+t.data.last_name;ttsBlank(r)?e.editUser_firstName=t.data.email.split("@")[0]:e.editUser_firstName=t.data.first_name,$(".editUser_firstName").val(e.editUser_firstName),e.editUserAge=t.data.age}})).catch((function(){console.error("get user data error")}))}},{key:"clickUserEvent",value:function(){var e=this;$(".editUser_firstName,.editUser_lastName").off(),$(".editUser_firstName").on("input",(function(){var t=e.inputCharacter($(this),30,"editUser_firstName");e.editUser_firstName=t})),$(".editUser_lastName").on("input",(function(){var t=e.inputCharacter($(this),30,"editUser_lastName");e.editUser_lastName=t}))}},{key:"isShowNewTag",value:function(){getCookie("isShowVoicePoolNew")||setCookie("isShowVoicePoolNew",new Date);var e=getCookie("isShowVoicePoolNew");(new Date-new Date(e))/864e5<=7&&$("#voicepool").addClass("new")}}]);var e,t,r,a,i,n,s,o,c,l,d,u,h,g,_,v,p,m}();function refreshData(e){var t=null;return function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(t=null),!t&&(t=setTimeout((function(){t=null}),e),!0)}}function ToolTip(e){var t=e.text,r=void 0===t?"":t,a=e.type,i=void 0===a?"":a,n=e.showtime,s=void 0===n?"":n;$("body").append('\n    <bottom-message\n      text="'.concat(r,'"\n      type="').concat(i,'"\n      showtime="').concat(s,'"\n      >\n    </bottom-message>'))}function isShowBtnLR(e,t){var r=$(".RecentChatting").width(),a=$(".Recent_item").width(),i=$(".Recent_item").css("margin-right");(a+parseFloat(i))*$(".Recent_item").length>r&&"pc"==userModel?($(".view").show(),$(".view").hasClass("active")?$(".btn_left,.btn_right").hide():transformBtn(e,t)):$(".btn_left,.btn_right,.view").hide()}function transformBtn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$(".btn_left"),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$(".btn_right");0==e?r.hide():r.css("display","flex"),e==t?a.hide():a.css("display","flex")}function copyText(e){var t=e.trim(),r=document.createElement("input");r.value=t,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)}function openWindow(e){winRef&&!winRef.closed?winRef.location.href=e:window.open(e)}function formatNumber(e){if(e<1e3)return"".concat(e);if(e<1e6){var t=e/1e3;if(Number.isInteger(t))return"".concat(t.toFixed(0),"K");var r=t.toFixed(1);return r.endsWith(".0")?"".concat(t.toFixed(0),"K"):"".concat(r,"K")}var a=e/1e6;if(Number.isInteger(a))return"".concat(a.toFixed(0),"M");var i=a.toFixed(1);return i.endsWith(".0")?"".concat(a.toFixed(0),"M"):"".concat(i,"M")}function clearGetIfications(){window.clearTimeout(informTimer),clearTimeout(informTimer),informTimer=null}function checkTimestamp(e){e*=1e3;var t=(new Date).getTime()-e;if(t<36e5)return"a few minutes ago";if(t<864e5){var r=Math.floor(t/36e5);return t%36e5<18e5?r+" hour ago":r+1+" hour ago"}var a=new Date(e),i=a.getFullYear(),n=(a.getMonth()+1).toString().padStart(2,"0"),s=a.getDate().toString().padStart(2,"0");return i===(new Date).getFullYear()?"".concat(n,"/").concat(s):"".concat(i,"/").concat(n,"/").concat(s)}checkFileType=function(e,t){var r=e.type,a=e.name.split("."),i=a[a.length-1].toLowerCase();return!(!["image/jpeg","image/png","image/webp","application/octet-stream"].includes(r)||!["jpeg","png","webp","jpg"].includes(i))},$(document).ready((function(){console.log("%cCurrent version: V".concat(currentVersion),"color: red;font-size: 24px;font-weight: bold;text-decoration: underline;"),window.aiChatting=new AiGirlfriendTalking,window.aiGirlFriend=new AiGirlFriend,aiChatting.bindEvent();var e=getUrlVal("openShare"),t=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,aiGirlFriend.init();case 2:e&&aiChatting.getAiInfo(e,2,""),(getCookie("access_token")?getCookie("access_token"):"")||gtag("event","open_aigirlfriend_page"),window.addEventListener("resize",(function(){aiGirlFriend.composeRecent()}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}));