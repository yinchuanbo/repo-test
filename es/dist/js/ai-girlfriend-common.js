var TOOL_API=location.host.includes("vidqu.ai")&&!location.host.includes("test")?"https://tool-api.vidqu.ai/":"https://tool-api-test.vidqu.ai/",interHost=location.host.includes(".vidqu.ai")&&!location.host.includes("test")?"https://main-api.vidqu.ai/":"https://main-api-test.vidqu.ai/";function judgeClient(){let e="";return e=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"ios":/(Android)/i.test(navigator.userAgent)?"android":"pc",e}function ttsBlank(e){return null==e||"null"===e||""===e||void 0===e||"undefined"===e||"unknown"===e}const addScripTag=e=>{const t=document.createElement("script");t.src=e,t.type="module";(document.head||document.getElementsByTagName("head")[0]).appendChild(t)},addcssTag=e=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e;(document.head||document.getElementsByTagName("head")[0]).appendChild(t)};function Modal(e){const{iconType:t="",titleText:o="",isCancel:i="false",submitType:n="",content:a="",contentList:s="[]",isClose:r="true",submitText:l=""}=e;$("body").append(`\n      <confirm-dialog\n        titleText="${o}"\n        contentList='${s}'\n        iconType="${t}"\n        isClose=${r}\n        isCancel="${i}"\n        submitType="${n}"\n        content="${a}"\n        submitText="${l}">\n      </confirm-dialog>`)}function initLoginDialog(e=""){const t="/dist/js";addScripTag(t+"/commonSignin/login-dialog.js"),addScripTag(t+"/confirm-dialog/index.js");const o=document.createElement("link");o.rel="stylesheet",o.href=t+"/commonSignin/aiChatLogin.css";(document.head||document.getElementsByTagName("head")[0]).appendChild(o);const i=document.createElement("my-component");document.body.appendChild(i)}initLoginDialog();const localPathKey="LOCAL_PATH_STORAGE",localPathJSON=localStorage.getItem(localPathKey),localPath=localPathJSON?JSON.parse(localPathJSON):[];function showLoginWindow(e={}){const{fn:t=()=>{},isReloading:o=!1,closeFn:i=()=>{}}=e;document.body.style.overflow="hidden",$("my-component").off("loginsuccess").on("loginsuccess",(async()=>{t(),console.log("login successful")})).off("closeLoginDialog").on("closeLoginDialog",(()=>{i(),console.log("login closed"),document.body.style.overflow="auto"})),o?localStorage.setItem("toolsPosition",o):localStorage.setItem("toolsPosition","false"),$("my-component").length&&$("my-component")[0].showLoginDialog()}function goApp(){window.location.href="/app"}function goFaceSwap(){window.location.href="/face-swap.html"}function setCookieSesid(e){let t=e.headers.get("Sesid"),o=e.headers.get("Sesid-sign"),i=getCookie("SsToken"),n=getCookie("SsToken-sign");t=ttsBlank(t)?i:t,o=ttsBlank(t)?n:o,setCookie("SsToken",t),setCookie("SsToken-sign",o)}localStorage.setItem(localPathKey,JSON.stringify([...new Set([...localPath,location.pathname])]));var fetchPut=function(e,t,o={}){return new Promise(((i,n)=>{fetch(e,{method:"PUT",headers:{"X-TASK-VERSION":"2.0.0",...o},body:t}).then((e=>i(e.status))).catch((e=>n(e)))}))};function fetchPostNormal(e,t,o=TOOL_API,i={"Content-Type":"application/json"}){return new Promise(((n,a)=>{fetch(o+e,{method:"POST",headers:{"Request-Origin":"vidqu",Authorization:"Bearer "+getCookie("access_token")||"",...i},body:t instanceof FormData?t:JSON.stringify(t)}).then((e=>{e.json().then((async e=>{401===e.code?(localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),isShowLogin&&showLoginWindow(),await aiGirlFriend.initCharacters(),aiGirlFriend.GetRecentChatting(),aiGirlFriend.GetMyCharacters(),n(e)):n(e)}))})).catch((e=>{a(e)}))}))}function fetchGetNormal(e,t=TOOL_API,o={}){return new Promise(((i,n)=>{fetch(t+e,{method:"GET",headers:{"Content-Type":"application/json","Request-Origin":"vidqu",Authorization:"Bearer "+getCookie("access_token")||"",...o}}).then((e=>e.json().then((async e=>{401===e.code?(aiChatting.closeChat(),localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1),isShowLogin&&showLoginWindow(),await aiGirlFriend.initCharacters(),aiGirlFriend.GetRecentChatting(),aiGirlFriend.GetMyCharacters(),n(e)):i(e)})))).catch((e=>n(e)))}))}function setCookie(e,t,o=30){var i=new Date;i.setDate(i.getDate()+o);var n=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,a=encodeURIComponent(t)+(null==o?"":";expires="+i.toUTCString())+";path=/;domain="+n;document.cookie=e+"="+a}function getCookie(e){const t=document.cookie.split(";");for(const o of t){const[t,i]=o.trim().split("=");if(t===e)return decodeURIComponent(i)}return null}const isSeo=()=>{let e=!1,t=["google.","baidu.","yandex.","bing.","yahoo.","duckduckgo.",".naver.","go.mail.ru","qwant.","sougou.",".so.","rambler.",".ask.","daum.",".ecosia.",".startsiden.",".onetonline.","search.smt.docomo",".biglobe.","seznam."];for(let o of t)if(document.referrer.includes(o))return e=!0,e},getinsurValue=()=>{let e="";return"/novia-virtual.html"==document.location.pathname&&(e="es_vidqu_aigf"),isSeo()&&(e=e.replace("es","esseo")),e};function getUrlParam(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?encodeURI(o[2]):null}const setInsurCookie=()=>{getCookie("insur")||isSeo()||getUrlParam("insur")||getCookie("insurLevel")||setCookie("insur",getinsurValue(),30),isSeo()&&(getCookie("insur")&&(getCookie("insur").includes("seo")||getUrlParam("insur")||getCookie("insurLevel"))||setCookie("insur",getinsurValue(),30)),getUrlParam("insur")&&(getCookie("insurLevel")||(setCookie("insur",getUrlParam("insur"),30),setCookie("insurLevel","strong",30),getCookie("aff")&&JSON.parse(getCookie("aff"))&&JSON.parse(getCookie("aff")).a_aid&&getCookie("insur")&&getCookie("insur").includes("googlecamp")&&(document.cookie="aff=; expires=Thu, 01 Jan 1971 00:00:00 UTC; path=/;domain=.vidqu.ai"))),null!==getUrlParam("a_aid")&&(cookieObj={a_aid:getUrlParam("a_aid"),chan:getUrlParam("chan"),data1:getUrlParam("data1"),data2:getUrlParam("data2")},getCookie("insur")&&getCookie("insur").includes("googlecamp")&&(document.cookie="insur=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;domain=.vidqu.ai",document.cookie="insurLevel=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;domain=.vidqu.ai"),setCookie("aff",JSON.stringify(cookieObj),120))};function getPreferredLanguage(){let e="";e=$("html").attr("lang").substring(0,2);var t=["en","de","es","fr","it","pt","ja","ar","kr","tw"].filter((function(t){return t===e}));return t.length>0?"ja"==t[0]?"jp":t[0]:"en"}const transtoBlob=({b64data:e,contentType:t="image/png"})=>{t=t||"";let o=1024,i=atob(e.split(",")[1]),n=i.length,a=Math.ceil(n/o),s=new Array(a);for(let e=0;e<a;++e){let t=e*o,a=Math.min(t+o,n),r=new Array(a-t);for(let e=t,o=0;e<a;++o,++e)r[o]=i[e].charCodeAt(0);s[e]=new Uint8Array(r)}return new Blob(s,{type:t})};function setSessionCookie(e,t){var o=location.hostname.includes(".vidqu.ai")?".vidqu.ai":location.hostname,i=escape(t)+";path=/;domain="+o;document.cookie=e+"="+i}function handleScrollAnimation(){$(".scroll-animation").each((function(e,t){t.getBoundingClientRect().top<.66*window.innerHeight&&$(t).addClass("on")}))}function chatLogin(){isLogin(!!(getCookie("access_token")?getCookie("access_token"):"")),window.aiChatting&&window.aiChatting.updateAudioLimit()}window.addEventListener("scroll",(function(){handleScrollAnimation()}));var defaultHeadImg="/dist/img/aiFriend/icon_avatar.svg";function isLogin(e){if(e){$("#header_login").hide(),$("#header_user,#header_inform").show();const e=JSON.parse(getCookie("user_info"));let t=e.first_name+" "+e.last_name;t=" "===t?e.email.split("@")[0]:t,$("#header_user .header_avator").attr("src",e.head_portrait||defaultHeadImg),$("header .userName").text(t),$(".meau_item.log").show()}else $("#header_login").show(),$("#header_user,#header_inform").hide(),$(".meau_item.log").hide()}function resizeImageByFile(e){return new Promise(((t,o)=>{var i=new FileReader;i.onloadend=()=>{let e=new Image;e.onload=()=>{let o=document.createElement("canvas"),i=o.getContext("2d"),n=Math.max(e.width,e.height);if(n>3072){let t=3072/n;o.width=e.width*t,o.height=e.height*t}else o.width=e.width,o.height=e.height;i.drawImage(e,0,0,o.width,o.height);var a=o.toDataURL(),s=transtoBlob({b64data:a,contentType:"image/png"});let r="width";o.width<o.height&&(r="height"),t({blog:s,imgType:r})},e.onerror=()=>{t({blog:null})},e.src=i.result},i.onerror=o,i.readAsDataURL(e)}))}$(".meau_item.user img").click((function(){"pc"==judgeClient()&&($(this).hasClass("active")?$("#header_user .signout").hide():$("#header_user .signout").css("display","flex"),$(this).toggleClass("active"))})),$("body").on("mouseup",(function(e){const t=$(e.target);0==t.parents(".meau_item.user").length&&($(".meau_item.user img").removeClass("active"),$("#header_user .signout").hide());const o=0!=t.parents("#header_inform").length||t.hasClass("inform");o?("pc"==judgeClient()?$("#header_inform .inform_box").show():($("header .inform_mobile_list").slideDown(),document.body.style.overflow="hidden"),gtag("event","notifications_aigirlfriend_header"),$("#header_inform").addClass("active"),clearGetIfications()):$("#header_inform").hasClass("active")&&"pc"==judgeClient()?($("#header_inform,.inform_item").removeClass("unlook"),$("#header_inform .inform_box").hide(),$("#header_inform").removeClass("active"),aiGirlFriend.clearIfication()):(o||t.hasClass("inform_m_back")&&$("#header_inform").hasClass("active"))&&($("header .inform_mobile_list").slideUp(),document.body.style.overflow="auto",$("#header_inform").removeClass("active"),aiGirlFriend.clearIfication())})),$(".inform_list_box").on("scroll",(function(e){$(".inform_list_box").scrollTop()>=$(".inform_list").height()-$(".inform_list_box").height()&&aiGirlFriend.GetIfications(!1)}));const currentDate=new Date,timezoneOffset=currentDate.getTimezoneOffset(),browserLanguage=navigator.language||navigator.userLanguage,getWhiteList=()=>{fetchPost(`api/site/mio-config?t=${(new Date).getTime()}`,{}).then((e=>{200===e.code?e.data.is_in_ip_whitelist||-480!==timezoneOffset||"zh-cn"!==browserLanguage.toLowerCase()||(document.body.innerHTML='<div class="shield-page">The website is not available</div>',document.head.innerHTML="\n          <style>\n               *{\n                   padding:0;\n                   margin:0;\n                 }\n               body{\n                 background-image: linear-gradient(to right, rgb(241,238,255), rgb(254,254,255));\n                 display: flex;\n                 align-items: center;\n                 justify-content: center;\n                 width: 100vw;\n                 height: 100vh;\n                 overflow: hidden;\n               }\n               .shield-page{\n                 font: normal normal 600 30px/30px Poppins;\n                 color: #785EEE;\n               }\n               @media (max-width: 768px){\n                 .shield-page{\n                   font: normal normal 600 20px/20px Poppins;\n                 }\n               }\n          </style>"):console.log("err")}))};function randomchoice(e){let t=null;return function(){let o=e.filter((e=>e!==t)),i=o[Math.floor(Math.random()*o.length)];return t=i,i}}function updateUserData(){fetchPostNormal("api/user/get-profile",{},interHost).then((e=>{200==e.code&&(setUserInfo(e),aiGirlFriend.GetMyCharacters())})).catch((()=>{console.error("updateUserData error")}))}function setUserInfo(e){const{id:t}=JSON.parse(getCookie("user_info")),o={head_portrait:e.data.head_portrait,email:e.data.email,id:t,first_name:e.data.first_name,last_name:e.data.last_name,usertype:e.data.type};setCookie("user_info",JSON.stringify(o)),isLogin(!0)}function isBlob(e){return e instanceof Blob}function areObjectsEqual(e,t){const o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return console.log("length unlike"),!1;for(const i of o){if(!t.hasOwnProperty(i))return console.log("key is not +",i),!1;if(e[i]!=t[i])return console.log("value is not +",i,e[i],t[i]),!1}return!0}getWhiteList(),$("#header_login").click((()=>{gtag("event","login_aigirlfriend_header"),showLoginWindow({fn:()=>{chatLogin()}})})),$(".signoutBtn").click((()=>{$(".meau_icon").hasClass("active")&&$(".meau_icon").click(),gtag("event","signout_aigirlfriend_header"),localStorage.removeItem("user_info"),setCookie("loginProduct",""),setSessionCookie("st",""),setCookie("refresh_token",""),setCookie("user_info",""),setCookie("access_token",""),isLogin(!1)})),$(document).ready((function(){chatLogin(),setInsurCookie()})),$(".meau_icon").click((function(){$(this).hasClass("active")?($(".meau_list").slideUp(),document.body.style.overflow="auto"):($(".meau_list").slideDown(),document.body.style.overflow="hidden"),$(this).toggleClass("active")})),$(".meau_list.mobile_show").click((function(e){$(e.target).hasClass("meau_list")&&$(".meau_icon").click()})),window.questLanguage=getPreferredLanguage(),window.userModel=judgeClient();